---
title: SQLDescribeParam | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
topic_type:
- apiref
helpviewer_keywords:
- SQLDescribeParam function
ms.assetid: 396e74b1-5d08-46dc-b404-2ef2003e4689
author: rothja
ms.author: jroth
ms.openlocfilehash: 05e14ccb0fadb4f1cf05f965c79cf8c05c71f93a
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87652790"
---
# <a name="sqldescribeparam"></a><span data-ttu-id="0938b-102">SQLDescribeParam</span><span class="sxs-lookup"><span data-stu-id="0938b-102">SQLDescribeParam</span></span>
  <span data-ttu-id="0938b-103">SQL 문의 매개 변수를 설명 하기 위해 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT odbc 드라이버는 [!INCLUDE[tsql](../../includes/tsql-md.md)] 준비 된 ODBC 문 핸들에 대해 SQLDescribeParam가 호출 될 때 SELECT 문을 작성 하 고 실행 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-103">To describe the parameters of any SQL statement, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver builds and executes a [!INCLUDE[tsql](../../includes/tsql-md.md)] SELECT statement when SQLDescribeParam is called on a prepared ODBC statement handle.</span></span> <span data-ttu-id="0938b-104">결과 집합의 메타데이터에 따라 준비된 문의 매개 변수 특징이 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-104">The metadata of the result set determines the characteristics of the parameters in the prepared statement.</span></span> <span data-ttu-id="0938b-105">SQLDescribeParam는 SQLExecute 또는 SQLExecDirect에서 반환할 수 있는 오류 코드를 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-105">SQLDescribeParam can return any error code that SQLExecute or SQLExecDirect might return.</span></span>  
  
 <span data-ttu-id="0938b-106">로 시작 하는 데이터베이스 엔진의 향상 된 기능 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] 을 통해 SQLDescribeParam를 통해 예상 결과에 대 한 보다 정확한 설명을 얻을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-106">Improvements in the database engine starting with [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] allow SQLDescribeParam to obtain more accurate descriptions of the expected results.</span></span> <span data-ttu-id="0938b-107">이러한 더 정확한 결과는 이전 버전의에서 SQLDescribeParam에 의해 반환 된 값과 다를 수 있습니다 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="0938b-107">These more accurate results may differ from the values returned by SQLDescribeParam in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="0938b-108">자세한 내용은 [메타데이터 검색](../native-client/features/metadata-discovery.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="0938b-108">For more information, see [Metadata Discovery](../native-client/features/metadata-discovery.md).</span></span>  
  
 <span data-ttu-id="0938b-109">또한에서 새로 만들기 [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)] , *ParameterSizePtr* 는 이제 [ODBC 사양](https://go.microsoft.com/fwlink/?LinkId=207044)에 정의 된 대로 해당 매개 변수 표식의 열 또는 식 크기 (문자 수)에 대 한 정의를 사용 하 여 정렬 하는 값을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-109">Also new in [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], *ParameterSizePtr* now returns a value that aligns with the definition for the size, in characters, of the column or expression of the corresponding parameter marker as defined in the [ODBC specification](https://go.microsoft.com/fwlink/?LinkId=207044).</span></span> <span data-ttu-id="0938b-110">이전 버전의 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client에서 *ParameterSizePtr* 는 형식에 해당 하는 값 `SQL_DESC_OCTET_LENGTH` 이거나 형식에 대해 SQLBindParameter에 제공 된 관련이 없는 열 크기 값 ( `SQL_INTEGER` 예:) 일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-110">In previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client, *ParameterSizePtr* could be the corresponding value of `SQL_DESC_OCTET_LENGTH` for the type, or an irrelevant column size value that was supplied to SQLBindParameter for a type, the value of which should be ignored (`SQL_INTEGER`, for example).</span></span>  
  
 <span data-ttu-id="0938b-111">드라이버는 다음과 같은 상황에서 SQLDescribeParam 호출을 지원 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-111">The driver does not support calling SQLDescribeParam in the following situations:</span></span>  
  
-   <span data-ttu-id="0938b-112">SQLExecDirect 이후 [!INCLUDE[tsql](../../includes/tsql-md.md)] from 절이 포함 된 UPDATE 또는 DELETE 문에 대해</span><span class="sxs-lookup"><span data-stu-id="0938b-112">After SQLExecDirect for any [!INCLUDE[tsql](../../includes/tsql-md.md)] UPDATE or DELETE statements containing the FROM clause.</span></span>  
  
-   <span data-ttu-id="0938b-113">HAVING 절에 매개 변수를 포함하거나 SUM 함수 결과와 비교되는 ODBC 또는 [!INCLUDE[tsql](../../includes/tsql-md.md)] 문의 경우</span><span class="sxs-lookup"><span data-stu-id="0938b-113">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement containing a parameter in a HAVING clause, or compared to the result of a SUM function.</span></span>  
  
-   <span data-ttu-id="0938b-114">매개 변수가 포함된 하위 쿼리를 사용하는 ODBC 또는 [!INCLUDE[tsql](../../includes/tsql-md.md)] 문의 경우</span><span class="sxs-lookup"><span data-stu-id="0938b-114">For any ODBC or [!INCLUDE[tsql](../../includes/tsql-md.md)] statement depending on a subquery containing parameters.</span></span>  
  
-   <span data-ttu-id="0938b-115">정량화된 조건자 또는 비교 like의 두 식에 모두 매개 변수 표식이 포함된 ODBC SQL 문의 경우</span><span class="sxs-lookup"><span data-stu-id="0938b-115">For ODBC SQL statements containing parameter markers in both expressions of a comparison, like, or quantified predicate.</span></span>  
  
-   <span data-ttu-id="0938b-116">매개 변수 중 하나가 함수에 대한 매개 변수인 쿼리의 경우</span><span class="sxs-lookup"><span data-stu-id="0938b-116">For any queries where one of the parameters is a parameter to a function.</span></span>  
  
-   <span data-ttu-id="0938b-117">명령에 주석 (/\* \* /)이 있는 경우 [!INCLUDE[tsql](../../includes/tsql-md.md)]</span><span class="sxs-lookup"><span data-stu-id="0938b-117">When there are comments (/\* \*/) in the [!INCLUDE[tsql](../../includes/tsql-md.md)] command.</span></span>  
  
 <span data-ttu-id="0938b-118">문 일괄 처리를 처리 [!INCLUDE[tsql](../../includes/tsql-md.md)] 하는 경우 드라이버는 일괄 처리의 첫 번째 문 다음에 있는 문의 매개 변수 표식에 대해 SQLDescribeParam를 호출 하는 것도 지원 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-118">When processing a batch of [!INCLUDE[tsql](../../includes/tsql-md.md)] statements, the driver also does not support calling SQLDescribeParam for parameter markers in statements after the first statement in the batch.</span></span>  
  
 <span data-ttu-id="0938b-119">준비 된 저장 프로시저의 매개 변수를 설명할 때 SQLDescribeParam는 시스템 저장 프로시저 [sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql) 를 사용 하 여 매개 변수 특징을 검색 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-119">When describing the parameters of prepared stored procedures, SQLDescribeParam uses the system stored procedure [sp_sproc_columns](/sql/relational-databases/system-stored-procedures/sp-sproc-columns-transact-sql) to retrieve parameter characteristics.</span></span> <span data-ttu-id="0938b-120">sp_sproc_columns는 현재 사용자 데이터베이스 내의 저장 프로시저에 대 한 데이터를 보고할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-120">sp_sproc_columns can report data for stored procedures within the current user database.</span></span> <span data-ttu-id="0938b-121">정규화 된 저장 프로시저 이름을 준비 하면 SQLDescribeParam에서 데이터베이스를 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-121">Preparing a fully qualified stored procedure name allows SQLDescribeParam to execute across databases.</span></span> <span data-ttu-id="0938b-122">예를 들어 다음과 같은 시스템 저장 프로시저 [sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql) 을 준비 하 고 모든 데이터베이스에서 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-122">For example, the system stored procedure [sp_who](/sql/relational-databases/system-stored-procedures/sp-who-transact-sql) can be prepared and executed in any database as:</span></span>  
  
```  
SQLPrepare(hstmt, "{call sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="0938b-123">성공적인 준비 후 SQLDescribeParam를 실행 하면 모든 데이터베이스에 연결 된 경우 빈 행 집합이 반환 `master` 됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-123">Executing SQLDescribeParam after successful preparation returns an empty row set when connected to any database but `master`.</span></span> <span data-ttu-id="0938b-124">다음과 같이 준비 된 동일한 호출로 인해 현재 사용자 데이터베이스에 관계 없이 SQLDescribeParam이 성공 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-124">The same call, prepared as follows, causes SQLDescribeParam to succeed regardless of the current user database:</span></span>  
  
```  
SQLPrepare(hstmt, "{call master..sp_who(?)}", SQL_NTS);  
```  
  
 <span data-ttu-id="0938b-125">대량 값 데이터 형식의 경우 *DataTypePtr* 에서 반환 되는 값은 SQL_VARCHAR, SQL_VARBINARY 또는 SQL_NVARCHAR입니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-125">For large value data types, the value returned in *DataTypePtr* is SQL_VARCHAR, SQL_VARBINARY, or SQL_NVARCHAR.</span></span> <span data-ttu-id="0938b-126">큰 값 데이터 형식 매개 변수의 크기가 "제한 없음" 임을 나타내려면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native CLIENT ODBC 드라이버는 *ParameterSizePtr* 를 0으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-126">To indicate that the size of the large value data type parameter is "unlimited," the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client ODBC driver sets *ParameterSizePtr* to 0.</span></span> <span data-ttu-id="0938b-127">표준 `varchar` 매개 변수에 대해서는 실제 크기 값이 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-127">Actual size values are returned for standard `varchar` parameters.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="0938b-128">매개 변수가 이미 SQL_VARCHAR, SQL_VARBINARY 또는 SQL_WVARCHAR 매개 변수의 최대 크기와 바인딩되어 있으면 "제한 없음"이 아니라 매개 변수의 바인딩된 크기가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-128">If the parameter has already been bound with a maximum size for the SQL_VARCHAR, SQL_VARBINARY, or SQL_WVARCHAR parameters, the bound size of the parameter is returned, not "unlimited."</span></span>  
  
 <span data-ttu-id="0938b-129">"제한 없음" 크기 입력 매개 변수를 바인딩하려면 실행 시 데이터를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-129">To bind an "unlimited" size input parameter, data-at-execution must be used.</span></span> <span data-ttu-id="0938b-130">"무제한" 크기의 출력 매개 변수를 바인딩할 수 없습니다 (예: SQLGetData는 결과 집합에 대 한 [SQLGetData](sqlgetdata.md) 와 마찬가지로 출력 매개 변수에서 데이터를 스트리밍하는 방법은 없음).</span><span class="sxs-lookup"><span data-stu-id="0938b-130">It is not possible to bind an "unlimited" size output parameter (there is no method for streaming data from an output parameter, like [SQLGetData](sqlgetdata.md) does for result sets).</span></span>  
  
 <span data-ttu-id="0938b-131">출력 매개 변수의 경우 버퍼를 바인딩해야 하며, 값이 너무 크면 버퍼가 채워지고 SQL_SUCCESS_WITH_INFO 메시지가 "문자열 데이터의 오른쪽이 잘렸습니다."라는 경고와 함께 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-131">For output parameters, a buffer must be bound and if the value is too large, the buffer is filled and a SQL_SUCCESS_WITH_INFO message and is returned along with the "string data; right truncation" warning.</span></span> <span data-ttu-id="0938b-132">잘린 데이터는 삭제됩니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-132">The data that was truncated is then discarded.</span></span>  
  
## <a name="sqldescribeparam-and-table-valued-parameters"></a><span data-ttu-id="0938b-133">SQLDescribeParam와 테이블 반환 매개 변수</span><span class="sxs-lookup"><span data-stu-id="0938b-133">SQLDescribeParam and Table-Valued Parameters</span></span>  
 <span data-ttu-id="0938b-134">응용 프로그램은 SQLDescribeParam를 사용 하 여 준비 된 문에 대 한 테이블 반환 매개 변수 정보를 검색할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-134">An application can retrieve table-valued parameter information for a prepared statement with SQLDescribeParam.</span></span> <span data-ttu-id="0938b-135">자세한 내용은 [준비 된 문의 테이블 반환 매개 변수 메타 데이터](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="0938b-135">For more information, see [Table-Valued Parameter Metadata for Prepared Statements](../native-client-odbc-table-valued-parameters/table-valued-parameter-metadata-for-prepared-statements.md).</span></span>  
  
 <span data-ttu-id="0938b-136">일반적으로 테이블 반환 매개 변수에 대 한 자세한 내용은 [ODBC&#41;&#40;테이블 반환 매개 변수 ](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="0938b-136">For more information about table-valued parameters in general, see [Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-table-valued-parameters/table-valued-parameters-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-enhanced-date-and-time-features"></a><span data-ttu-id="0938b-137">향상된 날짜 및 시간 기능에 대한 SQLDescribeParam 지원</span><span class="sxs-lookup"><span data-stu-id="0938b-137">SQLDescribeParam Support for Enhanced Date and Time Features</span></span>  
 <span data-ttu-id="0938b-138">날짜/시간 형식에 대해 반환되는 값은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-138">The values returned for date/time types are as follows:</span></span>  
  
||<span data-ttu-id="0938b-139">*DataTypePtr*</span><span class="sxs-lookup"><span data-stu-id="0938b-139">*DataTypePtr*</span></span>|<span data-ttu-id="0938b-140">*ParameterSizePtr*</span><span class="sxs-lookup"><span data-stu-id="0938b-140">*ParameterSizePtr*</span></span>|<span data-ttu-id="0938b-141">*DecimalDigitsPtr*</span><span class="sxs-lookup"><span data-stu-id="0938b-141">*DecimalDigitsPtr*</span></span>|  
|-|-------------------|------------------------|------------------------|  
|<span data-ttu-id="0938b-142">Datetime</span><span class="sxs-lookup"><span data-stu-id="0938b-142">datetime</span></span>|<span data-ttu-id="0938b-143">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0938b-143">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="0938b-144">23</span><span class="sxs-lookup"><span data-stu-id="0938b-144">23</span></span>|<span data-ttu-id="0938b-145">3</span><span class="sxs-lookup"><span data-stu-id="0938b-145">3</span></span>|  
|<span data-ttu-id="0938b-146">smalldatetime</span><span class="sxs-lookup"><span data-stu-id="0938b-146">smalldatetime</span></span>|<span data-ttu-id="0938b-147">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0938b-147">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="0938b-148">16</span><span class="sxs-lookup"><span data-stu-id="0938b-148">16</span></span>|<span data-ttu-id="0938b-149">0</span><span class="sxs-lookup"><span data-stu-id="0938b-149">0</span></span>|  
|<span data-ttu-id="0938b-150">date</span><span class="sxs-lookup"><span data-stu-id="0938b-150">date</span></span>|<span data-ttu-id="0938b-151">SQL_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="0938b-151">SQL_TYPE_DATE</span></span>|<span data-ttu-id="0938b-152">10</span><span class="sxs-lookup"><span data-stu-id="0938b-152">10</span></span>|<span data-ttu-id="0938b-153">0</span><span class="sxs-lookup"><span data-stu-id="0938b-153">0</span></span>|  
|<span data-ttu-id="0938b-154">time</span><span class="sxs-lookup"><span data-stu-id="0938b-154">time</span></span>|<span data-ttu-id="0938b-155">SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="0938b-155">SQL_SS_TIME2</span></span>|<span data-ttu-id="0938b-156">8, 10..16</span><span class="sxs-lookup"><span data-stu-id="0938b-156">8, 10..16</span></span>|<span data-ttu-id="0938b-157">0..7</span><span class="sxs-lookup"><span data-stu-id="0938b-157">0..7</span></span>|  
|<span data-ttu-id="0938b-158">datetime2</span><span class="sxs-lookup"><span data-stu-id="0938b-158">datetime2</span></span>|<span data-ttu-id="0938b-159">SQL_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="0938b-159">SQL_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="0938b-160">19, 21..27</span><span class="sxs-lookup"><span data-stu-id="0938b-160">19, 21..27</span></span>|<span data-ttu-id="0938b-161">0..7</span><span class="sxs-lookup"><span data-stu-id="0938b-161">0..7</span></span>|  
|<span data-ttu-id="0938b-162">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="0938b-162">datetimeoffset</span></span>|<span data-ttu-id="0938b-163">SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="0938b-163">SQL_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="0938b-164">26, 28..34</span><span class="sxs-lookup"><span data-stu-id="0938b-164">26, 28..34</span></span>|<span data-ttu-id="0938b-165">0..7</span><span class="sxs-lookup"><span data-stu-id="0938b-165">0..7</span></span>|  
  
 <span data-ttu-id="0938b-166">자세한 내용은 [ODBC&#41;&#40;날짜 및 시간 향상 ](../native-client-odbc-date-time/date-and-time-improvements-odbc.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="0938b-166">For more information, see [Date and Time Improvements &#40;ODBC&#41;](../native-client-odbc-date-time/date-and-time-improvements-odbc.md).</span></span>  
  
## <a name="sqldescribeparam-support-for-large-clr-udts"></a><span data-ttu-id="0938b-167">큰 CLR UDT에 대한 SQLDescribeParam 지원</span><span class="sxs-lookup"><span data-stu-id="0938b-167">SQLDescribeParam Support for Large CLR UDTs</span></span>  
 <span data-ttu-id="0938b-168">`SQLDescribeParam`는 큰 CLR UDT(사용자 정의 형식)를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="0938b-168">`SQLDescribeParam` supports large CLR user-defined types (UDTs).</span></span> <span data-ttu-id="0938b-169">자세한 내용은 [ODBC&#41;&#40;LARGE CLR 사용자 정의 형식 ](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="0938b-169">For more information, see [Large CLR User-Defined Types &#40;ODBC&#41;](../../relational-databases/native-client/odbc/large-clr-user-defined-types-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0938b-170">참고 항목</span><span class="sxs-lookup"><span data-stu-id="0938b-170">See Also</span></span>  
 <span data-ttu-id="0938b-171">[SQLDescribeParam 함수](https://go.microsoft.com/fwlink/?LinkId=59339) </span><span class="sxs-lookup"><span data-stu-id="0938b-171">[SQLDescribeParam Function](https://go.microsoft.com/fwlink/?LinkId=59339) </span></span>  
 [<span data-ttu-id="0938b-172">ODBC API 구현 정보</span><span class="sxs-lookup"><span data-stu-id="0938b-172">ODBC API Implementation Details</span></span>](../../relational-databases/native-client-odbc-api/odbc-api-implementation-details.md)  
  
  
