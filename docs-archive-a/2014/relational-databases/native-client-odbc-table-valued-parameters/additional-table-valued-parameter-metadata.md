---
title: 추가 테이블 반환 매개 변수 메타 데이터 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), catalog functions to retrieve metadata
- table-valued parameters (ODBC), metadata
ms.assetid: 6c193188-5185-4373-9a0d-76cfc150c828
author: rothja
ms.author: jroth
ms.openlocfilehash: 9907b6bdbabcea427e5feffd14369e8aa718094f
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87653859"
---
# <a name="additional-table-valued-parameter-metadata"></a><span data-ttu-id="17698-102">추가 테이블 반환 매개 변수 메타데이터</span><span class="sxs-lookup"><span data-stu-id="17698-102">Additional Table-Valued Parameter Metadata</span></span>
  <span data-ttu-id="17698-103">응용 프로그램은 테이블 반환 매개 변수에 대 한 메타 데이터를 검색 하기 위해 SQLProcedureColumns를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-103">To retrieve metadata for a table-valued parameter, an application calls SQLProcedureColumns.</span></span> <span data-ttu-id="17698-104">테이블 반환 매개 변수의 경우 SQLProcedureColumns는 단일 행을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-104">For a table-valued parameter, SQLProcedureColumns returns a single row.</span></span> <span data-ttu-id="17698-105">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]테이블 반환 매개 변수와 연결 된 테이블 형식에 대 한 스키마 및 카탈로그 정보를 제공 하기 위해 두 개의 추가 열 SS_TYPE_CATALOG_NAME 및 SS_TYPE_SCHEMA_NAME가 추가 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="17698-105">Two additional [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific columns, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME, have been added to provide schema and catalog information for table types associated with table-valued parameters.</span></span> <span data-ttu-id="17698-106">ODBC 사양에 따라 SS_TYPE_CATALOG_NAME 및 SS_TYPE_SCHEMA_NAME은 이전 버전의 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]에 추가된 모든 드라이버별 열 앞에, 그리고 ODBC 자체에서 지정한 모든 열 뒤에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="17698-106">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver-specific columns added in earlier versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="17698-107">다음 표에서는 테이블 반환 매개 변수에서 중요한 열을 나열합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-107">The following table lists columns that are significant for table-valued parameters.</span></span>  
  
|<span data-ttu-id="17698-108">열 이름</span><span class="sxs-lookup"><span data-stu-id="17698-108">Column name</span></span>|<span data-ttu-id="17698-109">데이터 형식</span><span class="sxs-lookup"><span data-stu-id="17698-109">Data type</span></span>|<span data-ttu-id="17698-110">값/설명</span><span class="sxs-lookup"><span data-stu-id="17698-110">Value/comments</span></span>|  
|-----------------|---------------|---------------------|  
|<span data-ttu-id="17698-111">DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="17698-111">DATA_TYPE</span></span>|<span data-ttu-id="17698-112">NULL이 아닌 Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-112">Smallint not NULL</span></span>|<span data-ttu-id="17698-113">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="17698-113">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="17698-114">TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="17698-114">TYPE_NAME</span></span>|<span data-ttu-id="17698-115">NULL이 아닌 WVarchar(128)</span><span class="sxs-lookup"><span data-stu-id="17698-115">WVarchar(128) not NULL</span></span>|<span data-ttu-id="17698-116">테이블 반환 매개 변수의 형식 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="17698-116">The type name of the table-valued parameter.</span></span>|  
|<span data-ttu-id="17698-117">COLUMN_SIZE</span><span class="sxs-lookup"><span data-stu-id="17698-117">COLUMN_SIZE</span></span>|<span data-ttu-id="17698-118">정수</span><span class="sxs-lookup"><span data-stu-id="17698-118">Integer</span></span>|<span data-ttu-id="17698-119">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-119">NULL</span></span>|  
|<span data-ttu-id="17698-120">BUFFER_LENGTH</span><span class="sxs-lookup"><span data-stu-id="17698-120">BUFFER_LENGTH</span></span>|<span data-ttu-id="17698-121">정수</span><span class="sxs-lookup"><span data-stu-id="17698-121">Integer</span></span>|<span data-ttu-id="17698-122">0</span><span class="sxs-lookup"><span data-stu-id="17698-122">0</span></span>|  
|<span data-ttu-id="17698-123">DECIMAL_DIGITS</span><span class="sxs-lookup"><span data-stu-id="17698-123">DECIMAL_DIGITS</span></span>|<span data-ttu-id="17698-124">Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-124">Smallint</span></span>|<span data-ttu-id="17698-125">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-125">NULL</span></span>|  
|<span data-ttu-id="17698-126">NUM_PREC_RADIX</span><span class="sxs-lookup"><span data-stu-id="17698-126">NUM_PREC_RADIX</span></span>|<span data-ttu-id="17698-127">Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-127">Smallint</span></span>|<span data-ttu-id="17698-128">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-128">NULL</span></span>|  
|<span data-ttu-id="17698-129">NULLABLE</span><span class="sxs-lookup"><span data-stu-id="17698-129">NULLABLE</span></span>|<span data-ttu-id="17698-130">NULL이 아닌 Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-130">Smallint not NULL</span></span>|<span data-ttu-id="17698-131">SQL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="17698-131">SQL_NULLABLE</span></span>|  
|<span data-ttu-id="17698-132">REMARKS</span><span class="sxs-lookup"><span data-stu-id="17698-132">REMARKS</span></span>|<span data-ttu-id="17698-133">Varchar</span><span class="sxs-lookup"><span data-stu-id="17698-133">Varchar</span></span>|<span data-ttu-id="17698-134">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-134">NULL</span></span>|  
|<span data-ttu-id="17698-135">COLUMN_DEF</span><span class="sxs-lookup"><span data-stu-id="17698-135">COLUMN_DEF</span></span>|<span data-ttu-id="17698-136">WVarchar(4000)</span><span class="sxs-lookup"><span data-stu-id="17698-136">WVarchar(4000)</span></span>|<span data-ttu-id="17698-137">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-137">NULL</span></span>|  
|<span data-ttu-id="17698-138">SQL_DATA_TYPE</span><span class="sxs-lookup"><span data-stu-id="17698-138">SQL_DATA_TYPE</span></span>|<span data-ttu-id="17698-139">NULL이 아닌 Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-139">Smallint not NULL</span></span>|<span data-ttu-id="17698-140">SQL_SS_TABLE</span><span class="sxs-lookup"><span data-stu-id="17698-140">SQL_SS_TABLE</span></span>|  
|<span data-ttu-id="17698-141">SQL_DATETIME_SUB</span><span class="sxs-lookup"><span data-stu-id="17698-141">SQL_DATETIME_SUB</span></span>|<span data-ttu-id="17698-142">Smallint</span><span class="sxs-lookup"><span data-stu-id="17698-142">Smallint</span></span>|<span data-ttu-id="17698-143">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-143">NULL</span></span>|  
|<span data-ttu-id="17698-144">CHAR_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="17698-144">CHAR_OCTET_LENGTH</span></span>|<span data-ttu-id="17698-145">정수</span><span class="sxs-lookup"><span data-stu-id="17698-145">Integer</span></span>|<span data-ttu-id="17698-146">NULL</span><span class="sxs-lookup"><span data-stu-id="17698-146">NULL</span></span>|  
|<span data-ttu-id="17698-147">ORDINAL_POSITION</span><span class="sxs-lookup"><span data-stu-id="17698-147">ORDINAL_POSITION</span></span>|<span data-ttu-id="17698-148">NULL이 아닌 Integer</span><span class="sxs-lookup"><span data-stu-id="17698-148">Integer not NULL</span></span>|<span data-ttu-id="17698-149">매개 변수의 서수 위치입니다.</span><span class="sxs-lookup"><span data-stu-id="17698-149">The ordinal position of the parameter.</span></span>|  
|<span data-ttu-id="17698-150">IS_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="17698-150">IS_NULLABLE</span></span>|<span data-ttu-id="17698-151">Varchar</span><span class="sxs-lookup"><span data-stu-id="17698-151">Varchar</span></span>|<span data-ttu-id="17698-152">"YES"</span><span class="sxs-lookup"><span data-stu-id="17698-152">"YES"</span></span>|  
|<span data-ttu-id="17698-153">SS_TYPE_CATALOG_NAME</span><span class="sxs-lookup"><span data-stu-id="17698-153">SS_TYPE_CATALOG_NAME</span></span>|<span data-ttu-id="17698-154">NULL이 아닌 WVarchar(128)</span><span class="sxs-lookup"><span data-stu-id="17698-154">WVarchar(128) not NULL</span></span>|<span data-ttu-id="17698-155">테이블 반환 매개 변수의 테이블 형식에 대한 형식 정의를 포함하는 카탈로그입니다.</span><span class="sxs-lookup"><span data-stu-id="17698-155">The catalog that contains the type definition for the table type of the table-valued parameter.</span></span>|  
|<span data-ttu-id="17698-156">SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="17698-156">SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="17698-157">NULL이 아닌 WVarchar(128)</span><span class="sxs-lookup"><span data-stu-id="17698-157">WVarchar(128) not NULL</span></span>|<span data-ttu-id="17698-158">테이블 반환 매개 변수의 테이블 형식에 대한 형식 정의를 포함하는 스키마입니다.</span><span class="sxs-lookup"><span data-stu-id="17698-158">The schema that contains the type definition for the table type of the table-valued parameter.</span></span>|  
  
 <span data-ttu-id="17698-159">WVarchar 열은 ODBC 사양에 Varchar로 정의되어 있지만 실제로는 최근의 모든 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC 드라이버에서 WVarchar로 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="17698-159">The WVarchar columns are defined as Varchar in the ODBC specification, but are actually returned as WVarchar in all recent [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ODBC drivers.</span></span> <span data-ttu-id="17698-160">이러한 변경 내용은 ODBC 3.5 사양에 유니코드 지원이 추가될 때 적용되었지만 명시적으로 발표되지는 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="17698-160">This change was made when Unicide support was added to the ODBC 3.5 specification, but not called out explicitly.</span></span>  
  
 <span data-ttu-id="17698-161">응용 프로그램은 테이블 반환 매개 변수에 대 한 추가 메타 데이터를 가져오기 위해 SQLColumns 및 SQLPrimaryKeys 카탈로그 함수를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-161">To obtain additional metadata for table-valued parameters, an application uses the catalog functions SQLColumns and SQLPrimaryKeys.</span></span> <span data-ttu-id="17698-162">이러한 함수를 호출하여 테이블 반환 매개 변수를 얻으려면 애플리케이션에서 문 특성 SQL_SOPT_SS_NAME_SCOPE를 SQL_SS_NAME_SCOPE_TABLE_TYPE으로 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-162">Before these functions are called for table-valued parameters, the application must set the statement attribute SQL_SOPT_SS_NAME_SCOPE to SQL_SS_NAME_SCOPE_TABLE_TYPE.</span></span> <span data-ttu-id="17698-163">이 값은 애플리케이션에서 실제 테이블이 아니라 테이블 형식의 메타데이터를 요구한다는 것을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="17698-163">This value indicates that the application requires metadata for a table type rather than an actual table.</span></span> <span data-ttu-id="17698-164">그런 다음 응용 프로그램은 테이블 반환 매개 변수의 TYPE_NAME를 *TableName* 매개 변수로 전달 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-164">The application then passes the TYPE_NAME of the table-valued parameter as the *TableName* parameter.</span></span> <span data-ttu-id="17698-165">SS_TYPE_CATALOG_NAME 및 SS_TYPE_SCHEMA_NAME는 각각 *CatalogName* 및 *SchemaName* 매개 변수와 함께 사용 되어 테이블 반환 매개 변수의 카탈로그와 스키마를 식별 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-165">SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME are used with the *CatalogName* and *SchemaName* parameters, respectively, to identify the catalog and schema for the table-valued parameter.</span></span> <span data-ttu-id="17698-166">애플리케이션이 테이블 반환 매개 변수의 메타데이터 검색을 마치면 SQL_SOPT_SS_NAME_SCOPE가 기본값인 SQL_SS_NAME_SCOPE_TABLE로 다시 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="17698-166">When an application has finished retrieving metadata for table-valued parameters, it must set SQL_SOPT_SS_NAME_SCOPE back to its default value of SQL_SS_NAME_SCOPE_TABLE.</span></span>  
  
 <span data-ttu-id="17698-167">SQL_SOPT_SS_NAME_SCOPE가 SQL_SS_NAME_SCOPE_TABLE로 설정되면 연결된 서버에 대한 쿼리가 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-167">When SQL_SOPT_SS_NAME_SCOPE is set to SQL_SS_NAME_SCOPE_TABLE, queries to linked servers fail.</span></span> <span data-ttu-id="17698-168">서버 구성 요소를 포함 하는 카탈로그를 사용 하 여 SQLColumns 또는 Sqlprimarykey를 호출 하면 실패 합니다.</span><span class="sxs-lookup"><span data-stu-id="17698-168">Calls to SQLColumns or SQLPrimaryKeys with a catalog that contains a server component will fail.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="17698-169">참고 항목</span><span class="sxs-lookup"><span data-stu-id="17698-169">See Also</span></span>  
 [<span data-ttu-id="17698-170">ODBC&#41;&#40;테이블 반환 매개 변수</span><span class="sxs-lookup"><span data-stu-id="17698-170">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
