---
title: 테이블 반환 매개 변수 및 열 값의 바인딩 및 데이터 전송 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), binding and data transfer
ms.assetid: 0a2ea462-d613-42b6-870f-c7fa086a6b42
author: rothja
ms.author: jroth
ms.openlocfilehash: 2e9e30e22a69b2d500990cc1481506b4edbda99b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87653857"
---
# <a name="binding-and-data-transfer-of-table-valued-parameters-and-column-values"></a><span data-ttu-id="8f4be-102">테이블 반환 매개 변수 및 열 값에 대한 바인딩 및 데이터 전송</span><span class="sxs-lookup"><span data-stu-id="8f4be-102">Binding and Data Transfer of Table-Valued Parameters and Column Values</span></span>
  <span data-ttu-id="8f4be-103">테이블 반환 매개 변수는 다른 매개 변수처럼 서버에 전달되기 전에 바인딩되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-103">Table-valued parameters, like other parameters, must be bound before they are passed to the server.</span></span> <span data-ttu-id="8f4be-104">응용 프로그램은 SQLSetDescField 또는 SQLSetDescRec에 대 한 SQLBindParameter 또는 동등한 호출을 사용 하 여 다른 매개 변수를 바인딩하는 것과 동일한 방식으로 테이블 반환 매개 변수를 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-104">The application binds table-valued parameters the same way it binds other parameters: by using SQLBindParameter or equivalent calls to SQLSetDescField or SQLSetDescRec.</span></span> <span data-ttu-id="8f4be-105">테이블 반환 매개 변수의 서버 데이터 형식은 SQL_SS_TABLE입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-105">The server data type for a table-valued parameter is SQL_SS_TABLE.</span></span> <span data-ttu-id="8f4be-106">C 형식은 SQL_C_DEFAULT 또는 SQL_C_BINARY로 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-106">The C type can be specified either as SQL_C_DEFAULT or SQL_C_BINARY.</span></span>  
  
 <span data-ttu-id="8f4be-107">[!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] 이상 버전에서는 입력 테이블 반환 매개 변수만 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-107">In [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)] or later, only input table-valued parameters are supported.</span></span> <span data-ttu-id="8f4be-108">따라서 DESC_PARAMETER_TYPE을 SQL_PARAM_INPUT 이외의 값으로 설정하면 SQLSTATE=HY105 및 "매개 변수 유형이 잘못되었습니다"라는 메시지가 포함된 SQL_ERROR가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-108">Therefore, any attempt to set SQL_DESC_PARAMETER_TYPE to a value other than SQL_PARAM_INPUT will return SQL_ERROR with SQLSTATE = HY105 and the message "Invalid parameter type".</span></span>  
  
 <span data-ttu-id="8f4be-109">SQL_CA_SS_COL_HAS_DEFAULT_VALUE 특성을 사용하여 전체 테이블 반환 매개 변수 열에 기본값을 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-109">Entire table-valued parameter columns can be assigned default values by using the attribute SQL_CA_SS_COL_HAS_DEFAULT_VALUE.</span></span> <span data-ttu-id="8f4be-110">그러나 SQLBindParameter와 *StrLen_or_IndPtr* 에서 SQL_DEFAULT_PARAM를 사용 하 여 개별 테이블 반환 매개 변수 열 값에 기본값을 할당할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-110">Individual table-valued parameter column values, however, cannot be assigned default values by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="8f4be-111">SQLBindParameter와 함께 *StrLen_or_IndPtr* 에서 SQL_DEFAULT_PARAM를 사용 하 여 전체 테이블 반환 매개 변수를 기본값으로 설정할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-111">Table-valued parameters as a whole cannot be set to a default value by using SQL_DEFAULT_PARAM in *StrLen_or_IndPtr* with SQLBindParameter.</span></span> <span data-ttu-id="8f4be-112">이러한 규칙을 따르지 않는 경우 SQLExecute 또는 SQLExecDirect는 SQL_ERROR을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-112">If these rules are not followed, SQLExecute or SQLExecDirect will return SQL_ERROR.</span></span> <span data-ttu-id="8f4be-113">SQLSTATE = 07S01 및 "매개 변수에 대 한 기본 매개 변수 사용이 잘못 되었습니다" 라는 메시지가 포함 된 진단 레코드가 생성 됩니다 \<p> \<p> . 여기서는 쿼리 문에서 TVP의 서 수입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-113">A diagnostic record will be generated with SQLSTATE=07S01 and the message "Invalid use of default parameter for parameter \<p>", where \<p> is the ordinal of the TVP in the query statement.</span></span>  
  
 <span data-ttu-id="8f4be-114">테이블 반환 매개 변수를 바인딩한 후에는 애플리케이션에서 각 테이블 반환 매개 변수 열을 바인딩해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-114">After binding the table-valued parameter, the application must then bind each table-valued parameter column.</span></span> <span data-ttu-id="8f4be-115">이렇게 하기 위해 응용 프로그램은 먼저 SQLSetStmtAttr를 호출 하 여 SQL_SOPT_SS_PARAM_FOCUS를 테이블 반환 매개 변수의 서 수로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-115">To do this, the application first calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of a table-valued parameter.</span></span> <span data-ttu-id="8f4be-116">그런 다음 응용 프로그램은 SQLBindParameter, SQLSetDescRec 및 SQLSetDescField 루틴을 호출 하 여 테이블 반환 매개 변수의 열을 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-116">Then the application binds the columns of the table-valued parameter by calls to the following routines: SQLBindParameter, SQLSetDescRec, and SQLSetDescField.</span></span> <span data-ttu-id="8f4be-117">SQL_SOPT_SS_PARAM_FOCUS를 0으로 설정 하면 일반적인 최상위 매개 변수에서 작동 하는 SQLBindParameter, SQLSetDescRec 및 SQLSetDescField의 일반적인 효과가 복원 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-117">Setting SQL_SOPT_SS_PARAM_FOCUS to 0 restores the usual effect of SQLBindParameter, SQLSetDescRec, and SQLSetDescField in operating on regular top-level parameters.</span></span>  
  
 <span data-ttu-id="8f4be-118">테이블 반환 매개 변수 자체에 대해 실제로 보내거나 받는 데이터는 없지만 매개 변수의 각 구성 열에 대해서는 데이터를 보내고 받습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-118">No actual data is sent or received for the table-valued parameter itself, but data is sent and received for each of its constituent columns.</span></span> <span data-ttu-id="8f4be-119">테이블 반환 매개 변수는 의사 열 이기 때문에 SQLBindParameter에 대 한 매개 변수는 다음과 같이 다른 데이터 형식과 다른 특성을 참조 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-119">Because the table-valued parameter is a pseudo column, the parameters for SQLBindParameter are used to refer to different attributes than other data types, as follows:</span></span>  
  
|<span data-ttu-id="8f4be-120">매개 변수</span><span class="sxs-lookup"><span data-stu-id="8f4be-120">Parameter</span></span>|<span data-ttu-id="8f4be-121">열을 포함 하 여 비 테이블 반환 매개 변수 형식에 대 한 관련 특성</span><span class="sxs-lookup"><span data-stu-id="8f4be-121">Related attribute for non-table-valued parameter types, including columns</span></span>|<span data-ttu-id="8f4be-122">테이블 반환 매개 변수에 대한 관련 특성</span><span class="sxs-lookup"><span data-stu-id="8f4be-122">Related attribute for table-valued parameters</span></span>|  
|---------------|--------------------------------------------------------------------------------|----------------------------------------------------|  
|<span data-ttu-id="8f4be-123">*InputOutputType*</span><span class="sxs-lookup"><span data-stu-id="8f4be-123">*InputOutputType*</span></span>|<span data-ttu-id="8f4be-124">IPD의 SQL_DESC_PARAMETER_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-124">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8f4be-125">테이블 반환 매개 변수 열의 경우 이 값은 테이블 반환 매개 변수 자체에 대한 설정과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-125">For table-valued parameter columns, this must be the same as the setting for the table-valued parameter itself.</span></span>|<span data-ttu-id="8f4be-126">IPD의 SQL_DESC_PARAMETER_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-126">SQL_DESC_PARAMETER_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8f4be-127">SQL_PARAM_INPUT이여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-127">This must be SQL_PARAM_INPUT.</span></span>|  
|<span data-ttu-id="8f4be-128">*System.valuetype*</span><span class="sxs-lookup"><span data-stu-id="8f4be-128">*ValueType*</span></span>|<span data-ttu-id="8f4be-129">APD의 SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-129">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span>|<span data-ttu-id="8f4be-130">APD의 SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-130">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in APD.</span></span><br /><br /> <span data-ttu-id="8f4be-131">SQL_C_DEFAULT 또는 SQL_C_BINARY여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-131">This must be SQL_C_DEFAULT or SQL_C_BINARY.</span></span>|  
|<span data-ttu-id="8f4be-132">*ParameterType*</span><span class="sxs-lookup"><span data-stu-id="8f4be-132">*ParameterType*</span></span>|<span data-ttu-id="8f4be-133">IPD의 SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-133">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span>|<span data-ttu-id="8f4be-134">IPD의 SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE</span><span class="sxs-lookup"><span data-stu-id="8f4be-134">SQL_DESC_TYPE, SQL_DESC_CONCISE_TYPE in IPD.</span></span><br /><br /> <span data-ttu-id="8f4be-135">SQL_SS_TABLE이여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-135">This must be SQL_SS_TABLE.</span></span>|  
|<span data-ttu-id="8f4be-136">*ColumnSize*</span><span class="sxs-lookup"><span data-stu-id="8f4be-136">*ColumnSize*</span></span>|<span data-ttu-id="8f4be-137">IPD의 SQL_DESC_LENGTH 또는 SQL_DESC_PRECISION</span><span class="sxs-lookup"><span data-stu-id="8f4be-137">SQL_DESC_LENGTH or SQL_DESC_PRECISION in IPD.</span></span><br /><br /> <span data-ttu-id="8f4be-138">이는 *ParameterType*의 값에 따라 달라 집니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-138">This depends on the value of *ParameterType*.</span></span>|<span data-ttu-id="8f4be-139">SQL_DESC_ARRAY_SIZE</span><span class="sxs-lookup"><span data-stu-id="8f4be-139">SQL_DESC_ARRAY_SIZE</span></span><br /><br /> <span data-ttu-id="8f4be-140">매개 변수 포커스를 테이블 반환 매개 변수로 설정할 때 SQL_ATTR_PARAM_SET_SIZE를 사용하여 설정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-140">Can also be set using SQL_ATTR_PARAM_SET_SIZE when the parameter focus is set to the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="8f4be-141">테이블 반환 매개 변수의 경우 이 값은 테이블 반환 매개 변수 열 버퍼의 행 수입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-141">For a table-valued parameter, this is the number of rows in the table-valued parameter column buffers.</span></span>|  
|<span data-ttu-id="8f4be-142">*DecimalDigits*</span><span class="sxs-lookup"><span data-stu-id="8f4be-142">*DecimalDigits*</span></span>|<span data-ttu-id="8f4be-143">IPD의 SQL_DESC_PRECISION 또는 SQL_DESC_SCALE</span><span class="sxs-lookup"><span data-stu-id="8f4be-143">SQL_DESC_PRECISION or SQL_DESC_SCALE in IPD.</span></span>|<span data-ttu-id="8f4be-144">사용되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-144">Unused.</span></span> <span data-ttu-id="8f4be-145">0이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-145">This must be 0.</span></span><br /><br /> <span data-ttu-id="8f4be-146">이 매개 변수가 0이 아닌 경우 SQLBindParameter는 SQL_ERROR를 반환 하 고 SQLSTATE = HY104 및 "잘못 된 전체 자릿수 또는 소수 자릿수가 있습니다." 라는 메시지가 포함 된 진단 레코드가 생성 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-146">If this parameter is not 0, SQLBindParameter will return SQL_ERROR, and a diagnostic record will be generated with SQLSTATE= HY104 and the message "Invalid precision or scale".</span></span>|  
|<span data-ttu-id="8f4be-147">*ParameterValuePtr*</span><span class="sxs-lookup"><span data-stu-id="8f4be-147">*ParameterValuePtr*</span></span>|<span data-ttu-id="8f4be-148">APD의 SQL_DESC_DATA_PTR</span><span class="sxs-lookup"><span data-stu-id="8f4be-148">SQL_DESC_DATA_PTR in APD.</span></span>|<span data-ttu-id="8f4be-149">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="8f4be-149">SQL_CA_SS_TYPE_NAME.</span></span><br /><br /> <span data-ttu-id="8f4be-150">저장 프로시저 호출의 경우 선택 사항이며 필요하지 않은 경우 NULL을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-150">This is optional for stored procedure calls, and NULL can be specified if it is not required.</span></span> <span data-ttu-id="8f4be-151">프로시저 호출이 아닌 SQL 문에는 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-151">It must be specified for SQL statements that are not procedure calls.</span></span><br /><br /> <span data-ttu-id="8f4be-152">또한 이 매개 변수는 변수 행 바인딩을 사용할 때 애플리케이션에서 이 테이블 반환 매개 변수를 식별하는 데 사용할 수 있는 고유 값으로도 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-152">This parameter also serves as a unique value that the application can use to identify this table-valued parameter when variable row binding is used.</span></span> <span data-ttu-id="8f4be-153">자세한 내용은 이 항목의 뒷부분에 나오는 "가변 테이블 반환 매개 변수 행 바인딩" 섹션을 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="8f4be-153">For more information, see the "Variable Table-Valued Parameter Row Binding" section, later in this topic.</span></span><br /><br /> <span data-ttu-id="8f4be-154">SQLBindParameter에 대 한 호출에 테이블 반환 매개 변수 형식 이름을 지정 하는 경우 ANSI 응용 프로그램으로 빌드된 응용 프로그램 에서도 해당 이름을 유니코드 값으로 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-154">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="8f4be-155">*StrLen_or_IndPtr* 매개 변수에 사용 되는 값은 SQL_NTS 이거나 이름의 문자열 길이에 SIZEOF (WCHAR)를 곱합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-155">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span>|  
|<span data-ttu-id="8f4be-156">*BufferLength*</span><span class="sxs-lookup"><span data-stu-id="8f4be-156">*BufferLength*</span></span>|<span data-ttu-id="8f4be-157">APD의 SQL_DESC_OCTET_LENGTH</span><span class="sxs-lookup"><span data-stu-id="8f4be-157">SQL_DESC_OCTET_LENGTH in APD.</span></span>|<span data-ttu-id="8f4be-158">테이블 반환 매개 변수 형식 이름의 길이(바이트)입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-158">The length of the table-valued parameter type name in bytes.</span></span><br /><br /> <span data-ttu-id="8f4be-159">형식 이름이 null로 끝나는 경우 SQL_NTS이고 테이블 반환 매개 변수 형식 이름이 필요하지 않은 경우 0입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-159">This can be SQL_NTS if the type name is null terminated, or 0 if the table-valued parameter type name is not required.</span></span>|  
|<span data-ttu-id="8f4be-160">*StrLen_or_IndPtr*</span><span class="sxs-lookup"><span data-stu-id="8f4be-160">*StrLen_or_IndPtr*</span></span>|<span data-ttu-id="8f4be-161">APD의 SQL_DESC_OCTET_LENGTH_PTR</span><span class="sxs-lookup"><span data-stu-id="8f4be-161">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span>|<span data-ttu-id="8f4be-162">APD의 SQL_DESC_OCTET_LENGTH_PTR</span><span class="sxs-lookup"><span data-stu-id="8f4be-162">SQL_DESC_OCTET_LENGTH_PTR in APD.</span></span><br /><br /> <span data-ttu-id="8f4be-163">테이블 반환 매개 변수의 경우 데이터 길이가 아닌 행 수입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-163">For table-valued parameters, this is a row count rather than a data length.</span></span>|  
  
 <span data-ttu-id="8f4be-164">테이블 반환 매개 변수에 대해서는 고정 행 바인딩과 가변 행 바인딩의 두 가지 데이터 전송 모드가 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-164">Two data transfer modes are supported for table-valued parameters: fixed row binding and variable row binding.</span></span>  
  
## <a name="fixed-table-valued-parameter-row-binding"></a><span data-ttu-id="8f4be-165">고정 테이블 반환 매개 변수 행 바인딩</span><span class="sxs-lookup"><span data-stu-id="8f4be-165">Fixed Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="8f4be-166">고정 행 바인딩에서는 애플리케이션이 가능한 모든 입력 열 값을 수용할 수 있는 크기의 버퍼 또는 버퍼 배열을 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-166">For fixed row binding, an application allocates buffers (or buffer arrays) large enough for all possible input column values.</span></span> <span data-ttu-id="8f4be-167">이 애플리케이션에서는 다음 작업을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-167">The application does the following:</span></span>  
  
1.  <span data-ttu-id="8f4be-168">SQLBindParameter, SQLSetDescRec 또는 SQLSetDescField 호출을 사용 하 여 모든 매개 변수를 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-168">Binds all parameters by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    1.  <span data-ttu-id="8f4be-169">SQL_DESC_ARRAY_SIZE를 각 테이블 반환 매개 변수에 대해 전송될 수 있는 최대 행 수로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-169">Sets SQL_DESC_ARRAY_SIZE to the maximum number of rows that can be transferred for each table-valued parameter.</span></span> <span data-ttu-id="8f4be-170">SQLBindParameter 호출에서이 작업을 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-170">This can be done in the SQLBindParameter call.</span></span>  
  
2.  <span data-ttu-id="8f4be-171">SQLSetStmtAttr를 호출 하 여 SQL_SOPT_SS_PARAM_FOCUS를 각 테이블 반환 매개 변수의 서 수로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-171">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to the ordinal of each table-valued parameter.</span></span>  
  
    1.  <span data-ttu-id="8f4be-172">각 테이블 반환 매개 변수에 대해은 SQLBindParameter, SQLSetDescRec 또는 SQLSetDescField 호출을 사용 하 여 테이블 반환 매개 변수 열을 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-172">For each table-valued parameter, binds table-valued parameter columns by using SQLBindParameter, SQLSetDescRec, or SQLSetDescField calls.</span></span>  
  
    2.  <span data-ttu-id="8f4be-173">기본값이 있는 각 테이블 반환 매개 변수 열에 대해 SQLSetDescField를 호출 하 여 SQL_CA_SS_COL_HAS_DEFAULT_VALUE를 1로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-173">For each table-valued parameter column that is to have default values, calls SQLSetDescField to set SQL_CA_SS_COL_HAS_DEFAULT_VALUE to 1.</span></span>  
  
3.  <span data-ttu-id="8f4be-174">SQLSetStmtAttr를 호출 하 여 SQL_SOPT_SS_PARAM_FOCUS를 0으로 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-174">Calls SQLSetStmtAttr to set SQL_SOPT_SS_PARAM_FOCUS to 0.</span></span> <span data-ttu-id="8f4be-175">SQLExecute 또는 SQLExecDirect를 호출 하기 전에이 작업을 수행 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-175">This must be done before SQLExecute or SQLExecDirect is called.</span></span> <span data-ttu-id="8f4be-176">그렇지 않으면 SQL_ERROR가 반환되고 SQLSTATE=HY024 및 "특성 값 SQL_SOPT_SS_PARAM_FOCUS가 잘못되었습니다. 실행 시 0이어야 합니다"라는 메시지가 포함된 진단 레코드가 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-176">Otherwise, SQL_ERROR is be returned and a diagnostic record is generated with SQLSTATE=HY024 and the message "Invalid attribute value, SQL_SOPT_SS_PARAM_FOCUS (must be zero at execution time)".</span></span>  
  
4.  <span data-ttu-id="8f4be-177">*StrLen_or_IndPtr* 또는 SQL_DESC_OCTET_LENGTH_PTR를 설정 하 여 행이 없는 테이블 반환 매개 변수에 대해 또는 테이블 반환 매개 변수에 행이 있는 경우 sqlexecute 또는 SQLExecDirect를 호출할 때 전송 되는 행 수를 SQL_DEFAULT_PARAM 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-177">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR to SQL_DEFAULT_PARAM for a table-valued parameter with no rows, or the number of rows to be transferred on the next call of SQLExecute or SQLExecDirect if the table-valued parameter has rows.</span></span> <span data-ttu-id="8f4be-178">테이블 반환 매개 변수는 null을 허용 하지 않으므로 테이블 반환 매개 변수는 null을 허용 하지 않지만 테이블 반환 매개 변수는 null을 허용 하지 않으므로 *StrLen_or_IndPtr* 또는 SQL_DESC_OCTET_LENGTH_PTR를 SQL_NULL_DATA로 설정할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-178">*StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR cannot be set to SQL_NULL_DATA for a table-valued parameter as table-valued parameters are not nullable (though table-valued parameter constituent columns may be nullable).</span></span> <span data-ttu-id="8f4be-179">이 값이 잘못 된 값으로 설정 된 경우 SQLExecute 또는 SQLExecDirect는 SQL_ERROR를 반환 하 고 SQLSTATE = HY090 및 "매개 변수의 문자열 또는 버퍼 길이가 잘못 되었습니다" 라는 메시지가 포함 된 진단 레코드가 생성 됩니다 \<p> . 여기서 p는 매개 변수 번호입니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-179">If this is set to an invalid value, SQLExecute or SQLExecDirect returns SQL_ERROR, and a diagnostic record is generated with SQLSTATE=HY090 and the message "Invalid string or buffer length for parameter \<p>", where p is the parameter number.</span></span>  
  
5.  <span data-ttu-id="8f4be-180">SQLExecute 또는 SQLExecDirect를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-180">Calls SQLExecute or SQLExecDirect.</span></span>  
  
 <span data-ttu-id="8f4be-181">열에 대 한 *StrLen_or_IndPtr* SQL_LEN_DATA_AT_EXEC (*길이*) 또는 SQL_DATA_AT_EXEC으로 설정 된 경우 입력 테이블 반환 매개 변수 열 값이 여러 부분으로 전달 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-181">Input table-valued parameter column values can be passed in pieces if *StrLen_or_IndPtr* is set to SQL_LEN_DATA_AT_EXEC(*length*) or SQL_DATA_AT_EXEC for the column.</span></span> <span data-ttu-id="8f4be-182">이는 매개 변수 배열을 사용할 때 값을 개별적으로 전달하는 것과 유사합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-182">This is similar to passing values in pieces when arrays of parameters are used.</span></span> <span data-ttu-id="8f4be-183">모든 실행 시 데이터 매개 변수와 마찬가지로 SQLParamData는 드라이버에서 데이터를 요청 하는 배열의 행을 나타내지 않습니다. 응용 프로그램에서이를 처리 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-183">As with all data-at-execution parameters, SQLParamData does not indicate which row of the array the driver is requesting data for; the application must take care of this.</span></span> <span data-ttu-id="8f4be-184">애플리케이션은 드라이버에서 값을 요청하는 순서에 대해 어떠한 가정도 할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-184">The application cannot make any assumptions about the order in which the driver will request values.</span></span>  
  
## <a name="variable-table-valued-parameter-row-binding"></a><span data-ttu-id="8f4be-185">가변 테이블 반환 매개 변수 행 바인딩</span><span class="sxs-lookup"><span data-stu-id="8f4be-185">Variable Table-Valued Parameter Row Binding</span></span>  
 <span data-ttu-id="8f4be-186">가변 행 바인딩에서는 행이 실행 시 일괄 처리로 전송되며 요청 시 애플리케이션에서 행을 드라이버에 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-186">For variable row binding, rows are transferred in batches at execution time and the application passes rows to the driver on demand.</span></span> <span data-ttu-id="8f4be-187">이는 개별 매개 변수 값의 실행 시 데이터와 유사합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-187">This is similar to data-at-execution for individual parameter values.</span></span> <span data-ttu-id="8f4be-188">가변 행 바인딩에서 애플리케이션은 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-188">For variable row binding, the application does the following:</span></span>  
  
1.  <span data-ttu-id="8f4be-189">이전 섹션 "고정 테이블 반환 매개 변수 행 바인딩"의 1~3단계에서 설명한 대로 매개 변수 및 테이블 반환 매개 변수 열을 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-189">Binds parameters and table-valued parameter columns as described in steps 1 to 3 of the previous section, "Fixed Table-Valued Parameter Row Binding".</span></span>  
  
2.  <span data-ttu-id="8f4be-190">실행 시 SQL_DATA_AT_EXEC에 전달할 테이블 반환 매개 변수에 대 한 *StrLen_or_IndPtr* 또는 SQL_DESC_OCTET_LENGTH_PTR를 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-190">Sets *StrLen_or_IndPtr* or SQL_DESC_OCTET_LENGTH_PTR for any table-valued parameters that are to be passed at execution time to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="8f4be-191">이 중 하나라도 설정하지 않으면 매개 변수가 이전 섹션에 설명된 대로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-191">If neither is set, the parameter will be processed as described in the previous section.</span></span>  
  
3.  <span data-ttu-id="8f4be-192">SQLExecute 또는 SQLExecDirect를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-192">Calls SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="8f4be-193">이렇게 하면 실행 시 데이터 매개 변수로 처리할 SQL_PARAM_INPUT 또는 SQL_PARAM_INPUT_OUTPUT 매개 변수가 있는 경우 SQL_NEED_DATA가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-193">This will return SQL_NEED_DATA if there are any SQL_PARAM_INPUT or SQL_PARAM_INPUT_OUTPUT parameters to be handled as data-at-execution parameters.</span></span> <span data-ttu-id="8f4be-194">이 경우 애플리케이션을 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-194">In this case, the application does the following:</span></span>  
  
    -   <span data-ttu-id="8f4be-195">SQLParamData를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-195">Calls SQLParamData.</span></span> <span data-ttu-id="8f4be-196">이렇게 하면 실행 시 데이터 매개 변수 및 SQL_NEED_DATA 반환 코드에 대 한 *Parametervalueptr* 값이 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-196">This returns the *ParameterValuePtr* value for a data-at-execution parameter and a return code of SQL_NEED_DATA.</span></span> <span data-ttu-id="8f4be-197">모든 매개 변수 데이터가 드라이버에 전달 된 경우 SQLParamData는 SQL_SUCCESS, SQL_SUCCESS_WITH_INFO 또는 SQL_ERROR를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-197">When all parameter data has been passed to the driver, SQLParamData returns SQL_SUCCESS, SQL_SUCCESS_WITH_INFO, or SQL_ERROR.</span></span> <span data-ttu-id="8f4be-198">실행 시 데이터 매개 변수의 경우 설명자 필드 SQL_DESC_DATA_PTR와 동일한 *Parametervalueptr*은 값이 필요한 매개 변수를 고유 하 게 식별 하는 토큰으로 간주 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-198">For data-at-execution parameters, *ParameterValuePtr*, which is the same as the descriptor field SQL_DESC_DATA_PTR, can be regarded as a token to uniquely identify a parameter for which a value is required.</span></span> <span data-ttu-id="8f4be-199">이 &quot;토큰&quot;은 바인딩 시 애플리케이션에서 드라이버로 전달된 다음 실행 시 애플리케이션으로 다시 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-199">This "token" is passed from the application to the driver at bind time, then passed back to the application at execution time.</span></span>  
  
4.  <span data-ttu-id="8f4be-200">Null 테이블 반환 매개 변수에 대 한 테이블 반환 매개 변수 행 데이터를 전송 하기 위해 테이블 반환 매개 변수에 행이 없는 경우 응용 프로그램은 *StrLen_or_Ind* 이 SQL_DEFAULT_PARAM으로 설정 된 SQLPutData를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-200">To send table-valued parameter row data for null table-valued parameters, if the table-valued parameter has no rows, an application calls SQLPutData with *StrLen_or_Ind* set to SQL_DEFAULT_PARAM.</span></span>  
  
     <span data-ttu-id="8f4be-201">NULL이 아닌 TVP의 경우 애플리케이션은 다음을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-201">For non-NULL TVPs, an application:</span></span>  
  
    -   <span data-ttu-id="8f4be-202">모든 테이블 반환 매개 변수 열에 대 한 *Str_Len_or_Ind* 를 적절 한 값으로 설정 하 고, 실행 시 데이터 매개 변수가 되지 않는 테이블 반환 매개 변수 열에 대해 데이터 버퍼를 채웁니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-202">Sets *Str_Len_or_Ind* for all the table-valued parameter columns to appropriate values, and populates data buffers for table-valued parameter columns that are not to be data-at-execution parameters.</span></span> <span data-ttu-id="8f4be-203">일반 매개 변수를 드라이버에 개별적으로 전달할 수 있는 방법과 유사하게 테이블 반환 매개 변수 열에 실행 시 데이터를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-203">You can use data-at-execution for table-valued parameter columns in a similar way to that in which ordinary parameters can be passed to the driver in pieces.</span></span>  
  
    -   <span data-ttu-id="8f4be-204">서버에 전송할 행 수로 설정 된 *Str_Len_or_Ind* 를 사용 하 여 SQLPutData를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-204">Calls SQLPutData with *Str_Len_or_Ind* set to the number of rows to be sent to the server.</span></span> <span data-ttu-id="8f4be-205">값이 0에서 SQL_DESC_ARRAY_SIZE 또는 SQL_DEFAULT_PARAM 사이의 범위를 벗어나면 오류가 발생하고 "문자열 또는 버퍼 길이가 잘못되었습니다"라는 메시지와 함께 SQLSTATE=HY090이 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-205">Any value outside the range 0 to SQL_DESC_ARRAY_SIZE or SQL_DEFAULT_PARAM is an error, and will return SQLSTATE HY090, with the message "Invalid string or buffer length".</span></span> <span data-ttu-id="8f4be-206">0은 이 목록의 두 번째 글머리 항목에 설명된 대로 모든 행을 보냈으며 테이블 반환 매개 변수의 데이터가 더 이상 없음을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-206">0 indicates that all rows have been sent and there is no more data for a table-valued parameter (as noted in the second bullet item in this list).</span></span> <span data-ttu-id="8f4be-207">SQL_DEFAULT_PARAM은 이 목록의 첫 번째 글머리 항목에 설명된 대로 드라이버에서 테이블 반환 매개 변수의 데이터를 처음으로 요청할 때에만 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-207">SQL_DEFAULT_PARAM can only be used the first time the driver requests data for a table-valued parameter (as described in the first bullet item in this list).</span></span>  
  
5.  <span data-ttu-id="8f4be-208">모든 행을 보낸 경우는 *Str_Len_or_Ind* 값이 0 인 테이블 반환 매개 변수에 대해 SQLPutData를 호출 하 고 위의 3a 단계를 진행 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-208">When all rows have been sent, calls SQLPutData for the table-valued parameter with a *Str_Len_or_Ind* value of 0, then proceeds to step 3a above.</span></span>  
  
6.  <span data-ttu-id="8f4be-209">SQLParamData를 다시 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-209">Calls SQLParamData again.</span></span> <span data-ttu-id="8f4be-210">테이블 반환 매개 변수 열 사이에 실행 시 데이터 매개 변수가 있는 경우이 매개 변수는 SQLParamData *에서 반환 된* 값으로 식별 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-210">If there are any data-at-execution parameters among the table-valued parameter columns, these will be identified by the value *ValuePtrPtr* returned by SQLParamData.</span></span> <span data-ttu-id="8f4be-211">모든 열 값을 사용할 수 있는 경우 SQLParamData는 테이블 반환 매개 변수에 대 한 *Parametervalueptr* 값을 다시 반환 하 고 응용 프로그램을 다시 시작 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f4be-211">When all column values are available, SQLParamData will again return the *ParameterValuePtr* value for the table-valued parameter, and the application begins again.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8f4be-212">참고 항목</span><span class="sxs-lookup"><span data-stu-id="8f4be-212">See Also</span></span>  
 [<span data-ttu-id="8f4be-213">ODBC&#41;&#40;테이블 반환 매개 변수</span><span class="sxs-lookup"><span data-stu-id="8f4be-213">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
