---
title: 테이블 반환 매개 변수 설명자 필드 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), descriptor fields
ms.assetid: 4e009eff-c156-4d63-abcf-082ddd304de2
author: rothja
ms.author: jroth
ms.openlocfilehash: 5365229aed0bc46315a7e6db5448bee6963b23fc
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730639"
---
# <a name="table-valued-parameter-descriptor-fields"></a><span data-ttu-id="ba210-102">테이블 반환 매개 변수 설명자 필드</span><span class="sxs-lookup"><span data-stu-id="ba210-102">Table-Valued Parameter Descriptor Fields</span></span>
  <span data-ttu-id="ba210-103">테이블 반환 매개 변수 지원에는 ODBC APD(애플리케이션 매개 변수 설명자) 및 IPD(구현 매개 변수 설명자)의 새로운 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 관련 필드가 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-103">Support for table-valued parameters includes new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific fields in ODBC application parameter descriptors (APDs) and implementation parameter descriptors (IPDs).</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="ba210-104">설명</span><span class="sxs-lookup"><span data-stu-id="ba210-104">Remarks</span></span>  
  
|<span data-ttu-id="ba210-105">이름</span><span class="sxs-lookup"><span data-stu-id="ba210-105">Name</span></span>|<span data-ttu-id="ba210-106">위치</span><span class="sxs-lookup"><span data-stu-id="ba210-106">Location</span></span>|<span data-ttu-id="ba210-107">형식</span><span class="sxs-lookup"><span data-stu-id="ba210-107">Type</span></span>|<span data-ttu-id="ba210-108">설명</span><span class="sxs-lookup"><span data-stu-id="ba210-108">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="ba210-109">SQL_CA_SS_TYPE_NAME</span><span class="sxs-lookup"><span data-stu-id="ba210-109">SQL_CA_SS_TYPE_NAME</span></span>|<span data-ttu-id="ba210-110">IPD</span><span class="sxs-lookup"><span data-stu-id="ba210-110">IPD</span></span>|<span data-ttu-id="ba210-111">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="ba210-111">SQLTCHAR\*</span></span>|<span data-ttu-id="ba210-112">테이블 반환 매개 변수의 서버 유형 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-112">The server type name of the table-valued parameter.</span></span><br /><br /> <span data-ttu-id="ba210-113">SQLBindParameter에 대 한 호출에 테이블 반환 매개 변수 형식 이름을 지정 하는 경우 ANSI 응용 프로그램으로 빌드된 응용 프로그램 에서도 항상 유니코드 값으로 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-113">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="ba210-114">*StrLen_or_IndPtr* 매개 변수에 사용 되는 값은 SQL_NTS 이거나 이름의 문자열 길이에 SIZEOF (WCHAR)를 곱합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-114">The value used for the parameter *StrLen_or_IndPtr* should be either SQL_NTS or the string length of the name multiplied by sizeof(WCHAR).</span></span><br /><br /> <span data-ttu-id="ba210-115">SQLSetDescField를 통해 테이블 반환 매개 변수 형식 이름을 지정 하는 경우 응용 프로그램을 빌드하는 방법에 맞는 리터럴을 사용 하 여 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-115">When a table-valued parameter type name is specified via SQLSetDescField, it can be specified by using a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="ba210-116">ODBC 드라이버 관리자에서 필요한 모든 유니코드 변환을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-116">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>|  
|<span data-ttu-id="ba210-117">SQL_CA_SS_TYPE_CATALOG_NAME(읽기 전용)</span><span class="sxs-lookup"><span data-stu-id="ba210-117">SQL_CA_SS_TYPE_CATALOG_NAME (read only)</span></span>|<span data-ttu-id="ba210-118">IPD</span><span class="sxs-lookup"><span data-stu-id="ba210-118">IPD</span></span>|<span data-ttu-id="ba210-119">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="ba210-119">SQLTCHAR\*</span></span>|<span data-ttu-id="ba210-120">유형이 정의된 카탈로그입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-120">The catalog where the type is defined.</span></span>|  
|<span data-ttu-id="ba210-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span><span class="sxs-lookup"><span data-stu-id="ba210-121">SQL_CA_SS_TYPE_SCHEMA_NAME</span></span>|<span data-ttu-id="ba210-122">IPD</span><span class="sxs-lookup"><span data-stu-id="ba210-122">IPD</span></span>|<span data-ttu-id="ba210-123">SQLTCHAR\*</span><span class="sxs-lookup"><span data-stu-id="ba210-123">SQLTCHAR\*</span></span>|<span data-ttu-id="ba210-124">유형이 정의된 스키마입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-124">The schema where the type is defined.</span></span>|  
  
 <span data-ttu-id="ba210-125">애플리케이션에서 테이블 반환 매개 변수에 대해 SQL_CA_SS_TYPE_CATALOG_NAME을 설정하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-125">Applications must not set SQL_CA_SS_TYPE_CATALOG_NAME for table-valued parameters.</span></span> <span data-ttu-id="ba210-126">이렇게 하면 SQL_ERROR가 반환되며 SQLSTATE = HY091 및 "잘못된 설명자 필드 식별자입니다"라는 메시지가 포함된 진단 레코드가 기록됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-126">Doing so will return a SQL_ERROR and log a diagnostic record with SQLSTATE = HY091 and the message "Invalid descriptor field identifier".</span></span>  
  
 <span data-ttu-id="ba210-127">매개 변수 포커스가 테이블 반환 매개 변수로 설정된 경우 다음 문 특성과 설명자 헤더 필드가 테이블 반환 매개 변수에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-127">The following statement attributes and descriptor header fields apply to table-valued parameters when the parameter focus is set to a table-valued parameter:</span></span>  
  
|<span data-ttu-id="ba210-128">이름</span><span class="sxs-lookup"><span data-stu-id="ba210-128">Name</span></span>|<span data-ttu-id="ba210-129">위치</span><span class="sxs-lookup"><span data-stu-id="ba210-129">Location</span></span>|<span data-ttu-id="ba210-130">형식</span><span class="sxs-lookup"><span data-stu-id="ba210-130">Type</span></span>|<span data-ttu-id="ba210-131">설명</span><span class="sxs-lookup"><span data-stu-id="ba210-131">Description</span></span>|  
|----------|--------------|----------|-----------------|  
|<span data-ttu-id="ba210-132">SQL_ATTR_PARAMSET_SIZE</span><span class="sxs-lookup"><span data-stu-id="ba210-132">SQL_ATTR_PARAMSET_SIZE</span></span><br /><br /> <span data-ttu-id="ba210-133">APD의 SQL_DESC_ARRAY_SIZE와 같습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-133">(This is equivalent to SQL_DESC_ARRAY_SIZE in the APD.)</span></span>|<span data-ttu-id="ba210-134">APD</span><span class="sxs-lookup"><span data-stu-id="ba210-134">APD</span></span>|<span data-ttu-id="ba210-135">SQLUINTEGER</span><span class="sxs-lookup"><span data-stu-id="ba210-135">SQLUINTEGER</span></span>|<span data-ttu-id="ba210-136">테이블 반환 매개 변수에 대한 버퍼 배열의 배열 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-136">The array size of the buffer arrays for a table-valued parameter.</span></span> <span data-ttu-id="ba210-137">이 값은 버퍼에 포함될 최대 행 수이거나 행의 버퍼 크기입니다. 테이블 반환 매개 변수 값 자체는 버퍼에 포함될 수 있는 것보다 많거나 적은 행을 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-137">This is the maximum number of rows the buffers will accommodate or the size of the buffers in rows; the table-valued parameter value itself might have more or fewer rows than the buffers can hold.</span></span> <span data-ttu-id="ba210-138">기본값은 1입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-138">Default is 1.</span></span> <span data-ttu-id="ba210-139">**참고:**  SQL_SOPT_SS_PARAM_FOCUS 기본값 0으로 설정 된 경우 SQL_ATTR_PARAMSET_SIZE는 문을 참조 하 고 매개 변수 집합의 수를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-139">**Note:**  If SQL_SOPT_SS_PARAM_FOCUS is set to its default value of 0, SQL_ATTR_PARAMSET_SIZE refers to the statement and specifies the number of parameter sets.</span></span> <span data-ttu-id="ba210-140">SQL_SOPT_SS_PARAM_FOCUS가 테이블 반환 매개 변수의 서수로 설정된 경우 테이블 반환 매개 변수를 참조하며 테이블 반환 매개 변수에 대해 매개 변수 집합당 행 수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-140">If SQL_SOPT_SS_PARAM_FOCUS is set to the ordinal of a table-valued parameter, it refers to the table-valued parameter and specifies the number of rows per parameter set for the table-valued parameter.</span></span>|  
|<span data-ttu-id="ba210-141">SQL_ATTR_PARAM _BIND_TYPE</span><span class="sxs-lookup"><span data-stu-id="ba210-141">SQL_ATTR_PARAM _BIND_TYPE</span></span>|<span data-ttu-id="ba210-142">APD</span><span class="sxs-lookup"><span data-stu-id="ba210-142">APD</span></span>|<span data-ttu-id="ba210-143">SQLINTEGER</span><span class="sxs-lookup"><span data-stu-id="ba210-143">SQLINTEGER</span></span>|<span data-ttu-id="ba210-144">기본값은 SQL_PARAM_BIND_BY_COLUMN입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-144">The default is SQL_PARAM_BIND_BY_COLUMN.</span></span><br /><br /> <span data-ttu-id="ba210-145">행 단위 바인딩을 선택하려면 이 필드를 테이블 반환 매개 변수 행 집합에 바인딩될 버퍼 인스턴스나 구조의 길이로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-145">To select row-wise binding, this field is set to the length of the structure or an instance of a buffer that will be bound to a set of table-valued parameter rows.</span></span> <span data-ttu-id="ba210-146">이 길이에는 바인딩된 모든 열과 구조 또는 버퍼의 패딩에 대한 공간이 포함되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-146">This length must include space for all of the bound columns and any padding of the structure or buffer.</span></span> <span data-ttu-id="ba210-147">이렇게 하면 바인딩된 열의 주소가 지정된 길이로 증가할 때 결과가 다음 행에 있는 동일한 열의 시작 부분을 가리킵니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-147">This ensures that when the address of a bound column is incremented with the specified length, the result will point to the beginning of the same column in the next row.</span></span> <span data-ttu-id="ba210-148">ANSI C의 `sizeof` 연산자를 사용하는 경우 이 동작이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-148">When using the `sizeof` operator in ANSI C, this behavior is guaranteed.</span></span>|  
|<span data-ttu-id="ba210-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span><span class="sxs-lookup"><span data-stu-id="ba210-149">SQL_ATTR_PARAM_BIND_OFFSET_PTR</span></span>|<span data-ttu-id="ba210-150">APD</span><span class="sxs-lookup"><span data-stu-id="ba210-150">APD</span></span>|<span data-ttu-id="ba210-151">SQLINTEGER\*</span><span class="sxs-lookup"><span data-stu-id="ba210-151">SQLINTEGER\*</span></span>|<span data-ttu-id="ba210-152">기본값은 Null 포인터입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-152">The default is a null pointer.</span></span><br /><br /> <span data-ttu-id="ba210-153">이 필드가 Null이 아니면 드라이버에서 포인터를 역참조하고, 설명자 레코드(SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR 및 SQL_DESC_OCTET_LENGTH_PTR)의 각 지연된 필드에 역참조된 값을 추가하며, 새 포인터 값을 사용하여 데이터 값에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-153">If this field is non-null, the driver dereferences the pointer, adds the dereferenced value to each of the deferred fields in the descriptor record (SQL_DESC_DATA_PTR, SQL_DESC_INDICATOR_PTR, and SQL_DESC_OCTET_LENGTH_PTR), and uses the new pointer values to access data values.</span></span>|  
  
 <span data-ttu-id="ba210-154">이 필드는 테이블 반환 매개 변수에서만 유효하고 다른 데이터 형식에 대해서는 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-154">These fields are only valid with table-valued parameters, and are ignored for other data types.</span></span>  
  
 <span data-ttu-id="ba210-155">저장 프로시저 호출에서 SQL_CA_SS_TYPE_NAME은 옵션입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-155">SQL_CA_SS_TYPE_NAME is optional for stored procedure calls.</span></span> <span data-ttu-id="ba210-156">서버에서 테이블 반환 매개 변수의 유형을 확인할 수 있게 하려면 프로시저 호출이 아닌 SQL 문에 대해 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-156">It must be specified for SQL statements that are not procedure calls to enable the server to determine the type of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="ba210-157">유형 이름이 필수이고 테이블 반환 매개 변수의 테이블 유형이 저장 프로시저와는 다른 스키마에 정의되어 있으면 IPD(구현 매개 변수 설명자)에 SQL_CA_SS_TYPE_SCHEMA_NAME을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-157">If the type name is reqired and the table type for the table-valued parameter is defined in a different schema than the stored procedure, SQL_CA_SS_TYPE_SCHEMA_NAME must be specified in the implementation parameter descriptor (IPD).</span></span> <span data-ttu-id="ba210-158">그렇지 않으면 서버에서 테이블 반환 매개 변수의 유형을 확인할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-158">If not, the server will not be able to determine the type of the table-valued parameter.</span></span> <span data-ttu-id="ba210-159">그러면 SQLExecute 또는 SQLExecDirect를 호출할 때 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-159">This will result in an error when you call SQLExecute or SQLExecDirect.</span></span> <span data-ttu-id="ba210-160">오류에는 SQLSTATE= 07006 및 "제한된 데이터 형식 특성을 위반했습니다"라는 메시지가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-160">The error will have SQLSTATE= 07006 and the message "Restricted data type attribute violation".</span></span>  
  
 <span data-ttu-id="ba210-161">테이블 반환 매개 변수 열은 행 단위 또는 열 단위 바인딩을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-161">Table-valued parameter columns can use either row-wise or column-wise binding.</span></span> <span data-ttu-id="ba210-162">기본값은 열 단위 바인딩입니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-162">The default is column-wise binding.</span></span> <span data-ttu-id="ba210-163">행 단위 바인딩은 SQL_ATTR_PARAM_BIND_TYPE 및 SQL_ATTR_ PARAM_BIND_OFFSET_PTR을 설정하여 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-163">Row-wise binding can be specified by setting SQL_ATTR_PARAM_BIND_TYPE and SQL_ATTR_ PARAM_BIND_OFFSET_PTR.</span></span> <span data-ttu-id="ba210-164">이는 열과 매개 변수의 행 단위 바인딩과 유사합니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-164">This is analogous to row-wise binding of columns and parameters.</span></span>  
  
 <span data-ttu-id="ba210-165">SQL_CA_SS_TYPE_CATALOG_NAME 및 SQL_CA_SS_TYPE_SCHEMA_NAME을 함께 사용하여 CLR 사용자 정의 형식 매개 변수와 연결된 카탈로그와 스키마를 검색할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-165">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="ba210-166">이러한 유형에 대한 기존의 유형별 카탈로그 스키마 특성 대신 이 카탈로그와 스키마를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="ba210-166">These are alternatives to the existing type specific catalog schema attributes for these types.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ba210-167">참고 항목</span><span class="sxs-lookup"><span data-stu-id="ba210-167">See Also</span></span>  
 [<span data-ttu-id="ba210-168">ODBC&#41;&#40;테이블 반환 매개 변수</span><span class="sxs-lookup"><span data-stu-id="ba210-168">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
