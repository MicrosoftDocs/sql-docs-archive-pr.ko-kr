---
title: ODBC 테이블 반환 매개 변수 사용 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (ODBC), scenarios
- ODBC, table-valued parameters
ms.assetid: f1b73932-4570-4a8a-baa0-0f229d9c32ee
author: rothja
ms.author: jroth
ms.openlocfilehash: 2b128246f7c4ed9a9cec5e28698c743877f9873d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87740887"
---
# <a name="uses-of-odbc-table-valued-parameters"></a><span data-ttu-id="dbba2-102">ODBC 테이블 반환 매개 변수 사용</span><span class="sxs-lookup"><span data-stu-id="dbba2-102">Uses of ODBC Table-Valued Parameters</span></span>
  <span data-ttu-id="dbba2-103">이 항목에서는 ODBC에서 테이블 반환 매개 변수를 사용하는 기본 사용자 시나리오를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-103">This topic discusses the primary user scenarios for using table-valued parameters with ODBC:</span></span>  
  
-   <span data-ttu-id="dbba2-104">완전히 바인딩된 여러 행 버퍼를 사용하는 테이블 반환 매개 변수(모든 값을 메모리에 로드하여 TVP로 데이터 전송)</span><span class="sxs-lookup"><span data-stu-id="dbba2-104">Table-Valued Parameter with Fully Bound Multirow Buffers (Send Data as a TVP with All Values in Memory)</span></span>  
  
-   <span data-ttu-id="dbba2-105">행 스트리밍을 사용하는 테이블 반환 매개 변수(실행 시 데이터를 사용하여 TVP로 데이터 전송)</span><span class="sxs-lookup"><span data-stu-id="dbba2-105">Table-Valued Parameter with Row Streaming (Send Data as a TVP Using Data-At-Execution)</span></span>  
  
-   <span data-ttu-id="dbba2-106">시스템 카탈로그에서 테이블 반환 매개 변수 메타데이터 검색</span><span class="sxs-lookup"><span data-stu-id="dbba2-106">Retrieving Table-Valued Parameter Metadata from the System Catalog</span></span>  
  
-   <span data-ttu-id="dbba2-107">준비된 문에서 테이블 반환 매개 변수 메타데이터 검색</span><span class="sxs-lookup"><span data-stu-id="dbba2-107">Retrieving Table-Valued Parameter Metadata for a Prepared Statement</span></span>  
  
## <a name="table-valued-parameter-with-fully-bound-multirow-buffers-send-data-as-a-tvp-with-all-values-in-memory"></a><span data-ttu-id="dbba2-108">완전히 바인딩된 여러 행 버퍼를 사용하는 테이블 반환 매개 변수(모든 값을 메모리에 로드하여 TVP로 데이터 전송)</span><span class="sxs-lookup"><span data-stu-id="dbba2-108">Table-Valued Parameter with Fully Bound Multirow Buffers (Send Data as a TVP with All Values in Memory)</span></span>  
 <span data-ttu-id="dbba2-109">완전히 바인딩된 여러 행 버퍼와 함께 사용하는 경우 모든 매개 변수 값을 메모리에서 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-109">When used with fully bound multirow buffers, all parameter values are available in memory.</span></span> <span data-ttu-id="dbba2-110">이는 테이블 반환 매개 변수를 단일 저장 프로시저로 패키지할 수 있는 OLTP 트랜잭션의 대표적인 예입니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-110">This is typical, for example, of an OLTP transaction, in which table-valued parameters can be packaged into a single stored procedure.</span></span> <span data-ttu-id="dbba2-111">테이블 반환 매개 변수가 없다면 복잡한 다중 문 일괄 처리를 동적으로 생성하거나 서버를 여러 번 호출해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-111">Without table-valued parameters, this would involve either generating a complex multi-statement batch dynamically, or making multiple calls to the server.</span></span>  
  
 <span data-ttu-id="dbba2-112">테이블 반환 매개 변수 자체는 다른 매개 변수와 함께 [SQLBindParameter](https://go.microsoft.com/fwlink/?LinkId=59328) 를 사용 하 여 바인딩됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-112">The table-valued parameter itself is bound by using [SQLBindParameter](https://go.microsoft.com/fwlink/?LinkId=59328) along with the other parameters.</span></span> <span data-ttu-id="dbba2-113">모든 매개 변수가 바인딩된 후 응용 프로그램은 각 테이블 반환 매개 변수에 SQL_SOPT_SS_PARAM_FOCUS 매개 변수 포커스 특성을 설정 하 고 테이블 반환 매개 변수의 열에 대해 SQLBindParameter를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-113">After all parameters have been bound, the application sets the parameter focus attribute, SQL_SOPT_SS_PARAM_FOCUS, on each table-valued parameter and calls SQLBindParameter for the columns of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="dbba2-114">테이블 반환 매개 변수의 서버 유형은 새로운 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 고유 형식인 SQL_SS_TABLE입니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-114">The server type for a table-valued parameter is a new [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]-specific type, SQL_SS_TABLE.</span></span> <span data-ttu-id="dbba2-115">SQL_SS_TABLE의 바인딩 C 형식은 항상 SQL_C_DEFAULT여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-115">The binding C type for SQL_SS_TABLE must always be SQL_C_DEFAULT.</span></span> <span data-ttu-id="dbba2-116">테이블 반환 매개 변수 바인딩 매개 변수에 대해서는 데이터가 전송되지 않습니다. 이 매개 변수는 테이블 메타데이터를 전달하고, 테이블 반환 매개 변수 구성 열의 데이터 전달 방법을 제어하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-116">No data is transferred for the table-valued parameter bound parameter; it is used to pass table metadata and to control how to pass data in the constituent columns of the table-valued parameter.</span></span>  
  
 <span data-ttu-id="dbba2-117">테이블 반환 매개 변수의 길이는 서버로 전송되는 행 수로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-117">The length of the table-valued parameter is set to the number of rows being sent to the server.</span></span> <span data-ttu-id="dbba2-118">테이블 반환 매개 변수에 대 한 SQLBindParameter의 *Columnsize* 매개 변수는 전송할 수 있는 최대 행 수를 지정 합니다. 열 버퍼의 배열 크기입니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-118">The *ColumnSize* parameter of SQLBindParameter for a table-valued parameter specifies the maximum number of rows that can be sent; this is the array size of the column buffers.</span></span> <span data-ttu-id="dbba2-119">*Parametervalueptr* 은 SQLBindParameter의 테이블 반환 매개 변수에 대 한 매개 변수 버퍼입니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-119">*ParameterValuePtr* is the parameter buffer,for a table-valued parameter in SQLBindParameter.</span></span> <span data-ttu-id="dbba2-120">*Parametervalueptr* 및 관련 *bufferlength* 는 필요할 때 테이블 반환 매개 변수의 형식 이름을 전달 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-120">*ParameterValuePtr* and its associated *BufferLength* are used to pass the type name of the table-valued parameter when required.</span></span> <span data-ttu-id="dbba2-121">형식 이름은 저장 프로시저 호출에는 필요하지 않지만 SQL 문에는 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-121">The type name is not required for stored procedure calls, but it is required for SQL statements.</span></span>  
  
 <span data-ttu-id="dbba2-122">SQLBindParameter에 대 한 호출에 테이블 반환 매개 변수 형식 이름을 지정 하는 경우 ANSI 응용 프로그램으로 빌드된 응용 프로그램 에서도 항상 유니코드 값으로 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-122">When a table-valued parameter type name is specified on a call to SQLBindParameter, it must always be specified as a Unicode value, even in applications that are built as ANSI applications.</span></span> <span data-ttu-id="dbba2-123">SQLSetDescField를 사용 하 여 테이블 반환 매개 변수 형식 이름을 지정 하는 경우 응용 프로그램을 빌드하는 방법에 맞는 리터럴을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-123">When you specify a table-valued parameter type name by using SQLSetDescField, you can use a literal that conforms to the way the application is built.</span></span> <span data-ttu-id="dbba2-124">ODBC 드라이버 관리자에서 필요한 모든 유니코드 변환을 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-124">The ODBC Driver Manager will perform any required Unicode conversion.</span></span>  
  
 <span data-ttu-id="dbba2-125">테이블 반환 매개 변수 및 테이블 반환 매개 변수 열에 대 한 메타 데이터는 SQLGetDescRec, SQLSetDescRec, SQLGetDescField 및 SQLSetDescField를 사용 하 여 개별적으로 또는 명시적으로 조작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-125">Metadata for table-valued parameters and table-valued parameter columns can be manipulated individually and explicitly by using SQLGetDescRec, SQLSetDescRec, SQLGetDescField, and SQLSetDescField.</span></span> <span data-ttu-id="dbba2-126">그러나 일반적으로 SQLBindParameter를 오버 로드 하는 것이 더 편리 하며 대부분의 경우 명시적 설명자 액세스가 필요 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-126">However, overloading SQLBindParameter is usually more convenient and does not require explicit descriptor access in most cases.</span></span> <span data-ttu-id="dbba2-127">이 방법은 다른 데이터 형식에 대 한 SQLBindParameter의 정의와 일치 합니다. 단, 테이블 반환 매개 변수의 경우 영향을 받는 설명자 필드가 약간 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-127">This approach is consistent with the definition of SQLBindParameter for other data types, except that for a table-valued parameter the affected descriptor fields are slightly different.</span></span>  
  
 <span data-ttu-id="dbba2-128">애플리케이션에서 동적 SQL에 테이블 반환 매개 변수가 사용되어 테이블 반환 매개 변수의 형식 이름을 반드시 제공해야 하는 경우도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-128">Sometimes, an application uses a table-valued parameter with dynamic SQL and the type name of the table-valued parameter must be supplied.</span></span> <span data-ttu-id="dbba2-129">이 경우 연결에 대 한 현재 기본 스키마에 테이블 반환 매개 변수가 정의 되어 있지 않으면 SQLSetDescField를 사용 하 여 SQL_CA_SS_TYPE_CATALOG_NAME 및 SQL_CA_SS_TYPE_SCHEMA_NAME를 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-129">If this is the case and the table-valued parameter is not defined in the current default schema for the connection, SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME must be set by using SQLSetDescField.</span></span> <span data-ttu-id="dbba2-130">테이블 형식 정의와 테이블 반환 매개 변수는 동일한 데이터베이스에 있어야 하므로 애플리케이션에서 테이블 반환 매개 변수를 사용하는 경우 SQL_CA_SS_TYPE_CATALOG_NAME을 설정해서는 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-130">Because table type definitions and table-valued parameters must be in the same database, SQL_CA_SS_TYPE_CATALOG_NAME must not be set if the application uses table-valued parameters.</span></span> <span data-ttu-id="dbba2-131">그렇지 않으면 SQLSetDescField는 오류를 보고 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-131">Otherwise, SQLSetDescField will report an error.</span></span>  
  
 <span data-ttu-id="dbba2-132">이 시나리오에 대 한 샘플 코드는 `demo_fixed_TVP_binding` [ODBC&#41;&#40;테이블 반환 매개 변수 사용 ](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md)의 절차에 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-132">Sample code for this scenario is in the procedure `demo_fixed_TVP_binding` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="table-valued-parameter-with-row-streaming-send-data-as-a-tvp-using-data-at-execution"></a><span data-ttu-id="dbba2-133">행 스트리밍을 사용하는 테이블 반환 매개 변수(실행 시 데이터를 사용하여 TVP로 데이터 전송)</span><span class="sxs-lookup"><span data-stu-id="dbba2-133">Table-Valued Parameter with Row Streaming (Send Data as a TVP Using Data-At-Execution)</span></span>  
 <span data-ttu-id="dbba2-134">이 시나리오에서 애플리케이션은 드라이버가 요청하면 행을 제공하며 제공된 행은 서버로 스트리밍됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-134">In this scenario, the application supplies rows to the driver as it requests them and they are streamed to the server.</span></span> <span data-ttu-id="dbba2-135">따라서 모든 행을 메모리에 버퍼링할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-135">This avoids having to buffer all rows in memory.</span></span> <span data-ttu-id="dbba2-136">이는 대량 삽입/업데이트 시나리오를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-136">This is representative of bulk insert/update scenarios.</span></span> <span data-ttu-id="dbba2-137">테이블 반환 매개 변수는 매개 변수 배열과 대량 복사의 중간 정도 수준에 해당하는 성능을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-137">Table-valued parameters provide a performance point somewhere between parameter arrays and bulk copy.</span></span> <span data-ttu-id="dbba2-138">즉, 테이블 반환 매개 변수는 매개 변수 배열만큼 프로그래밍하기 쉬우면서도 서버에서 더 뛰어난 융통성을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-138">That is, table-valued parameters are about as easy to program as parameter arrays, but they provide greater flexibility at the server.</span></span>  
  
 <span data-ttu-id="dbba2-139">테이블 반환 매개 변수와 해당 열은 완전히 바인딩된 여러 행 버퍼를 사용하는 테이블 반환 매개 변수 섹션에서 설명한 대로 바인딩되지만 테이블 반환 매개 변수 자체의 길이 표시기는 SQL_DATA_AT_EXEC로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-139">The table-valued parameter and its columns are bound as discussed in the previous section, Table-Valued Parameter with Fully Bound Multirow Buffers, but the length indicator of the table-valued parameter itself is set to SQL_DATA_AT_EXEC.</span></span> <span data-ttu-id="dbba2-140">이 드라이버는 실행 시 데이터 매개 변수에 대해 일반적인 방법으로 (즉, SQL_NEED_DATA 반환) SQLExecute 또는 SQLExecuteDirect에 응답 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-140">The driver responds to SQLExecute or SQLExecuteDirect in the usual way for data-at-execution parameters-that is, by returning SQL_NEED_DATA.</span></span> <span data-ttu-id="dbba2-141">드라이버가 테이블 반환 매개 변수에 대 한 데이터를 받아들일 준비가 되 면 SQLParamData는 SQLBindParameter에서 *Parametervalueptr* 의 값을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-141">When the driver is ready to accept data for a table-valued parameter, SQLParamData returns the value of *ParameterValuePtr* in SQLBindParameter.</span></span>  
  
 <span data-ttu-id="dbba2-142">응용 프로그램은 테이블 반환 매개 변수에 대해 SQLPutData를 사용 하 여 테이블 반환 매개 변수 구성 열의 데이터를 사용할 수 있는지 여부를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-142">An application uses SQLPutData for a table-valued parameter to indicate the availability of data for table-valued parameter constituent columns.</span></span> <span data-ttu-id="dbba2-143">테이블 반환 매개 변수에 대해 SQLPutData를 호출 하는 경우 *Dataptr* 은 항상 null 이어야 하 고 *StrLen_or_Ind* 는 0 이거나 테이블 반환 매개 변수 버퍼에 지정 된 배열 크기 (SQLBindParameter의 *columnsize* 매개 변수) 보다 작거나 같은 숫자 여야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-143">When SQLPutData is called for a table-valued parameter, *DataPtr* must always be null and *StrLen_or_Ind* must be either 0 or a number less than or equal to the array size specified for table-valued parameter buffers (the *ColumnSize* parameter of SQLBindParameter).</span></span> <span data-ttu-id="dbba2-144">0은 테이블 반환 매개 변수에 대한 행이 더 이상 없어 드라이버가 다음 실제 프로시저 매개 변수를 처리하게 됨을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-144">0 signifies that there are no more rows for the table-valued parameter, and the driver will proceed to process to the next actual procedure parameter.</span></span> <span data-ttu-id="dbba2-145">*StrLen_or_Ind* 가 0이 아닌 경우 드라이버는 테이블 반환 매개 변수 구성 열을 테이블 반환 매개 변수를 바인딩되지 않은 매개 변수와 같은 방식으로 처리 합니다. 각 테이블 반환 매개 변수 열은 실제 데이터 길이 SQL_NULL_DATA를 지정 하거나 길이/표시기 버퍼를 통해 실행 시 데이터를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-145">When *StrLen_or_Ind* is not 0, the driver will process the table-valued parameter constituent columns in the same way as non-table-valued parameter bound parameters: Each table-valued parameter column can specify its actual data length, SQL_NULL_DATA, or it can specify data at execution via its length/indicator buffer.</span></span> <span data-ttu-id="dbba2-146">문자 또는 이진 값을 조각으로 전달 하는 경우 일반적으로 SQLPutData에 대 한 반복적인 호출로 테이블 반환 매개 변수 열 값을 전달할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-146">Table-valued parameter column values can be passed by repeated calls to SQLPutData as usual when a character or binary value is to be passed in pieces.</span></span>  
  
 <span data-ttu-id="dbba2-147">테이블 반환 매개 변수 열이 모두 처리되면 드라이버가 다시 테이블 반환 매개 변수로 돌아와서 테이블 반환 매개 변수 데이터의 행을 추가로 처리하기 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-147">When all table-valued parameter columns have been processed, the driver returns to the table-valued parameter to process further rows of table-valued parameter data.</span></span> <span data-ttu-id="dbba2-148">따라서 실행 시 데이터 테이블 반환 매개 변수의 경우 드라이버가 바인딩된 매개 변수를 순차적으로 검색하는 일반적인 방식을 따르지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-148">Therefore, for data-at-execution table-valued parameters, the driver does not follow the usual sequential scan of bound parameters.</span></span> <span data-ttu-id="dbba2-149">바인딩된 테이블 반환 매개 변수는 SQLPutData가 0과 같은 *StrLen_Or_IndPtr* 를 사용 하 여 호출 될 때까지 폴링됩니다 .이 경우 드라이버가 테이블 반환 매개 변수 열을 건너뛰고 다음 실제 저장 프로시저 매개 변수로 이동 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-149">A bound table-valued parameter will be polled until SQLPutData is called with *StrLen_Or_IndPtr* equal to 0, at which time the driver skips table-valued parameter columns and moves to the next actual stored procedure parameter.</span></span>  <span data-ttu-id="dbba2-150">SQLPutData가 1 보다 크거나 같은 표시기 값을 전달 하는 경우 드라이버는 모든 바인딩된 행과 열에 대 한 값이 있을 때까지 테이블 반환 매개 변수 열 및 행을 순차적으로 처리 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-150">When SQLPutData passes an indicator value greater than or equal to 1, the driver processes table-valued parameter columns and rows sequentially until it has values for all bound rows and columns.</span></span> <span data-ttu-id="dbba2-151">그런 다음 드라이버는 테이블 반환 매개 변수로 돌아갑니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-151">Then the driver returns to the table-valued parameter.</span></span> <span data-ttu-id="dbba2-152">SQLParamData에서 테이블 반환 매개 변수에 대 한 토큰을 받고 테이블 반환 매개 변수에 대해 Sqlparamdata (hstmt, NULL, n)를 호출 하는 동안 응용 프로그램은 서버에 전달할 다음 행에 대 한 테이블 반환 매개 변수 구성 열 데이터와 표시기 버퍼 내용을 설정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-152">Between receiving the token for the table-valued parameter from SQLParamData and calling SQLPutData(hstmt, NULL, n) for a table-valued parameter, the application must set table-valued parameter constituent column data and indicator buffer contents for the next row or rows to be passed to the server.</span></span>  
  
 <span data-ttu-id="dbba2-153">이 시나리오에 대 한 샘플 코드는 `demo_variable_TVP_binding` [ODBC&#41;&#40;테이블 반환 매개 변수 사용 ](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md)의 루틴에 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-153">Sample code for this scenario is in the routine `demo_variable_TVP_binding` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="retrieving-table-valued-parameter-metadata-from-the-system-catalog"></a><span data-ttu-id="dbba2-154">시스템 카탈로그에서 테이블 반환 매개 변수 메타데이터 검색</span><span class="sxs-lookup"><span data-stu-id="dbba2-154">Retrieving Table-Valued Parameter Metadata from the System Catalog</span></span>  
 <span data-ttu-id="dbba2-155">응용 프로그램에서 테이블 반환 매개 변수 매개 변수를 포함 하는 프로시저에 대해 SQLProcedureColumns를 호출 하면 DATA_TYPE SQL_SS_TABLE으로 반환 되 고 TYPE_NAME은 테이블 반환 매개 변수에 대 한 테이블 형식의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-155">When an application calls SQLProcedureColumns for a procedure that has table-valued parameter parameters, DATA_TYPE is returned as SQL_SS_TABLE and TYPE_NAME is the name of the table type for the table-valued parameter.</span></span> <span data-ttu-id="dbba2-156">SQLProcedureColumns에서 반환 하는 결과 집합에 두 개의 추가 열이 추가 됩니다. SS_TYPE_CATALOG_NAME은 테이블-값 매개 변수의 테이블 형식이 정의 된 카탈로그의 이름을 반환 하 고 SS_TYPE_SCHEMA_NAME는 테이블 반환 매개 변수의 테이블 형식이 정의 된 스키마의 이름을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-156">Two additional columns are added to the result set returned by SQLProcedureColumns: SS_TYPE_CATALOG_NAME returns the name of the catalog where the table type of the table-value parameter is defined, and SS_TYPE_SCHEMA_NAME returns the name of the schema where the where the table type of the table-value parameter is defined.</span></span> <span data-ttu-id="dbba2-157">ODBC 사양에 따라 SS_TYPE_CATALOG_NAME 및 SS_TYPE_SCHEMA_NAME은 이전 버전의 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]에 추가된 모든 드라이버 관련 열 앞에, 그리고 ODBC 자체에서 위임한 모든 열 뒤에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-157">In conformance with the ODBC specification, SS_TYPE_CATALOG_NAME and SS_TYPE_SCHEMA_NAME appear before all driver specific columns that were added in previous versions of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], and after all columns mandated by ODBC itself.</span></span>  
  
 <span data-ttu-id="dbba2-158">새 열은 테이블 반환 매개 변수뿐만 아니라 CLR 사용자 정의 형식 매개 변수에 대해서도 채워집니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-158">The new columns will be populated not only for table-valued parameters, but also for CLR user-defined type parameters.</span></span> <span data-ttu-id="dbba2-159">UDT 매개 변수의 기존 스키마와 카탈로그 열도 채워지지만 스키마와 카탈로그 열이 필요한 데이터 형식에 공용 스키마 및 카탈로그 열을 사용함으로써 이후 애플리케이션 개발 과정이 간단해집니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-159">The existing schema and catalog columns of UDT parameters will still be populated, but having common schema and catalog columns for data types that require them will simplify application development in the future.</span></span> <span data-ttu-id="dbba2-160">XML 스키마 컬렉션은 다소 다르며 이 변경 사항이 적용되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-160">(Note that XML schema collections are somewhat different and are not included in this change.)</span></span>  
  
 <span data-ttu-id="dbba2-161">응용 프로그램은 SQLTables를 사용 하 여 영구 테이블, 시스템 테이블 및 뷰와 동일한 방식으로 테이블 형식의 이름을 확인 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-161">An application uses SQLTables to determine the names of table types the same way it does for persistent tables, system tables, and views.</span></span> <span data-ttu-id="dbba2-162">애플리케이션에서 테이블 반환 매개 변수와 연결된 테이블 형식을 식별할 수 있도록 TABLE TYPE이라는 새로운 테이블 형식이 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-162">A new table type, TABLE TYPE, is introduced to enable an application to identify table types associated with table-valued parameters.</span></span> <span data-ttu-id="dbba2-163">테이블 형식과 일반 테이블은 서로 다른 네임스페이스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-163">Table types and regular tables use different namespaces.</span></span> <span data-ttu-id="dbba2-164">즉, 테이블 형식과 실제 테이블에 동일한 이름을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-164">This means that you can use the same name for both a table type and an actual table.</span></span> <span data-ttu-id="dbba2-165">이를 처리하기 위해 SQL_SOPT_SS_NAME_SCOPE라는 새로운 문 특성이 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-165">To handle this, a new statement attribute, SQL_SOPT_SS_NAME_SCOPE, has been introduced.</span></span> <span data-ttu-id="dbba2-166">이 특성은 테이블 이름을 매개 변수로 사용 하는 SQLTables 및 기타 카탈로그 함수가 테이블 이름을 실제 테이블의 이름 또는 테이블 형식의 이름으로 해석 해야 하는지 여부를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-166">This attribute specifies whether SQLTables and other catalog functions that take a table name as a parameter should interpret the table name as the name of an actual table or the name of a table type.</span></span>  
  
 <span data-ttu-id="dbba2-167">응용 프로그램에서는 SQLColumns를 사용 하 여 영구 테이블에 대해 수행 되는 것과 같은 방식으로 테이블 형식에 대 한 열을 확인 하지만, 먼저 SQL_SOPT_SS_NAME_SCOPE를 설정 하 여 실제 테이블이 아닌 테이블 형식으로 작업 하 고 있음을 나타내야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-167">An application uses SQLColumns to determine the columns for a table type in the same way it does for persistent tables, but must first set SQL_SOPT_SS_NAME_SCOPE to indicate that it is working with table types rather than actual tables.</span></span> <span data-ttu-id="dbba2-168">SQLPrimaryKeys를 테이블 형식과 함께 사용 하 여 SQL_SOPT_SS_NAME_SCOPE을 다시 사용할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-168">SQLPrimaryKeys can also be used with table types, again using SQL_SOPT_SS_NAME_SCOPE.</span></span>  
  
 <span data-ttu-id="dbba2-169">이 시나리오에 대 한 샘플 코드는 `demo_metadata_from_catalog_APIs` [ODBC&#41;&#40;테이블 반환 매개 변수 사용 ](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md)의 루틴에 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-169">Sample code for this scenario is in the routine `demo_metadata_from_catalog_APIs` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="retrieving-table-valued-parameter-metadata-for-a-prepared-statement"></a><span data-ttu-id="dbba2-170">준비된 문에서 테이블 반환 매개 변수 메타데이터 검색</span><span class="sxs-lookup"><span data-stu-id="dbba2-170">Retrieving Table-Valued Parameter Metadata for a Prepared Statement</span></span>  
 <span data-ttu-id="dbba2-171">이 시나리오에서 응용 프로그램은 SQLNumParameters 및 SQLDescribeParam를 사용 하 여 테이블 반환 매개 변수의 메타 데이터를 검색 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-171">In this scenario, an application uses SQLNumParameters and SQLDescribeParam to retrieve metadata for table-valued parameters.</span></span>  
  
 <span data-ttu-id="dbba2-172">테이블 반환 매개 변수의 형식 이름을 검색하는 데는 SQL_CA_SS_TYPE_NAME이라는 IPD 필드가 사용되고,</span><span class="sxs-lookup"><span data-stu-id="dbba2-172">The IPD field SQL_CA_SS_TYPE_NAME is used to retrieve the type name for the table-valued parameter.</span></span> <span data-ttu-id="dbba2-173">스키마와 카탈로그를 검색하는 데는 각각 SQL_CA_SS_TYPE_SCHEMA_NAME과 SQL_CA_SS_TYPE_CATALOG_NAME이라는 IPD 필드가 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-173">The IPD fields SQL_CA_SS_TYPE_SCHEMA_NAME and SQL_CA_SS_TYPE_CATALOG_NAME are used to retrieve its catalog and schema, respectively.</span></span>  
  
 <span data-ttu-id="dbba2-174">테이블 형식 정의와 테이블 반환 매개 변수는 동일한 데이터베이스에 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-174">Table type definitions and table-valued parameters must be in the same database.</span></span> <span data-ttu-id="dbba2-175">SQLSetDescField는 응용 프로그램이 테이블 반환 매개 변수를 사용할 때 SQL_CA_SS_TYPE_CATALOG_NAME를 설정 하는 경우 오류를 보고 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-175">SQLSetDescField will report an error if an application sets SQL_CA_SS_TYPE_CATALOG_NAME when using table-valued parameters.</span></span>  
  
 <span data-ttu-id="dbba2-176">SQL_CA_SS_TYPE_CATALOG_NAME 및 SQL_CA_SS_TYPE_SCHEMA_NAME을 함께 사용하여 CLR 사용자 정의 형식 매개 변수와 연결된 카탈로그와 스키마를 검색할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-176">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME can also be used to retrieve the catalog and schema associated with CLR user-defined type parameters.</span></span> <span data-ttu-id="dbba2-177">SQL_CA_SS_TYPE_CATALOG_NAME 및 SQL_CA_SS_TYPE_SCHEMA_NAME은 CLR UDT 형식에 대한 기존 형식 관련 카탈로그 스키마 특성을 대체합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-177">SQL_CA_SS_TYPE_CATALOG_NAME and SQL_CA_SS_TYPE_SCHEMA_NAME are alternatives to the existing type specific catalog schema attributes for CLR UDT types.</span></span>  
  
 <span data-ttu-id="dbba2-178">SQLDescribeParam가 테이블 반환 매개 변수 열 열에 대 한 메타 데이터를 반환 하지 않기 때문에 응용 프로그램은이 시나리오에서 테이블 반환 매개 변수에 대 한 열 메타 데이터를 검색 하는 데 SQLColumns를 사용 합니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-178">An application uses SQLColumns to retrieve column metadata for a table-valued parameter in this scenario, too, because SQLDescribeParam does not return metadata for the columns of a table-valued parameter column.</span></span>  
  
 <span data-ttu-id="dbba2-179">이 사용 사례에 대 한 샘플 코드는 `demo_metadata_from_prepared_statement` [ODBC&#41;&#40;테이블 반환 매개 변수 사용 ](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md)의 루틴에 나와 있습니다.</span><span class="sxs-lookup"><span data-stu-id="dbba2-179">Sample code for this use case is in the routine `demo_metadata_from_prepared_statement` in [Use Table-Valued Parameters &#40;ODBC&#41;](../native-client-odbc-how-to/use-table-valued-parameters-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dbba2-180">참고 항목</span><span class="sxs-lookup"><span data-stu-id="dbba2-180">See Also</span></span>  
 [<span data-ttu-id="dbba2-181">ODBC&#41;&#40;테이블 반환 매개 변수</span><span class="sxs-lookup"><span data-stu-id="dbba2-181">Table-Valued Parameters &#40;ODBC&#41;</span></span>](table-valued-parameters-odbc.md)  
  
  
