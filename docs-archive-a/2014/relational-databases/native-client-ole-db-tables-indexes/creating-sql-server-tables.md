---
title: SQL Server 테이블 만들기 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- tables [OLE DB]
- SQL Server Native Client OLE DB provider, tables
- DBCOLUMNDESC usage
- adding tables
- CreateTable function
ms.assetid: a7b8d142-d76a-44d9-a583-86ac5109fbe8
author: rothja
ms.author: jroth
ms.openlocfilehash: 7b3d11a26c2f5d27f28a60effdb26978edd07409
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87652088"
---
# <a name="creating-sql-server-tables"></a><span data-ttu-id="534cf-102">SQL Server 테이블 만들기</span><span class="sxs-lookup"><span data-stu-id="534cf-102">Creating SQL Server Tables</span></span>
  <span data-ttu-id="534cf-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 **Itabledefinition:: CreateTable** 함수를 제공 하 여 소비자가 테이블을 만들 수 있도록 합니다 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="534cf-103">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider exposes the **ITableDefinition::CreateTable** function, allowing consumers to create [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] tables.</span></span> <span data-ttu-id="534cf-104">소비자는 **CreateTable** 을 사용 하 여 소비자 이름 영구 테이블을 만들고 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 생성 한 고유한 이름을 가진 영구 또는 임시 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-104">Consumers use **CreateTable** to create consumer-named permanent tables, and permanent or temporary tables with unique names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span>  
  
 <span data-ttu-id="534cf-105">소비자가 **Itabledefinition:: CreateTable**를 호출 하는 경우 DBPROP_TBL_TEMPTABLE 속성 값이 VARIANT_TRUE 되는 경우 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 소비자에 대 한 임시 테이블 이름을 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-105">When the consumer calls **ITableDefinition::CreateTable**, if the value of the DBPROP_TBL_TEMPTABLE property is VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="534cf-106">소비자는 **CreateTable** 메서드의 *pTableID* 매개 변수를 NULL로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-106">The consumer sets the *pTableID* parameter of the **CreateTable** method to NULL.</span></span> <span data-ttu-id="534cf-107">Native Client OLE DB 공급자에 의해 생성 된 이름을 가진 임시 테이블은 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **테이블** 행 집합에 표시 되지 않지만 **iopenrowset** 인터페이스를 통해 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-107">The temporary tables with names generated by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider do not appear in the **TABLES** rowset, but are accessible through the **IOpenRowset** interface.</span></span>  
  
 <span data-ttu-id="534cf-108">소비자가 *pTableID* 매개 변수에서 *uName* 공용 구조체의 *pwszName* 멤버에 테이블 이름을 지정 하는 경우 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 해당 이름의 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-108">When consumers specify the table name in the *pwszName* member of the *uName* union in the *pTableID* parameter, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table with that name.</span></span> <span data-ttu-id="534cf-109">이때 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 테이블 명명 제약 조건이 적용되며 테이블 이름은 영구 테이블이나 로컬 또는 전역 임시 테이블을 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-109">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table naming constraints apply, and the table name can indicate a permanent table, or either a local or global temporary table.</span></span> <span data-ttu-id="534cf-110">자세한 내용은 [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="534cf-110">For more information, see [CREATE TABLE](/sql/t-sql/statements/create-table-transact-sql).</span></span> <span data-ttu-id="534cf-111">*ppTableID* 매개 변수는 NULL일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-111">The *ppTableID* parameter can be NULL.</span></span>  
  
 <span data-ttu-id="534cf-112">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 영구 또는 임시 테이블의 이름을 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-112">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider can generate the names of permanent or temporary tables.</span></span> <span data-ttu-id="534cf-113">소비자가 *pTableID* 매개 변수를 NULL로 설정 하 고 *ppTableID* 를 설정 하 여 유효한 dbid를 가리키도록 하면 \* [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 *ppTableID*값이 가리키는 DBID의 *uName* 공용 구조체의 *pwszName* 멤버에 생성 된 테이블 이름을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-113">When the consumer sets the *pTableID* parameter to NULL and sets *ppTableID* to point to a valid DBID\*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns the generated name of the table in the *pwszName* member of the *uName* union of the DBID pointed to by the value of *ppTableID*.</span></span> <span data-ttu-id="534cf-114">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] *RgPropertySets* 매개 변수에서 참조 하는 테이블 속성 집합에 DBPROP_TBL_TEMPTABLE OLE DB 테이블 속성을 포함 하는 임시 Native Client OLE DB 공급자 이름 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-114">To create a temporary, [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider-named table, the consumer includes the OLE DB table property DBPROP_TBL_TEMPTABLE in a table property set referenced in the *rgPropertySets* parameter.</span></span> [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]<span data-ttu-id="534cf-115">Native Client OLE DB 공급자 이름 임시 테이블은 로컬입니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-115">Native Client OLE DB provider-named temporary tables are local.</span></span>  
  
 <span data-ttu-id="534cf-116">*pTableID* 매개 변수의 *eKind* 멤버가 DBKIND_NAME을 나타내지 않으면 **CreateTable**이 DB_E_BADTABLEID를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-116">**CreateTable** returns DB_E_BADTABLEID if the *eKind* member of the *pTableID* parameter does not indicate DBKIND_NAME.</span></span>  
  
## <a name="dbcolumndesc-usage"></a><span data-ttu-id="534cf-117">DBCOLUMNDESC 사용</span><span class="sxs-lookup"><span data-stu-id="534cf-117">DBCOLUMNDESC Usage</span></span>  
 <span data-ttu-id="534cf-118">소비자는 *pwszTypeName* 멤버나 *wType* 멤버를 사용하여 열 데이터 형식을 나타낼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-118">The consumer can indicate a column data type by using either the *pwszTypeName* member or the *wType* member.</span></span> <span data-ttu-id="534cf-119">소비자가 *pwszTypeName*에서 데이터 형식을 지정 하는 경우 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 *wtype*의 값을 무시 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-119">If the consumer specifies the data type in *pwszTypeName*, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider ignores the value of *wType*.</span></span>  
  
 <span data-ttu-id="534cf-120">*pwszTypeName* 멤버를 사용하는 경우 소비자는 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 데이터 형식 이름을 사용하여 데이터 형식을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-120">If using the *pwszTypeName* member, the consumer specifies the data type by using [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type names.</span></span> <span data-ttu-id="534cf-121">올바른 데이터 형식 이름은 PROVIDER_TYPES 스키마 행 집합의 TYPE_NAME 열에 반환되는 값입니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-121">Valid data type names are those returned in the TYPE_NAME column of the PROVIDER_TYPES schema rowset.</span></span>  
  
 <span data-ttu-id="534cf-122">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 *wtype* 멤버에서 OLE DB 열거 DBTYPE 값의 하위 집합을 인식 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-122">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider recognizes a subset of OLE DB-enumerated DBTYPE values in the *wType* member.</span></span> <span data-ttu-id="534cf-123">자세한 내용은 [ITableDefinition의 데이터 형식 매핑](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="534cf-123">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="534cf-124">소비자가 *pTypeInfo* 또는 *pclsid* 멤버를 설정하여 열 데이터 형식을 지정하면 **CreateTable**이 DB_E_BADTYPE을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-124">**CreateTable** returns DB_E_BADTYPE if consumer sets either the *pTypeInfo* or *pclsid* member to specify the column data type.</span></span>  
  
 <span data-ttu-id="534cf-125">소비자는 DBCOLUMNDESC *dbcid* 멤버의 *uName* 공용 구조체에 있는 *pwszName* 멤버에 열 이름을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-125">The consumer specifies the column name in the *pwszName* member of the *uName* union of the DBCOLUMNDESC *dbcid* member.</span></span> <span data-ttu-id="534cf-126">열 이름은 유니코드 문자열로 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-126">The column name is specified as a Unicode character string.</span></span> <span data-ttu-id="534cf-127">*dbcid*의 *eKind* 멤버는 DBKIND_NAME이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-127">The *eKind* member of *dbcid* must be DBKIND_NAME.</span></span> <span data-ttu-id="534cf-128">*eKind*가 올바르지 않고 *pwszName*이 NULL이거나 *pwszName* 값이 올바른 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 식별자가 아니면 **CreateTable**이 DB_E_BADCOLUMNID를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-128">**CreateTable** returns DB_E_BADCOLUMNID if *eKind* is invalid, *pwszName* is NULL, or if the value of *pwszName* is not a valid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identifier.</span></span>  
  
 <span data-ttu-id="534cf-129">모든 열 속성을 테이블에 대해 정의된 모든 열에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-129">All column properties are available on all columns defined for the table.</span></span> <span data-ttu-id="534cf-130">속성 값 설정이 충돌될 경우 **CreateTable**이 DB_S_ERRORSOCCURRED 또는 DB_E_ERRORSOCCURRED를 반환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-130">**CreateTable** can return DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED if property values are set in conflict.</span></span> <span data-ttu-id="534cf-131">잘못된 열 속성 설정으로 인해 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 테이블 생성에 실패할 경우 **CreateTable**이 오류를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-131">**CreateTable** returns an error when invalid column property settings cause [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table-creation failure.</span></span>  
  
 <span data-ttu-id="534cf-132">DBCOLUMNDESC의 열 속성이 나타내는 의미는 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-132">Column properties in a DBCOLUMNDESC are interpreted as follows.</span></span>  
  
|<span data-ttu-id="534cf-133">속성 ID</span><span class="sxs-lookup"><span data-stu-id="534cf-133">Property ID</span></span>|<span data-ttu-id="534cf-134">Description</span><span class="sxs-lookup"><span data-stu-id="534cf-134">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="534cf-135">DBPROP_COL_AUTOINCREMENT</span><span class="sxs-lookup"><span data-stu-id="534cf-135">DBPROP_COL_AUTOINCREMENT</span></span>|<span data-ttu-id="534cf-136">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-136">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-137">기본값: VARIANT_FALSE Description: 만든 열에서 identity 속성을 설정 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-137">Default: VARIANT_FALSE Description: Sets the identity property on the column created.</span></span> <span data-ttu-id="534cf-138">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]에서 ID 속성은 테이블 내의 단일 열에 대해서만 유효합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-138">For [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)], the identity property is valid for a single column within a table.</span></span> <span data-ttu-id="534cf-139">단일 열에 대 한 속성을 VARIANT_TRUE로 설정 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 서버에 테이블을 만들려고 할 때 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-139">Setting the property to VARIANT_TRUE for more than a single column generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="534cf-140">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID 속성은 소수 자릿수가 0인 **integer**, **numeric** 및 **decimal** 형식에 대해서만 유효합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-140">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property is only valid for the **integer**, **numeric**, and **decimal** types when the scale is 0.</span></span> <span data-ttu-id="534cf-141">다른 데이터 형식의 열에 대 한 속성을 VARIANT_TRUE로 설정 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 서버에 테이블을 만들려고 할 때 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-141">Setting the property to VARIANT_TRUE on a column of any other data type generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span><br /><br /> <span data-ttu-id="534cf-142">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 DBPROP_COL_AUTOINCREMENT와 DBPROP_COL_NULLABLE 모두 VARIANT_TRUE이 고 DBPROP_COL_NULLABLE의 *dwoption* 이 DBPROPOPTIONS_REQUIRED 되지 않은 경우 DB_S_ERRORSOCCURRED을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-142">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE is not DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="534cf-143">DBPROP_COL_AUTOINCREMENT 및 DBPROP_COL_NULLABLE이 모두 VARIANT_TRUE이고 DBPROP_COL_NULLABLE의 *dwOption*이 DBPROPOPTIONS_REQUIRED이면 DB_E_ERRORSOCCURRED가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-143">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_AUTOINCREMENT and DBPROP_COL_NULLABLE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_NULLABLE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="534cf-144">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID 속성을 사용하여 열이 정의되고 DBPROP_COL_NULLABLE *dwStatus* 멤버가 DBPROPSTATUS_CONFLICTING으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-144">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span>|  
|<span data-ttu-id="534cf-145">DBPROP_COL_DEFAULT</span><span class="sxs-lookup"><span data-stu-id="534cf-145">DBPROP_COL_DEFAULT</span></span>|<span data-ttu-id="534cf-146">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-146">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-147">기본값: 없음</span><span class="sxs-lookup"><span data-stu-id="534cf-147">Default: None</span></span><br /><br /> <span data-ttu-id="534cf-148">설명: 열에 대해 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT 제약 조건을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-148">Description: Creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] DEFAULT constraint for the column.</span></span><br /><br /> <span data-ttu-id="534cf-149">*vValue* DBPROP 멤버에는 개수에 관계없이 유형을 얼마든지 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-149">The *vValue* DBPROP member can be any of a number of types.</span></span> <span data-ttu-id="534cf-150">*vValue.vt* 멤버에는 열 데이터 형식과 호환되는 유형을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-150">The *vValue.vt* member should specify a type compatible with the data type of the column.</span></span> <span data-ttu-id="534cf-151">예를 들어 DBTYPE_WSTR로 정의된 열의 기본값으로 BSTR N/A를 정의하는 것은 서로 호환되므로 가능합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-151">For example, defining BSTR N/A as the default value for a column defined as DBTYPE_WSTR is a compatible match.</span></span> <span data-ttu-id="534cf-152">DBTYPE_R8으로 정의 된 열에 대해 동일한 기본값을 정의 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 서버에 테이블을 만들려고 할 때 오류가 발생 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-152">Defining the same default on a column defined as DBTYPE_R8 generates an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the table on the server.</span></span>|  
|<span data-ttu-id="534cf-153">DBPROP_COL_DESCRIPTION</span><span class="sxs-lookup"><span data-stu-id="534cf-153">DBPROP_COL_DESCRIPTION</span></span>|<span data-ttu-id="534cf-154">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-154">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-155">기본값: 없음</span><span class="sxs-lookup"><span data-stu-id="534cf-155">Default: None</span></span><br /><br /> <span data-ttu-id="534cf-156">설명: DBPROP_COL_DESCRIPTION 열 속성이 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자에 의해 구현 되지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-156">Description: The DBPROP_COL_DESCRIPTION column property is not implemented by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="534cf-157">소비자가 속성 값을 쓰려고 하면 DBPROP 구조의 *dwStatus* 멤버가 DBPROPSTATUS_NOTSUPPORTED를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-157">The *dwStatus* member of the DBPROP structure returns DBPROPSTATUS_NOTSUPPORTED when the consumer attempts to write the property value.</span></span><br /><br /> <span data-ttu-id="534cf-158">이 속성을 설정 해도 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자에 대해 심각한 오류가 발생 하지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-158">Setting the property does not constitute a fatal error for the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span> <span data-ttu-id="534cf-159">다른 매개 변수 값이 모두 올바르기만 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 테이블이 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-159">If all other parameter values are valid, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table is created.</span></span>|  
|<span data-ttu-id="534cf-160">DBPROP_COL_FIXEDLENGTH</span><span class="sxs-lookup"><span data-stu-id="534cf-160">DBPROP_COL_FIXEDLENGTH</span></span>|<span data-ttu-id="534cf-161">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-161">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-162">Default: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="534cf-162">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="534cf-163">설명: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 소비자가 DBCOLUMNDESC의 *wtype* 멤버를 사용 하 여 열의 데이터 형식을 정의 하는 경우 DBPROP_COL_FIXEDLENGTH를 사용 하 여 데이터 형식 매핑을 결정 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-163">Description: The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider uses DBPROP_COL_FIXEDLENGTH to determine data type-mapping when the consumer defines a column's data type by using the *wType* member of the DBCOLUMNDESC.</span></span> <span data-ttu-id="534cf-164">자세한 내용은 [ITableDefinition의 데이터 형식 매핑](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="534cf-164">For more information, see [Data Type Mapping in ITableDefinition](../../relational-databases/native-client-ole-db-data-types/data-type-mapping-in-itabledefinition.md).</span></span>|  
|<span data-ttu-id="534cf-165">DBPROP_COL_NULLABLE</span><span class="sxs-lookup"><span data-stu-id="534cf-165">DBPROP_COL_NULLABLE</span></span>|<span data-ttu-id="534cf-166">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-166">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-167">기본값: 없음</span><span class="sxs-lookup"><span data-stu-id="534cf-167">Default: None</span></span><br /><br /> <span data-ttu-id="534cf-168">설명: 테이블을 만들 때 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 속성이 설정 된 경우 열이 null 값을 허용 해야 하는지 여부를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-168">Description: When creating the table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider indicates whether the column should accept null values if the property is set.</span></span> <span data-ttu-id="534cf-169">해당 속성이 설정되어 있지 않으면 열의 NULL 값 허용 여부가 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS 기본 데이터베이스 옵션을 통해 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-169">When the property is not set, the ability of the column to accept NULL as a value is determined by the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ANSI_NULLS default database option.</span></span><br /><br /> <span data-ttu-id="534cf-170">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 ISO 호환 공급자입니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-170">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider is an ISO-compliant provider.</span></span> <span data-ttu-id="534cf-171">연결된 세션에서는 ISO 동작을 따르므로</span><span class="sxs-lookup"><span data-stu-id="534cf-171">Connected sessions exhibit ISO behaviors.</span></span> <span data-ttu-id="534cf-172">소비자가 DBPROP_COL_NULLABLE을 설정하지 않은 경우 열은 null 값을 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-172">If the consumer does not set DBPROP_COL_NULLABLE, columns accept null values.</span></span>|  
|<span data-ttu-id="534cf-173">DBPROP_COL_PRIMARYKEY</span><span class="sxs-lookup"><span data-stu-id="534cf-173">DBPROP_COL_PRIMARYKEY</span></span>|<span data-ttu-id="534cf-174">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-174">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-175">기본값: VARIANT_FALSE 설명: VARIANT_TRUE 때 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 PRIMARY KEY 제약 조건이 있는 열을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-175">Default: VARIANT_FALSE Description: When VARIANT_TRUE, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates the column with a PRIMARY KEY constraint.</span></span><br /><br /> <span data-ttu-id="534cf-176">열 속성으로 정의된 경우 단일 열만 이 제약 조건을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-176">When defined as a column property, only a single column can determine the constraint.</span></span> <span data-ttu-id="534cf-177">단일 열에 대 한 속성 VARIANT_TRUE 설정 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 테이블을 만들려고 할 때 오류가 반환 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-177">Setting the property VARIANT_TRUE for more than a single column returns an error when the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider attempts to create the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span><br /><br /> <span data-ttu-id="534cf-178">참고: 소비자는 **IIndexDefinition::CreateIndex**를 사용하여 둘 이상의 열에 대해 PRIMARY KEY 제약 조건을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-178">Note: The consumer can use **IIndexDefinition::CreateIndex** to create a PRIMARY KEY constraint on two or more columns.</span></span><br /><br /> <span data-ttu-id="534cf-179">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 DBPROP_COL_PRIMARYKEY와 DBPROP_COL_UNIQUE 모두 VARIANT_TRUE이 고 DBPROP_COL_UNIQUE의 *dwoption* 이 DBPROPOPTIONS_REQUIRED 되지 않은 경우 DB_S_ERRORSOCCURRED을 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-179">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="534cf-180">DBPROP_COL_PRIMARYKEY 및 DBPROP_COL_UNIQUE가 모두 VARIANT_TRUE이고 DBPROP_COL_UNIQUE의 *dwOption*이 DBPROPOPTIONS_REQUIRED이면 DB_E_ERRORSOCCURRED가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-180">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and the *dwOption* of DBPROP_COL_UNIQUE equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="534cf-181">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID 속성을 사용하여 열이 정의되고 DBPROP_COL_PRIMARYKEY *dwStatus* 멤버가 DBPROPSTATUS_CONFLICTING으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-181">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="534cf-182">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]DBPROP_COL_PRIMARYKEY 및 DBPROP_COL_NULLABLE 모두 VARIANT_TRUE 이면 Native Client OLE DB 공급자가 오류를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-182">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error when DBPROP_COL_PRIMARYKEY and DBPROP_COL_NULLABLE are both VARIANT_TRUE.</span></span><br /><br /> <span data-ttu-id="534cf-183">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 소비자가 잘못 된 데이터 형식의 열에 대 한 PRIMARY KEY 제약 조건을 만들려고 하면 Native Client OLE DB 공급자가에서 오류를 반환 합니다 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="534cf-183">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a PRIMARY KEY constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="534cf-184">**bit**, **text**, **ntext**, **image** 등의 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 데이터 형식을 사용하여 만든 열에 대해서는 PRIMARY KEY 제약 조건을 정의할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-184">PRIMARY KEY constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data types **bit**, **text**, **ntext**, and **image**.</span></span>|  
|<span data-ttu-id="534cf-185">DBPROP_COL_UNIQUE</span><span class="sxs-lookup"><span data-stu-id="534cf-185">DBPROP_COL_UNIQUE</span></span>|<span data-ttu-id="534cf-186">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-186">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-187">기본값: VARIANT_FALSE Description: [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 열에 UNIQUE 제약 조건을 적용 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-187">Default: VARIANT_FALSE Description: Applies a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] UNIQUE constraint to the column.</span></span><br /><br /> <span data-ttu-id="534cf-188">열 속성으로 정의된 경우 이 제약 조건은 단일 열에만 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-188">When defined as a column property, the constraint is applied on a single column only.</span></span> <span data-ttu-id="534cf-189">소비자는 **IIndexDefinition::CreateIndex**를 사용하여 둘 이상의 결합된 열 값에 대해 UNIQUE 제약 조건을 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-189">The consumer can use **IIndexDefinition::CreateIndex** to apply a UNIQUE constraint on the combined values of two or more columns.</span></span><br /><br /> <span data-ttu-id="534cf-190">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]DBPROP_COL_PRIMARYKEY 및 DBPROP_COL_UNIQUE 모두 VARIANT_TRUE이 고 *dwoption* 이 DBPROPOPTIONS_REQUIRED 되지 않는 경우 Native Client OLE DB 공급자는 DB_S_ERRORSOCCURRED를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-190">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="534cf-191">DBPROP_COL_PRIMARYKEY 및 DBPROP_COL_UNIQUE가 모두 VARIANT_TRUE이고 *dwOption*이 DBPROPOPTIONS_REQUIRED이면 DB_E_ERRORSOCCURRED가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-191">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_PRIMARYKEY and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="534cf-192">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID 속성을 사용하여 열이 정의되고 DBPROP_COL_PRIMARYKEY *dwStatus* 멤버가 DBPROPSTATUS_CONFLICTING으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-192">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_PRIMARYKEY *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="534cf-193">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]DBPROP_COL_NULLABLE 및 DBPROP_COL_UNIQUE 모두 VARIANT_TRUE이 고 *dwoption* 이 DBPROPOPTIONS_REQUIRED 되지 않는 경우 Native Client OLE DB 공급자는 DB_S_ERRORSOCCURRED를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-193">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns DB_S_ERRORSOCCURRED when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* is not DBPROPOPTIONS_REQUIRED.</span></span><br /><br /> <span data-ttu-id="534cf-194">DBPROP_COL_NULLABLE 및 DBPROP_COL_UNIQUE가 모두 VARIANT_TRUE이고 *dwOption*이 DBPROPOPTIONS_REQUIRED이면 DB_E_ERRORSOCCURRED가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-194">DB_E_ERRORSOCCURRED is returned when DBPROP_COL_NULLABLE and DBPROP_COL_UNIQUE are both VARIANT_TRUE and *dwOption* equals DBPROPOPTIONS_REQUIRED.</span></span> <span data-ttu-id="534cf-195">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] ID 속성을 사용하여 열이 정의되고 DBPROP_COL_NULLABLE *dwStatus* 멤버가 DBPROPSTATUS_CONFLICTING으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-195">The column is defined with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] identity property and the DBPROP_COL_NULLABLE *dwStatus* member is set to DBPROPSTATUS_CONFLICTING.</span></span><br /><br /> <span data-ttu-id="534cf-196">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 소비자가 잘못 된 데이터 형식의 열에 UNIQUE 제약 조건을 만들려고 하면 Native Client OLE DB 공급자가에서 오류를 반환 합니다 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="534cf-196">The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider returns an error from [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] when the consumer attempts to create a UNIQUE constraint on a column of invalid [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] data type.</span></span> <span data-ttu-id="534cf-197">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** 데이터 형식을 사용하여 만든 열에 대해서는 UNIQUE 제약 조건을 정의할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-197">UNIQUE constraints cannot be defined on columns created with the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] **bit** data type.</span></span>|  
  
 <span data-ttu-id="534cf-198">소비자가 **Itabledefinition:: CreateTable**를 호출 하면 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자가 테이블 속성을 다음과 같이 해석 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-198">When the consumer calls **ITableDefinition::CreateTable**, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider interprets table properties as follows.</span></span>  
  
|<span data-ttu-id="534cf-199">속성 ID</span><span class="sxs-lookup"><span data-stu-id="534cf-199">Property ID</span></span>|<span data-ttu-id="534cf-200">Description</span><span class="sxs-lookup"><span data-stu-id="534cf-200">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="534cf-201">DBPROP_TBL_TEMPTABLE</span><span class="sxs-lookup"><span data-stu-id="534cf-201">DBPROP_TBL_TEMPTABLE</span></span>|<span data-ttu-id="534cf-202">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="534cf-202">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="534cf-203">기본값: VARIANT_FALSE 설명: 기본적으로 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 소비자가 명명 한 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-203">Default: VARIANT_FALSE Description: By default, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider creates tables named by the consumer.</span></span> <span data-ttu-id="534cf-204">VARIANT_TRUE 때 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 소비자에 대 한 임시 테이블 이름을 생성 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-204">When VARIANT_TRUE, The [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider generates a temporary table name for the consumer.</span></span> <span data-ttu-id="534cf-205">소비자는 **CreateTable**의 *pTableID* 매개 변수를 NULL로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-205">The consumer sets the *pTableID* parameter of **CreateTable** to NULL.</span></span> <span data-ttu-id="534cf-206">*ppTableID* 매개 변수는 올바른 포인터를 포함해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-206">The *ppTableID* parameter must contain a valid pointer.</span></span>|  
  
 <span data-ttu-id="534cf-207">소비자가 성공적으로 만든 테이블에서 행 집합을 열도록 요청 하는 경우 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자는 커서 지원 행 집합을 엽니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-207">If the consumer requests that a rowset be opened on a successfully created table, the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Native Client OLE DB provider opens a cursor-supported rowset.</span></span> <span data-ttu-id="534cf-208">행 집합 속성은 전달하는 속성 집합에서 표시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-208">Any rowset properties can be indicated in the property sets passed.</span></span>  
  
 <span data-ttu-id="534cf-209">이 예에서는 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 테이블을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="534cf-209">This example creates a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span>  
  
```  
// This CREATE TABLE statement shows the details of the table created by   
// the following example code.  
//  
// CREATE TABLE OrderDetails  
// (  
//    OrderID      int      NOT NULL  
//    ProductID   int      NOT NULL  
//    CONSTRAINT PK_OrderDetails  
//         PRIMARY KEY CLUSTERED (OrderID, ProductID),  
//    UnitPrice   money      NOT NULL,  
//    Quantity   int      NOT NULL,  
//    Discount   decimal(2,2)   NOT NULL  
//        DEFAULT 0  
// )  
//  
// The PRIMARY KEY constraint is created in an additional example.  
HRESULT CreateTable  
    (  
    ITableDefinition* pITableDefinition  
    )  
    {  
    DBID            dbidTable;  
    const ULONG     nCols = 5;  
    ULONG           nCol;  
    ULONG           nProp;  
    DBCOLUMNDESC    dbcoldesc[nCols];  
  
    HRESULT         hr;  
  
    // Set up column descriptions. First, set default property values for  
    //  the columns.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        dbcoldesc[nCol].pwszTypeName = NULL;  
        dbcoldesc[nCol].pTypeInfo = NULL;  
        dbcoldesc[nCol].rgPropertySets = new DBPROPSET;  
        dbcoldesc[nCol].pclsid = NULL;  
        dbcoldesc[nCol].cPropertySets = 1;  
        dbcoldesc[nCol].ulColumnSize = 0;  
        dbcoldesc[nCol].dbcid.eKind = DBKIND_NAME;  
        dbcoldesc[nCol].wType = DBTYPE_I4;  
        dbcoldesc[nCol].bPrecision = 0;  
        dbcoldesc[nCol].bScale = 0;  
  
        dbcoldesc[nCol].rgPropertySets[0].rgProperties =   
            new DBPROP[NCOLPROPS_MAX];  
        dbcoldesc[nCol].rgPropertySets[0].cProperties = NCOLPROPS_MAX;  
        dbcoldesc[nCol].rgPropertySets[0].guidPropertySet =  
            DBPROPSET_COLUMN;  
  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                dwOptions = DBPROPOPTIONS_REQUIRED;  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].colid  
                 = DB_NULLID;  
  
            VariantInit(  
                &(dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                    vValue));  
  
            dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt = VT_BOOL;  
            }  
        }  
  
    // Set the column-specific information.  
    dbcoldesc[0].dbcid.uName.pwszName = L"OrderID";  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[0].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[0].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[1].dbcid.uName.pwszName = L"ProductID";  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[1].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[1].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[2].dbcid.uName.pwszName = L"UnitPrice";  
    dbcoldesc[2].wType = DBTYPE_CY;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[2].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[2].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[3].dbcid.uName.pwszName = L"Quantity";  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[3].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[3].rgPropertySets[0].cProperties = 1;  
  
    dbcoldesc[4].dbcid.uName.pwszName = L"Discount";  
    dbcoldesc[4].wType = DBTYPE_NUMERIC;  
    dbcoldesc[4].bPrecision = 2;  
    dbcoldesc[4].bScale = 2;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].dwPropertyID =   
        DBPROP_COL_NULLABLE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[0].vValue.boolVal =   
        VARIANT_FALSE;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].dwPropertyID =   
        DBPROP_COL_DEFAULT;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.vt = VT_BSTR;  
    dbcoldesc[4].rgPropertySets[0].rgProperties[1].vValue.bstrVal =  
        SysAllocString(L"0");  
    dbcoldesc[4].rgPropertySets[0].cProperties = 2;  
  
    // Set up the dbid for OrderDetails.  
    dbidTable.eKind = DBKIND_NAME;  
    dbidTable.uName.pwszName = L"OrderDetails";  
  
    if (FAILED(hr = pITableDefinition->CreateTable(NULL, &dbidTable,  
        nCols, dbcoldesc, NULL, 0, NULL, NULL, NULL)))  
        {  
        DumpError(pITableDefinition, IID_ITableDefinition);  
        goto SAFE_EXIT;  
        }  
  
SAFE_EXIT:  
    // Clean up dynamic allocation in the property sets.  
    for (nCol = 0; nCol < nCols; nCol++)  
        {  
        for (nProp = 0; nProp < NCOLPROPS_MAX; nProp++)  
            {  
            if (dbcoldesc[nCol].rgPropertySets[0].rgProperties[nProp].  
                vValue.vt == VT_BSTR)  
                {  
                SysFreeString(dbcoldesc[nCol].rgPropertySets[0].  
                    rgProperties[nProp].vValue.bstrVal);  
                }  
            }  
  
        delete [] dbcoldesc[nCol].rgPropertySets[0].rgProperties;  
        delete [] dbcoldesc[nCol].rgPropertySets;  
        }  
  
    return (hr);  
    }  
```  
  
## <a name="see-also"></a><span data-ttu-id="534cf-210">참고 항목</span><span class="sxs-lookup"><span data-stu-id="534cf-210">See Also</span></span>  
 [<span data-ttu-id="534cf-211">테이블 및 인덱스</span><span class="sxs-lookup"><span data-stu-id="534cf-211">Tables and Indexes</span></span>](../../relational-databases/native-client-ole-db-tables-indexes/tables-and-indexes.md)  
  
  
