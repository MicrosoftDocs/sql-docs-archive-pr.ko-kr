---
title: OLE DB 테이블 반환 매개 변수 형식 지원(메서드) | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- table-valued parameters (OLE DB), API support (methods)
ms.assetid: e3c2a450-8fd4-44cb-93d8-affe1b65c68e
author: rothja
ms.author: jroth
ms.openlocfilehash: 8c7ca5946228ea05708984fb89ebc603061d983d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87649024"
---
# <a name="ole-db-table-valued-parameter-type-support-methods"></a><span data-ttu-id="47d94-102">OLE DB 테이블 반환 매개 변수 형식 지원(메서드)</span><span class="sxs-lookup"><span data-stu-id="47d94-102">OLE DB Table-Valued Parameter Type Support (Methods)</span></span>
  <span data-ttu-id="47d94-103">다음 표준 OLE DB 메서드는 테이블 반환 매개 변수를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-103">The following standard OLE DB methods support table-valued parameters:</span></span>  
  
|<span data-ttu-id="47d94-104">방법</span><span class="sxs-lookup"><span data-stu-id="47d94-104">Method</span></span>|<span data-ttu-id="47d94-105">테이블 반환 매개 변수 지원</span><span class="sxs-lookup"><span data-stu-id="47d94-105">Table-valued parameter support</span></span>|  
|------------|-------------------------------------|  
|<span data-ttu-id="47d94-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span><span class="sxs-lookup"><span data-stu-id="47d94-106">ITableDefinitionWithConstraints::CreateTableWithConstraints</span></span>|<span data-ttu-id="47d94-107">테이블 반환 매개 변수의 형식 정보를 알고 있으며 해당 형식 정보를 기반으로 테이블 반환 매개 변수 행 집합 개체를 인스턴스화하려는 경우 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-107">Used when you know type information of table-valued parameter, and want to instantiate a table-valued parameter rowset object based on the type-information.</span></span><br /><br /> <span data-ttu-id="47d94-108">자세한 내용은 [테이블 반환 매개 변수 행 집합 만들기](table-valued-parameter-rowset-creation.md)의 "정적 시나리오"를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="47d94-108">For more information, see "Static Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="47d94-109">IOpenRowset::OpenRowset</span><span class="sxs-lookup"><span data-stu-id="47d94-109">IOpenRowset::OpenRowset</span></span>|<span data-ttu-id="47d94-110">테이블 반환 매개 변수의 형식 정보를 알지 못하며 서버에서 검색된 메타데이터 정보를 기반으로 테이블 반환 매개 변수 행 집합 개체를 인스턴스화하려는 경우 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-110">Used when you do not know the type information of a table-valued parameter, and want to instantiate a table-valued parameter rowset object based on metadata information retrieved from the server.</span></span><br /><br /> <span data-ttu-id="47d94-111">자세한 내용은 [테이블 반환 매개 변수 행 집합 만들기](table-valued-parameter-rowset-creation.md)의 "동적 시나리오"를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="47d94-111">For more information, see "Dynamic Scenario" in [Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md).</span></span>|  
|<span data-ttu-id="47d94-112">ISSCommandWithParameters::SetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="47d94-112">ISSCommandWithParameters::SetParameterInfo</span></span>|<span data-ttu-id="47d94-113">테이블 반환 매개 변수의 명령 매개 변수를 지정하려면 소비자가 DBPARAMBINDINFO 구조체의 *pwszName* 멤버에서 매개 변수 형식을 "table" 또는 "DBTYPE_TABLE"로 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-113">To specify a table-valued parameter command parameter, the consumer specifies the type of the parameter as "table" or "DBTYPE_TABLE" in the *pwszName* member of DBPARAMBINDINFO structure.</span></span> <span data-ttu-id="47d94-114">*ulParamSize*는 ~0으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-114">The *ulParamSize* is set to ~0.</span></span> <span data-ttu-id="47d94-115">자세한 정보는 [테이블 반환 매개 변수가 포함된 명령 실행](executing-commands-containing-table-valued-parameters.md)에서 "테이블 반환 매개 변수 사양"을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="47d94-115">For more information, see "Table-Valued Parameter Specification" in [Executing Commands Containing Table-Valued Parameters](executing-commands-containing-table-valued-parameters.md).</span></span>|  
|<span data-ttu-id="47d94-116">ISSCommandWithParameters::SetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="47d94-116">ISSCommandWithParameters::SetParameterProperties</span></span>|<span data-ttu-id="47d94-117">스키마 이름, 유형 이름, 열 순서, 기본 열과 같은 테이블 반환 매개 변수와 관련된 속성을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-117">Sets properties specific to table-valued parameters, such as schema name, type name, column order, and default columns.</span></span><br /><br /> <span data-ttu-id="47d94-118">소비자가 SSPARAMPROPS 구조체의 *iOrdinal*에서 매개 변수의 서수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-118">The consumer specifies the ordinal of the parameter in the *iOrdinal* of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="47d94-119">요청되는 속성 집합은 DBPROPSET_SQLSERVERPARAMETER입니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-119">The property set requested is DBPROPSET_SQLSERVERPARAMETER.</span></span>|  
|<span data-ttu-id="47d94-120">ISSCommandWithParameters::GetParameterInfo</span><span class="sxs-lookup"><span data-stu-id="47d94-120">ISSCommandWithParameters::GetParameterInfo</span></span>|<span data-ttu-id="47d94-121">모든 매개 변수 형식을 지정된 명령으로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-121">Gets the types of all the parameters to a specified command.</span></span><br /><br /> <span data-ttu-id="47d94-122">테이블 반환 매개 변수의 경우 DBPARAMINFO 구조체의 *wType* 필드는 DBTYPE_TABLE 형식이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-122">For table-valued parameters, the *wType* field in DBPARAMINFO structure will have type DBTYPE_TABLE.</span></span> <span data-ttu-id="47d94-123">*ulParamSize* 필드는 알 수 없는 길이를 나타내는 ~0으로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-123">The *ulParamSize* field will be set to ~0 to indicate unknown length.</span></span>|  
|<span data-ttu-id="47d94-124">ISSCommandWithParameters::GetParameterProperties</span><span class="sxs-lookup"><span data-stu-id="47d94-124">ISSCommandWithParameters::GetParameterProperties</span></span>|<span data-ttu-id="47d94-125">DBTYPE_TABLE 형식의 매개 변수에 대한 추가적인 형식 정보를 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-125">Gets additional type information for parameters of the DBTYPE_TABLE type.</span></span><br /><br /> <span data-ttu-id="47d94-126">소비자가 SSPARAMPROPS 구조체의 *iOrdinal* 멤버에서 매개 변수의 서수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-126">The consumer specifies the ordinal of the parameter in the *iOrdinal* member of the SSPARAMPROPS structure.</span></span> <span data-ttu-id="47d94-127">소비자는 ISSCommandWithParameters::SetParameterProperties에 나열되어 있는 DBPROPSET_SQLSERVERPARAMETER 속성 집합의 속성 중 하나를 요청할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-127">The consumer can request any of the properties in the DBPROPSET_SQLSERVERPARAMETER property set that are listed under ISSCommandWithParameters::SetParameterProperties.</span></span><br /><br /> <span data-ttu-id="47d94-128">소비자가 테이블 반환 매개 변수 형식을 알 수 없기 때문에 공급자가 SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME 및 SSPROP_PARAM_TYPE_CATALOGNAME을 올바른 값으로 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-128">Because the consumer does not know the table-valued parameter type, the provider must set the SSPROP_PARAM_TYPE_TYPENAME, SSPROP_PARAM_TYPE_SCHEMANAME, and SSPROP_PARAM_TYPE_CATALOGNAME to their correct values.</span></span> <span data-ttu-id="47d94-129">나머지 SSPROP_PARAM_TABLE_DEFAULT_COLUMNS 및 SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER 속성에는 기본값이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-129">The remaining properties, SSPROP_PARAM_TABLE_DEFAULT_COLUMNS and SSPROP_PARAM_TABLE_COLUMN_SORT_ORDER, will have their default values.</span></span> <span data-ttu-id="47d94-130">소비자는 테이블 반환 매개 변수 형식 이름을 검색한 후 IOpenRowset::OpenRowset을 사용하여 테이블 반환 매개 변수 형식을 지정함으로써 이 테이블 반환 매개 변수의 인스턴스를 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-130">After the consumer has discovered the table-valued parameter type name, it uses IOpenRowset::OpenRowset to create an instance of this table-valued parameter, specifying the name of table-valued parameter type.</span></span> <span data-ttu-id="47d94-131">자세한 내용은 [테이블 반환 매개 변수 형식 검색](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="47d94-131">For more information, see [Table-Valued Parameter Type Discovery](../../database-engine/dev-guide/table-valued-parameter-type-discovery.md).</span></span>|  
|<span data-ttu-id="47d94-132">IRowsetInfo::GetProperties</span><span class="sxs-lookup"><span data-stu-id="47d94-132">IRowsetInfo::GetProperties</span></span>|<span data-ttu-id="47d94-133">테이블 반환 매개 변수 행 집합 속성을 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-133">Gets table-valued parameter rowset properties.</span></span> <span data-ttu-id="47d94-134">소비자는 이 속성을 사용하여 최적의 바인딩을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-134">The consumer can use these properties to optimally set up bindings.</span></span>|  
|<span data-ttu-id="47d94-135">IColumnsRowset::GetColumnsRowset</span><span class="sxs-lookup"><span data-stu-id="47d94-135">IColumnsRowset::GetColumnsRowset</span></span>|<span data-ttu-id="47d94-136">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 테이블에 대한 메타데이터 정보를 검색합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-136">Retrieves metadata information about a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="47d94-137">테이블 반환 매개 변수의 경우에는 동일한 인터페이스에서 다음과 같은 각 열에 대한 자세한 메타데이터 정보를 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-137">For table-valued parameters, this same interface provides detailed metadata information about each column, such as the following:</span></span><br /><br /> <span data-ttu-id="47d94-138">-DBCOLUMN_FLAGS는 DBCOLUMNFLAGS_ISNULLABLE 비트를 통해 null 허용 여부를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-138">-   DBCOLUMN_FLAGS indicates nullability through the DBCOLUMNFLAGS_ISNULLABLE bit.</span></span><br /><span data-ttu-id="47d94-139">-DBCOLUMN_ISUNIQUE 열이 id 열인지 여부를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-139">-   DBCOLUMN_ISUNIQUE indicates whether the column is an identity column.</span></span><br /><span data-ttu-id="47d94-140">-DBCOLUMN_COMPUTEMODE 열이 계산 되는지 여부를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-140">-   DBCOLUMN_COMPUTEMODE indicates whether the column is computed.</span></span>|  
|<span data-ttu-id="47d94-141">IAccessor::CreateAccessor</span><span class="sxs-lookup"><span data-stu-id="47d94-141">IAccessor::CreateAccessor</span></span>|<span data-ttu-id="47d94-142">테이블 반환 매개 변수 행 집합 개체를 명령 매개 변수에 바인딩하려면 해당 *wType* 멤버를 DBTYPE_TABLE로 설정하여 접근자를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-142">To bind a table-valued parameter rowset object to a command parameter, you create an accessor with its *wType* member set to DBTYPE_TABLE.</span></span> <span data-ttu-id="47d94-143">DBOBJECT 구조체에는 IID_IRowset 또는 *iid* 멤버의 기타 유효한 행 집합 개체 인터페이스가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-143">The DBOBJECT structure will contain IID_IRowset or any other valid rowset object interface in the *iid* member.</span></span> <span data-ttu-id="47d94-144">나머지 필드는 DBTYPE_IUNKNOWN과 유사하게 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="47d94-144">The rest of the fields are treated similarly to DBTYPE_IUNKNOWN.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="47d94-145">참고 항목</span><span class="sxs-lookup"><span data-stu-id="47d94-145">See Also</span></span>  
 <span data-ttu-id="47d94-146">[OLE DB 테이블 반환 매개 변수 형식 지원](ole-db-table-valued-parameter-type-support.md) </span><span class="sxs-lookup"><span data-stu-id="47d94-146">[OLE DB Table-Valued Parameter Type Support](ole-db-table-valued-parameter-type-support.md) </span></span>  
 <span data-ttu-id="47d94-147">[테이블 반환 매개 변수 행 집합 만들기](table-valued-parameter-rowset-creation.md) </span><span class="sxs-lookup"><span data-stu-id="47d94-147">[Table-Valued Parameter Rowset Creation](table-valued-parameter-rowset-creation.md) </span></span>  
 [<span data-ttu-id="47d94-148">테이블 반환 매개 변수&#40;OLE DB&#41; 사용</span><span class="sxs-lookup"><span data-stu-id="47d94-148">Use Table-Valued Parameters &#40;OLE DB&#41;</span></span>](table-valued-parameters-ole-db.md)  
  
  
