---
title: 프로그래밍 방식으로 암호 변경 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], password expiration
- SQL Server Native Client ODBC driver, passwords
- SQL Server Native Client OLE DB provider, passwords
- passwords [SQL Server], expiration
- SQLNCLI, password expiration
- expiration [SQL Server Native Client]
- passwords [SQL Server], modifying
- expired passwords [SQL Server Native Client]
- SQL Server Native Client, password expiration
- modifying passwords
ms.assetid: 624ad949-5fed-4ce5-b319-878549f9487b
author: rothja
ms.author: jroth
ms.openlocfilehash: 86085f8ba7c54cfcab1a3c7f6e8ade30ecf9d0da
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87730611"
---
# <a name="changing-passwords-programmatically"></a><span data-ttu-id="4dbba-102">프로그래밍 방식으로 암호 변경</span><span class="sxs-lookup"><span data-stu-id="4dbba-102">Changing Passwords Programmatically</span></span>
  <span data-ttu-id="4dbba-103">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 이전에는 사용자 암호가 만료될 때 관리자만 암호를 다시 설정할 수 있었습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-103">Before [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], when a user's password expired, only an administrator could reset it.</span></span> <span data-ttu-id="4dbba-104">부터 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] native client OLE DB 공급자와 native client ODBC 드라이버를 통해 프로그래밍 방식으로 암호 만료를 처리 하 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 고 **SQL Server 로그인** 대화 상자를 변경 하는 것을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-104">Beginning with [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client supports handling password expiration programmatically through both the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider and the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, and through changes to the **SQL Server Login** dialog boxes.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4dbba-105">가능한 경우 런타임에 자격 증명을 입력하라는 메시지를 사용자에게 표시하고 해당 자격 증명을 지속형 형식으로 저장하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="4dbba-105">When possible, prompt users to enter their credentials at run time and avoid storing their credentials in a persisted format.</span></span> <span data-ttu-id="4dbba-106">자격 증명을 저장해야 하는 경우 [Win32 crypto API](https://go.microsoft.com/fwlink/?LinkId=64532)를 사용하여 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-106">If you must persist their credentials, you should encrypt them using the [Win32 crypto API](https://go.microsoft.com/fwlink/?LinkId=64532).</span></span> <span data-ttu-id="4dbba-107">암호 사용에 대한 자세한 내용은 [강력한 암호](../../security/strong-passwords.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4dbba-107">For more information about the use of passwords, see [Strong Passwords](../../security/strong-passwords.md).</span></span>  
  
## <a name="sql-server-login-error-codes"></a><span data-ttu-id="4dbba-108">SQL Server 로그인 오류 코드</span><span class="sxs-lookup"><span data-stu-id="4dbba-108">SQL Server Login Error Codes</span></span>  
 <span data-ttu-id="4dbba-109">인증 문제로 인해 연결할 수 없는 경우 분석 및 검색 지원을 위해 애플리케이션에서 다음 SQL Server 오류 코드 중 하나를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-109">When a connection cannot be made because of authentication problems, one of the following SQL Server error codes will be available to the application to assist diagnosis and recovery.</span></span>  
  
|<span data-ttu-id="4dbba-110">SQL Server 오류 코드</span><span class="sxs-lookup"><span data-stu-id="4dbba-110">SQL Server Error Code</span></span>|<span data-ttu-id="4dbba-111">오류 메시지</span><span class="sxs-lookup"><span data-stu-id="4dbba-111">Error Message</span></span>|  
|---------------------------|-------------------|  
|<span data-ttu-id="4dbba-112">15113</span><span class="sxs-lookup"><span data-stu-id="4dbba-112">15113</span></span>|<span data-ttu-id="4dbba-113">사용자 '%. \* l s '이 (가) 로그인 하지 못했습니다. 이유: 암호 유효성 검사에 실패 했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-113">Login failed for user '%.\*ls' Reason: Password validation failed.</span></span> <span data-ttu-id="4dbba-114">계정이 잠겼습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-114">The account is locked out.</span></span>|  
|<span data-ttu-id="4dbba-115">18463</span><span class="sxs-lookup"><span data-stu-id="4dbba-115">18463</span></span>|<span data-ttu-id="4dbba-116">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-116">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-117">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-117">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-118">지금은 암호를 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-118">The password cannot be used at this time.</span></span>|  
|<span data-ttu-id="4dbba-119">18464</span><span class="sxs-lookup"><span data-stu-id="4dbba-119">18464</span></span>|<span data-ttu-id="4dbba-120">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-120">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-121">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-121">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-122">암호가 너무 짧아서 정책 요구 사항에 맞지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-122">The password does not meet policy requirements because it is too short.</span></span>|  
|<span data-ttu-id="4dbba-123">18465</span><span class="sxs-lookup"><span data-stu-id="4dbba-123">18465</span></span>|<span data-ttu-id="4dbba-124">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-124">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-125">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-125">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-126">암호가 너무 길어서 정책 요구 사항에 맞지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-126">The password does not meet policy requirements because it is too long.</span></span>|  
|<span data-ttu-id="4dbba-127">18466</span><span class="sxs-lookup"><span data-stu-id="4dbba-127">18466</span></span>|<span data-ttu-id="4dbba-128">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-128">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-129">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-129">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-130">암호가 복잡하지 않기 때문에 정책 요구 사항에 맞지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-130">The password does not meet policy requirements because it is not complex enough.</span></span>|  
|<span data-ttu-id="4dbba-131">18467</span><span class="sxs-lookup"><span data-stu-id="4dbba-131">18467</span></span>|<span data-ttu-id="4dbba-132">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-132">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-133">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-133">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-134">암호가 암호 필터 DLL의 요구 사항에 맞지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-134">The password does not meet the requirements of the password filter DLL.</span></span>|  
|<span data-ttu-id="4dbba-135">18468</span><span class="sxs-lookup"><span data-stu-id="4dbba-135">18468</span></span>|<span data-ttu-id="4dbba-136">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-136">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-137">원인: 암호를 변경하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-137">Reason: Password change failed.</span></span> <span data-ttu-id="4dbba-138">암호 유효성 검사 중에 오류가 발생했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-138">An unexpected error occurred during password validation.</span></span>|  
|<span data-ttu-id="4dbba-139">18487</span><span class="sxs-lookup"><span data-stu-id="4dbba-139">18487</span></span>|<span data-ttu-id="4dbba-140">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-140">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-141">원인: 계정의 암호가 만료되었습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-141">Reason: The password of the account has expired.</span></span>|  
|<span data-ttu-id="4dbba-142">18488</span><span class="sxs-lookup"><span data-stu-id="4dbba-142">18488</span></span>|<span data-ttu-id="4dbba-143">사용자 '%.\*ls'이(가) 로그인하지 못했습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-143">Login failed for user '%.\*ls'.</span></span> <span data-ttu-id="4dbba-144">원인: 계정의 암호를 변경해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-144">Reason: The password of the account must be changed.</span></span>|  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="4dbba-145">SQL Server Native Client OLE DB 공급자</span><span class="sxs-lookup"><span data-stu-id="4dbba-145">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="4dbba-146">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 사용자 인터페이스를 통해 또는 프로그래밍 방식으로 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="ole-db-user-interface-password-expiration"></a><span data-ttu-id="4dbba-147">OLE DB 사용자 인터페이스 암호 만료</span><span class="sxs-lookup"><span data-stu-id="4dbba-147">OLE DB User Interface Password Expiration</span></span>  
 <span data-ttu-id="4dbba-148">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 **SQL Server 로그인** 대화 상자에 대 한 변경 내용을 통해 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-148">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span> <span data-ttu-id="4dbba-149">DBPROP_INIT_PROMPT 값을 DBPROMPT_NOPROMPT로 설정하면 암호가 만료할 경우 초기 연결 시도가 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-149">If the value of DBPROP_INIT_PROMPT is set to DBPROMPT_NOPROMPT, the initial connection attempt will fail if the password has expired.</span></span>  
  
 <span data-ttu-id="4dbba-150">DBPROP_INIT_PROMPT를 다른 값으로 설정하면 암호 만료 여부에 관계없이 사용자에게 **SQL Server 로그인** 대화 상자가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-150">If DBPROP_INIT_PROMPT has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="4dbba-151">사용자는 **옵션** 단추를 클릭하고 **암호 변경**을 선택하여 암호를 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-151">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="4dbba-152">사용자가 확인을 클릭하면 암호가 만료된 경우 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 **SQL Server 암호 변경** 대화 상자를 사용하여 새 암호를 입력하고 확인하라는 메시지를 사용자에게 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-152">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts the user to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="ole-db-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="4dbba-153">OLE DB 프롬프트 동작 및 잠긴 계정</span><span class="sxs-lookup"><span data-stu-id="4dbba-153">OLE DB Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="4dbba-154">계정이 잠겨 연결 시도가 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-154">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="4dbba-155">**SQL Server 로그인** 대화 상자가 표시된 후 이 문제가 발생하면 서버 오류 메시지가 사용자에게 표시되고 연결 시도가 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-155">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="4dbba-156">사용자가 이전 암호에 잘못된 값을 입력하면 **SQL Server 암호 변경** 대화 상자가 표시된 후에도 이 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-156">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="4dbba-157">이 경우 동일한 오류 메시지가 표시되고 연결 시도가 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-157">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="ole-db-connection-pooling-password-expiration-and-locked-accounts"></a><span data-ttu-id="4dbba-158">OLE DB 연결 풀링, 암호 만료 및 잠긴 계정</span><span class="sxs-lookup"><span data-stu-id="4dbba-158">OLE DB Connection Pooling, Password Expiration, and Locked Accounts</span></span>  
 <span data-ttu-id="4dbba-159">연결 풀에서 연결이 활성화되어 있는 동안 계정이 잠기거나 해당 암호가 만료될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-159">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="4dbba-160">서버는 두 가지 경우에서 만료된 암호와 잠긴 계정을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-160">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="4dbba-161">첫 번째는 연결을 처음 만들 때입니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-161">The first is when a connection is first created.</span></span> <span data-ttu-id="4dbba-162">두 번째 경우는 연결을 다시 설정하여 연결이 풀에서 제거될 때입니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-162">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="4dbba-163">다시 설정 시도가 실패하면 풀에서 연결이 제거되고 오류가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-163">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="ole-db-programmatic-password-expiration"></a><span data-ttu-id="4dbba-164">OLE DB 프로그래밍 방식 암호 만료</span><span class="sxs-lookup"><span data-stu-id="4dbba-164">OLE DB Programmatic Password Expiration</span></span>  
 <span data-ttu-id="4dbba-165">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 DBPROPSET_SQLSERVERDBINIT 속성 집합에 추가 된 SSPROP_AUTH_OLD_PASSWORD (유형 VT_BSTR) 속성을 추가 하 여 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-165">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration through the addition of the SSPROP_AUTH_OLD_PASSWORD (type VT_BSTR) property that has been added to the DBPROPSET_SQLSERVERDBINIT property set.</span></span>  
  
 <span data-ttu-id="4dbba-166">기존 "암호" 속성은 DBPROP_AUTH_PASSWORD를 참조하며 새 암호를 저장하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-166">The existing "Password" property refers to DBPROP_AUTH_PASSWORD and is used to store the new password.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4dbba-167">연결 문자열에서 "이전 암호" 속성은 공급자 문자열 속성을 통해 사용할 수 없는 현재(만료된) 암호인 SSPROP_AUTH_OLD_PASSWORD를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-167">In the connection string, the "Old Password" property sets SSPROP_AUTH_OLD_PASSWORD, which is the current (possibly expired) password that is not available via a provider string property.</span></span>  
  
 <span data-ttu-id="4dbba-168">공급자는 이 속성 값을 저장하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-168">The provider does not persist the value of this property.</span></span> <span data-ttu-id="4dbba-169">이 속성을 설정하면 새 연결이 발생하기 때문에 공급자가 첫 번째 연결의 연결 풀을 사용하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-169">When this property is set, the provider does not use the connection pool for the first connection because a new connection will occur.</span></span> <span data-ttu-id="4dbba-170">암호 변경에 성공하면 현재 연결을 다시 사용할 수 없습니다. 암호 변경 후 유효하지 않은 이전 암호가 현재 연결에 포함되어 있기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-170">If the password change is successful, the current connection cannot be reused since it still contains the old password, which will be invalid after the password change.</span></span> <span data-ttu-id="4dbba-171">또한 로그인에 성공하면 공급자는 이 속성을 지웁니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-171">Also, if the login succeeds, the provider clears this property.</span></span> <span data-ttu-id="4dbba-172">이후에 이전 암호를 검색하려고 하면 VT_EMPTY가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-172">Subsequent attempts to retrieve the old password return VT_EMPTY.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="4dbba-173">SSPROP_AUTH_OLD_PASSWORD는 암호가 만료된 경우에만 사용되기 때문에 저장하면 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-173">SSPROP_AUTH_OLD_PASSWORD should never be persisted since it is only used when a password has expired.</span></span>  
  
 <span data-ttu-id="4dbba-174">"이전 암호" 속성을 설정할 때마다 공급자는 Windows 인증도 지정되어 항상 우선 적용되지 않는 경우 암호 변경이 시도되고 있다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-174">Note that whenever the "Old Password" property is set, the provider assumes that an attempt to change the password is being made, unless Windows Authentication is also specified, in which case it always takes precedence.</span></span>  
  
 <span data-ttu-id="4dbba-175">Windows 인증이 사용되는 경우 이전 암호를 지정하면 이전 암호가 REQUIRED 또는 OPTIONAL로 지정되었는지에 따라 각각 DB_E_ERRORSOCCURRED 또는 DB_S_ERRORSOCCURRED가 발생하고, DBPROPSTATUS_CONFLICTINGBADVALUE의 상태 값이 *dwStatus*에 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-175">If Windows Authentication is used, specifying the old password results in either DB_E_ERRORSOCCURRED or DB_S_ERRORSOCCURRED depending on whether the old password was specified as REQUIRED or OPTIONAL respectively, and the status value of DBPROPSTATUS_CONFLICTINGBADVALUE is returned in *dwStatus*.</span></span> <span data-ttu-id="4dbba-176">이 값은 **IDBInitialize::Initialize**를 호출할 때 검색됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-176">This is detected when **IDBInitialize::Initialize** is called.</span></span>  
  
 <span data-ttu-id="4dbba-177">암호 변경 시도가 예기치 않게 실패하는 경우 서버에서 오류 코드 18468을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-177">If an attempt to change the password fails unexpectedly, the server returns error code 18468.</span></span> <span data-ttu-id="4dbba-178">연결 시도에서 표준 OLEDB 오류가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-178">A standard OLEDB error is returned from the connection attempt.</span></span>  
  
 <span data-ttu-id="4dbba-179">DBPROPSET_SQLSERVERDBINIT 속성 집합에 대한 자세한 정보는 p[초기화 및 권한 부여 속성](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="4dbba-179">For more information about the DBPROPSET_SQLSERVERDBINIT property set, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="4dbba-180">SQL Server Native Client ODBC 드라이버</span><span class="sxs-lookup"><span data-stu-id="4dbba-180">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="4dbba-181">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 사용자 인터페이스를 통해 또는 프로그래밍 방식으로 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-181">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports password expiration though a user interface and programmatically.</span></span>  
  
### <a name="odbc-user-interface-password-expiration"></a><span data-ttu-id="4dbba-182">ODBC 사용자 인터페이스 암호 만료</span><span class="sxs-lookup"><span data-stu-id="4dbba-182">ODBC User Interface Password Expiration</span></span>  
 <span data-ttu-id="4dbba-183">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 드라이버는 **SQL Server 로그인** 대화 상자에 대 한 변경 내용을 통해 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-183">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through changes made to the **SQL Server Login** dialog boxes.</span></span>  
  
 <span data-ttu-id="4dbba-184">[SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) 이 호출 되 고 **drivercompletion** 값이 SQL_DRIVER_NOPROMPT로 설정 된 경우 암호가 만료 되 면 초기 연결 시도가 실패 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-184">If [SQLDriverConnect](../../native-client-odbc-api/sqldriverconnect.md) is called and the value of **DriverCompletion** is set to SQL_DRIVER_NOPROMPT, the initial connection attempt fails if the password has expired.</span></span> <span data-ttu-id="4dbba-185">SQLSTATE 값 28000 및 네이티브 오류 코드 값 18487은 **SQLError** 또는 **SQLGetDiagRec**에 대 한 후속 호출에서 반환 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-185">The SQLSTATE value 28000 and the native error code value 18487 are returned by subsequent calls to **SQLError** or **SQLGetDiagRec**.</span></span>  
  
 <span data-ttu-id="4dbba-186">**Drivercompletion** 가 다른 값으로 설정 된 경우 암호가 만료 되었는지 여부에 관계 없이 사용자에 게 **SQL Server 로그인** 대화 상자가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-186">If **DriverCompletion** has been set to any other value, the user sees the **SQL Server Login** dialog, regardless of whether or not the password has expired.</span></span> <span data-ttu-id="4dbba-187">사용자는 **옵션** 단추를 클릭하고 **암호 변경**을 선택하여 암호를 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-187">The user can click on the **Options** button and check **Change Password** to change the password.</span></span>  
  
 <span data-ttu-id="4dbba-188">사용자가 확인을 클릭 하 고 암호가 만료 되 면에서 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] **암호 SQL Server 변경** 대화 상자를 사용 하 여 새 암호를 입력 하 고 확인 하 라는 메시지를 표시 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-188">If the user clicks OK and the password has expired, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] prompts to enter and confirm a new password using the **Change SQL Server Password** dialog.</span></span>  
  
#### <a name="odbc-prompt-behavior-and-locked-accounts"></a><span data-ttu-id="4dbba-189">ODBC 프롬프트 동작 및 잠긴 계정</span><span class="sxs-lookup"><span data-stu-id="4dbba-189">ODBC Prompt Behavior and Locked Accounts</span></span>  
 <span data-ttu-id="4dbba-190">계정이 잠겨 연결 시도가 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-190">Connection attempts may fail due to the account being locked.</span></span> <span data-ttu-id="4dbba-191">**SQL Server 로그인** 대화 상자가 표시된 후 이 문제가 발생하면 서버 오류 메시지가 사용자에게 표시되고 연결 시도가 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-191">If this occurs following the display of the **SQL Server Login** dialog, the server error message is displayed to the user and the connection attempt is aborted.</span></span> <span data-ttu-id="4dbba-192">사용자가 이전 암호에 잘못된 값을 입력하면 **SQL Server 암호 변경** 대화 상자가 표시된 후에도 이 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-192">It may also occur following the display of the **Change SQL Server Password** dialog if the user enters a bad value for the old password.</span></span> <span data-ttu-id="4dbba-193">이 경우 동일한 오류 메시지가 표시되고 연결 시도가 중단됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-193">In this case the same error message is displayed, and the connection attempt is aborted.</span></span>  
  
#### <a name="odbc-connection-pooling-password-expiry-and-locked-accounts"></a><span data-ttu-id="4dbba-194">ODBC 연결 풀링, 암호 만료 및 잠긴 계정</span><span class="sxs-lookup"><span data-stu-id="4dbba-194">ODBC Connection Pooling, Password Expiry, and Locked Accounts</span></span>  
 <span data-ttu-id="4dbba-195">연결 풀에서 연결이 활성화되어 있는 동안 계정이 잠기거나 해당 암호가 만료될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-195">An account may be locked or its password may expire while the connection is still active in a connection pool.</span></span> <span data-ttu-id="4dbba-196">서버는 두 가지 경우에서 만료된 암호와 잠긴 계정을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-196">The server checks for expired passwords and locked accounts on two occasions.</span></span> <span data-ttu-id="4dbba-197">첫 번째는 연결을 처음 만들 때입니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-197">The first is when a connection is first created.</span></span> <span data-ttu-id="4dbba-198">두 번째 경우는 연결을 다시 설정하여 연결이 풀에서 제거될 때입니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-198">The second occasion is upon connection reset, when the connection is taken from the pool.</span></span>  
  
 <span data-ttu-id="4dbba-199">다시 설정 시도가 실패하면 풀에서 연결이 제거되고 오류가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-199">When the reset attempt fails, the connection is removed from the pool and an error is returned.</span></span>  
  
### <a name="odbc-programmatic-password-expiration"></a><span data-ttu-id="4dbba-200">ODBC 프로그래밍 방식 암호 만료</span><span class="sxs-lookup"><span data-stu-id="4dbba-200">ODBC Programmatic Password Expiration</span></span>  
 <span data-ttu-id="4dbba-201">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 드라이버는 [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) 함수를 사용 하 여 서버에 연결 하기 전에 설정 된 SQL_COPT_SS_OLDPWD 특성을 추가 하 여 암호 만료를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-201">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports password expiration through the addition of the SQL_COPT_SS_OLDPWD attribute which is set before connecting to the server using the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) function.</span></span>  
  
 <span data-ttu-id="4dbba-202">연결 핸들의 SQL_COPT_SS_OLDPWD 특성은 만료된 암호를 참조합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-202">The SQL_COPT_SS_OLDPWD attribute of the connection handle refers to the expired password.</span></span> <span data-ttu-id="4dbba-203">연결 풀링에 방해가 되므로 이 특성에 대한 연결 문자열 특성은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-203">There is no connection string attribute for this attribute, as this would interfere with connection pooling.</span></span> <span data-ttu-id="4dbba-204">로그인에 성공하면 드라이버가 이 특성을 지웁니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-204">If the login succeeds, the driver clears this attribute.</span></span>  
  
 <span data-ttu-id="4dbba-205">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 드라이버는이 기능에 대해 암호 만료, 암호 정책 충돌, 계정 잠금 및 Windows 인증을 사용 하는 동안 이전 암호 속성이 설정 된 경우의 네 가지 경우에 SQL_ERROR를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-205">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver returns SQL_ERROR in four cases for this feature: password expiration, password policy conflict, account lockout, and when the old password property is set while using Windows Authentication.</span></span> <span data-ttu-id="4dbba-206">[SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) 가 호출 되 면 드라이버는 사용자에 게 적절 한 오류 메시지를 반환 합니다.</span><span class="sxs-lookup"><span data-stu-id="4dbba-206">The driver returns the appropriate error messages to the user when [SQLGetDiagField](../../native-client-odbc-api/sqlgetdiagfield.md) is invoked.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4dbba-207">참고 항목</span><span class="sxs-lookup"><span data-stu-id="4dbba-207">See Also</span></span>  
 [<span data-ttu-id="4dbba-208">SQL Server Native Client 기능</span><span class="sxs-lookup"><span data-stu-id="4dbba-208">SQL Server Native Client Features</span></span>](sql-server-native-client-features.md)  
  
  
