---
title: 스냅샷 격리 작업 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- data access [SQL Server Native Client], snapshot isolation
- SQLNCLI, snapshot isolation
- isolation levels [SQL Server], snapshot
- DBPROPSET_SESSION property set
- DBDROPSET_DATASOURCEINFO property set
- snapshot isolation [SQL Server Native Client]
- SQL Server Native Client OLE DB provider, snapshot isolation
- SQL Server Native Client ODBC driver, snapshot isolation
- SQL Server Native Client, snapshot isolation
- SQLGetInfo function
- concurrency [SQL Server Native Client]
- SQLSetConnectAttr function
ms.assetid: 39e87eb1-677e-45dd-bc61-83a4025a7756
author: rothja
ms.author: jroth
ms.openlocfilehash: 242d054a5fd2ad12a8811bebc834d423f547a499
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87653302"
---
# <a name="working-with-snapshot-isolation"></a><span data-ttu-id="b061e-102">스냅샷 격리 작업</span><span class="sxs-lookup"><span data-stu-id="b061e-102">Working with Snapshot Isolation</span></span>
  [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]<span data-ttu-id="b061e-103">에서는 OLTP(온라인 트랜잭션 처리) 애플리케이션의 동시성을 향상시키기 위한 새로운 &quot;스냅샷&quot; 격리 수준이 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-103">introduced a new "snapshot" isolation level that is intended to enhance concurrency for online transaction processing (OLTP) applications.</span></span> <span data-ttu-id="b061e-104">이전 버전의 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서는 동시성이 일부 애플리케이션에 대해 문제 차단 및 교착 상태를 발생시킬 수 있는 잠금 기능에만 의존했습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-104">In earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], concurrency was based solely on locking, which can cause blocking and deadlocking problems for some applications.</span></span> <span data-ttu-id="b061e-105">스냅샷 격리는 향상된 행 버전 관리 기능을 사용하며 읽기/쓰기 차단 시나리오를 방지하여 성능을 향상시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-105">Snapshot isolation depends on enhancements to row versioning and is intended to improve performance by avoiding reader-writer blocking scenarios.</span></span>  
  
 <span data-ttu-id="b061e-106">스냅샷 격리 하에 시작된 트랜잭션은 트랜잭션이 시작된 시간을 기준으로 데이터베이스 스냅샷을 읽습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-106">Transactions that start under snapshot isolation read a database snapshot as of the time when the transaction starts.</span></span> <span data-ttu-id="b061e-107">그 결과, 스냅샷 트랜잭션 컨텍스트 내에서 열린 키 집합 동적 및 정적 서버 커서가 직렬화 가능 트랜잭션 내에서 열린 정적 커서처럼 동작합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-107">One result of this is that keyset, dynamic and static server cursors, when opened within a snapshot transaction context, behave much like static cursors opened within serializable transactions.</span></span> <span data-ttu-id="b061e-108">하지만 스냅샷 격리 수준 하에서 커서를 열면 잠금이 수행되지 않아 서버의 차단을 줄일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-108">However, when the cursors are opened under the snapshot isolation level locks are not taken, which can reduce blocking on the server.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="b061e-109">SQL Server Native Client OLE DB 공급자</span><span class="sxs-lookup"><span data-stu-id="b061e-109">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="b061e-110">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는에 도입 된 스냅숏 격리를 활용 하는 향상 된 기능을 제공 합니다 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="b061e-110">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider has enhancements that take advantage of the snapshot isolation introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span> <span data-ttu-id="b061e-111">이러한 향상된 기능에는 DATASOURCEINFO 및 DBPROPSET_SESSION 속성 집합의 변경 내용이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-111">These enhancements include changes to the DBPROPSET_DATASOURCEINFO and DBPROPSET_SESSION property sets.</span></span>  
  
### <a name="dbpropset_datasourceinfo"></a><span data-ttu-id="b061e-112">DBPROPSET_DATASOURCEINFO</span><span class="sxs-lookup"><span data-stu-id="b061e-112">DBPROPSET_DATASOURCEINFO</span></span>  
 <span data-ttu-id="b061e-113">DBPROPSET_DATASOURCEINFO 속성 집합은 DBPROP_SUPPORTEDTXNISOLEVELS 속성에 사용되는 DBPROPVAL_TI_SNAPSHOT 값을 추가하여 스냅샷 격리 수준이 지원됨을 나타내도록 변경되었습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-113">The DBPROPSET_DATASOURCEINFO property set has been changed to indicate that the snapshot isolation level is supported by the addition of the DBPROPVAL_TI_SNAPSHOT value that is used in the DBPROP_SUPPORTEDTXNISOLEVELS property.</span></span> <span data-ttu-id="b061e-114">이 새로운 값은 데이터베이스에 버전 관리가 설정되어 있는지 여부에 관계없이 스냅샷 격리 수준이 지원됨을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-114">This new value indicates that the snapshot isolation level is supported whether or not versioning has been enabled on the database.</span></span> <span data-ttu-id="b061e-115">다음은 DBPROP_SUPPORTEDTXNISOLEVELS 값의 목록입니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-115">The following is a list of the DBPROP_SUPPORTEDTXNISOLEVELS values:</span></span>  
  
|<span data-ttu-id="b061e-116">속성 ID</span><span class="sxs-lookup"><span data-stu-id="b061e-116">Property ID</span></span>|<span data-ttu-id="b061e-117">Description</span><span class="sxs-lookup"><span data-stu-id="b061e-117">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="b061e-118">DBPROP_SUPPORTEDTXNISOLEVELS</span><span class="sxs-lookup"><span data-stu-id="b061e-118">DBPROP_SUPPORTEDTXNISOLEVELS</span></span>|<span data-ttu-id="b061e-119">형식: VT_I4</span><span class="sxs-lookup"><span data-stu-id="b061e-119">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="b061e-120">R/W: 읽기 전용</span><span class="sxs-lookup"><span data-stu-id="b061e-120">R/W: Read only</span></span><br /><br /> <span data-ttu-id="b061e-121">설명: 지원되는 트랜잭션 격리 수준을 지정하는 비트 마스크입니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-121">Description: A bitmask specifying the supported transaction isolation levels.</span></span> <span data-ttu-id="b061e-122">다음을 0개 이상 조합하여 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-122">A combination of zero or more of the following:</span></span><br /><br /> <span data-ttu-id="b061e-123">-DBPROPVAL_TI_CHAOS</span><span class="sxs-lookup"><span data-stu-id="b061e-123">-   DBPROPVAL_TI_CHAOS</span></span><br /><span data-ttu-id="b061e-124">-DBPROPVAL_TI_READUNCOMMITTED</span><span class="sxs-lookup"><span data-stu-id="b061e-124">-   DBPROPVAL_TI_READUNCOMMITTED</span></span><br /><span data-ttu-id="b061e-125">-DBPROPVAL_TI_BROWSE</span><span class="sxs-lookup"><span data-stu-id="b061e-125">-   DBPROPVAL_TI_BROWSE</span></span><br /><span data-ttu-id="b061e-126">-DBPROPVAL_TI_CURSORSTABILITY</span><span class="sxs-lookup"><span data-stu-id="b061e-126">-   DBPROPVAL_TI_CURSORSTABILITY</span></span><br /><span data-ttu-id="b061e-127">-DBPROPVAL_TI_READCOMMITTED</span><span class="sxs-lookup"><span data-stu-id="b061e-127">-   DBPROPVAL_TI_READCOMMITTED</span></span><br /><span data-ttu-id="b061e-128">-DBPROPVAL_TI_REPEATABLEREAD</span><span class="sxs-lookup"><span data-stu-id="b061e-128">-   DBPROPVAL_TI_REPEATABLEREAD</span></span><br /><span data-ttu-id="b061e-129">-DBPROPVAL_TI_SERIALIZABLE</span><span class="sxs-lookup"><span data-stu-id="b061e-129">-   DBPROPVAL_TI_SERIALIZABLE</span></span><br /><span data-ttu-id="b061e-130">-DBPROPVAL_TI_ISOLATED</span><span class="sxs-lookup"><span data-stu-id="b061e-130">-   DBPROPVAL_TI_ISOLATED</span></span><br /><span data-ttu-id="b061e-131">-DBPROPVAL_TI_SNAPSHOT</span><span class="sxs-lookup"><span data-stu-id="b061e-131">-   DBPROPVAL_TI_SNAPSHOT</span></span>|  
  
### <a name="dbpropset_session"></a><span data-ttu-id="b061e-132">DBPROPSET_SESSION</span><span class="sxs-lookup"><span data-stu-id="b061e-132">DBPROPSET_SESSION</span></span>  
 <span data-ttu-id="b061e-133">DBPROPSET_SESSION 속성 집합은 DBPROP_SESS_AUTOCOMMITISOLEVELS 속성에 사용되는 DBPROPVAL_TI_SNAPSHOT 값을 추가하여 스냅샷 격리 수준이 지원됨을 나타내도록 변경되었습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-133">The DBPROPSET_SESSION property set has been changed to indicate that the snapshot isolation level is supported by the addition of the DBPROPVAL_TI_SNAPSHOT value that is used in the DBPROP_SESS_AUTOCOMMITISOLEVELS property.</span></span> <span data-ttu-id="b061e-134">이 새로운 값은 데이터베이스에 버전 관리가 설정되어 있는지 여부에 관계없이 스냅샷 격리 수준이 지원됨을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-134">This new value indicates that the snapshot isolation level is supported whether or not versioning has been enabled on the database.</span></span> <span data-ttu-id="b061e-135">다음은 DBPROP_SESS_AUTOCOMMITISOLEVELS 값의 목록입니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-135">The following is a list of the DBPROP_SESS_AUTOCOMMITISOLEVELS values:</span></span>  
  
|<span data-ttu-id="b061e-136">속성 ID</span><span class="sxs-lookup"><span data-stu-id="b061e-136">Property ID</span></span>|<span data-ttu-id="b061e-137">Description</span><span class="sxs-lookup"><span data-stu-id="b061e-137">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="b061e-138">DBPROP_SESS_AUTOCOMMITISOLEVELS</span><span class="sxs-lookup"><span data-stu-id="b061e-138">DBPROP_SESS_AUTOCOMMITISOLEVELS</span></span>|<span data-ttu-id="b061e-139">형식: VT_I4</span><span class="sxs-lookup"><span data-stu-id="b061e-139">Type: VT_I4</span></span><br /><br /> <span data-ttu-id="b061e-140">R/W: 읽기 전용</span><span class="sxs-lookup"><span data-stu-id="b061e-140">R/W: Read only</span></span><br /><br /> <span data-ttu-id="b061e-141">설명: 자동 커밋 모드에서 트랜잭션 격리 수준을 나타내는 비트 마스크를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-141">Description: Specifies a bitmask that indicates the transaction isolation level while in auto-commit mode.</span></span> <span data-ttu-id="b061e-142">이 비트 마스크에 설정할 수 있는 값은 DBPROP_SUPPORTEDTXNISOLEVELS에 설정할 수 있는 값과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-142">The values that can be set in this bitmask are the same as those that can be set for DBPROP_SUPPORTEDTXNISOLEVELS.</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="b061e-143">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]보다 이전 버전의 [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]를 사용할 때 DBPROPVAL_TI_SNAPSHOT을 설정하면 오류 DB_S_ERRORSOCCURRED 또는 DB_E_ERRORSOCCURRED가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-143">The errors DB_S_ERRORSOCCURRED or DB_E_ERRORSOCCURRED will occur if DBPROPVAL_TI_SNAPSHOT is set when using versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] earlier than [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)].</span></span>  
  
 <span data-ttu-id="b061e-144">스냅샷 격리가 트랜잭션에서 지원되는 방법은 [로컬 트랜잭션 지원](../../native-client-ole-db-transactions/transactions.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b061e-144">For information about how snapshot isolation is supported in transactions, see [Supporting Local Transactions](../../native-client-ole-db-transactions/transactions.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="b061e-145">SQL Server Native Client ODBC 드라이버</span><span class="sxs-lookup"><span data-stu-id="b061e-145">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="b061e-146">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 드라이버는 [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) 및 [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) 함수에 대 한 향상 된 기능을 통해 스냅숏 격리를 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver provides support for snapshot isolation though enhancements made to the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) functions.</span></span>  
  
### <a name="sqlsetconnectattr"></a><span data-ttu-id="b061e-147">SQLSetConnectAttr</span><span class="sxs-lookup"><span data-stu-id="b061e-147">SQLSetConnectAttr</span></span>  
 <span data-ttu-id="b061e-148">**SQLSetConnectAttr** 함수는 이제 SQL_COPT_SS_TXN_ISOLATION 특성의 사용을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-148">The **SQLSetConnectAttr** function now supports the use of the SQL_COPT_SS_TXN_ISOLATION attribute.</span></span> <span data-ttu-id="b061e-149">SQL_COPT_SS_TXN_ISOLATION을 SQL_TXN_SS_SNAPSHOT으로 설정하면 스냅샷 격리 수준에서 트랜잭션이 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-149">Setting SQL_COPT_SS_TXN_ISOLATION to SQL_TXN_SS_SNAPSHOT indicates that the transaction will take place under the snapshot isolation level.</span></span>  
  
### <a name="sqlgetinfo"></a><span data-ttu-id="b061e-150">SQLGetInfo</span><span class="sxs-lookup"><span data-stu-id="b061e-150">SQLGetInfo</span></span>  
 <span data-ttu-id="b061e-151">[SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) 함수는 이제 SQL_TXN_ISOLATION_OPTION info 유형에 추가 된 SQL_TXN_SS_SNAPSHOT 값을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="b061e-151">The [SQLGetInfo](../../native-client-odbc-api/sqlgetinfo.md) function now supports the SQL_TXN_SS_SNAPSHOT value that has been added to the SQL_TXN_ISOLATION_OPTION info type.</span></span>  
  
 <span data-ttu-id="b061e-152">트랜잭션에서 스냅숏 격리가 지원 되는 방법에 대 한 자세한 내용은 [커서 트랜잭션 격리 수준](../../native-client-odbc-cursors/properties/cursor-transaction-isolation-level.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="b061e-152">For information about how snapshot isolation is supported in transactions, see [Cursor Transaction Isolation Level](../../native-client-odbc-cursors/properties/cursor-transaction-isolation-level.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b061e-153">참고 항목</span><span class="sxs-lookup"><span data-stu-id="b061e-153">See Also</span></span>  
 <span data-ttu-id="b061e-154">[SQL Server Native Client 기능](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="b061e-154">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 [<span data-ttu-id="b061e-155">행 집합 속성 및 동작</span><span class="sxs-lookup"><span data-stu-id="b061e-155">Rowset Properties and Behaviors</span></span>](../../native-client-ole-db-rowsets/rowset-properties-and-behaviors.md)  
  
  
