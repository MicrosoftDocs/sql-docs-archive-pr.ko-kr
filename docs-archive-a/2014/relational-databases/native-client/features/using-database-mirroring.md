---
title: 데이터베이스 미러링 사용 | Microsoft Docs
ms.custom: ''
ms.date: 03/08/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- database mirroring [SQL Server], interoperability
- SQL Server Native Client, database mirroring
- data access [SQL Server Native Client], database mirroring
- database mirroring [SQL Server], connecting clients to
- SQLNCLI, database mirroring
- SQL Server Native Client ODBC driver, database mirroring
- SQL Server Native Client OLE DB provider, database mirroring
ms.assetid: 71b15712-7972-4465-9274-e0ddc271eedc
author: rothja
ms.author: jroth
ms.openlocfilehash: 389036322137abcc9a40e36c697e8d45e39a7de5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87647653"
---
# <a name="using-database-mirroring"></a><span data-ttu-id="8f6e8-102">데이터베이스 미러링 사용</span><span class="sxs-lookup"><span data-stu-id="8f6e8-102">Using Database Mirroring</span></span>
    
> [!NOTE]  
>  [!INCLUDE[ssNoteDepFutureAvoid](../../../includes/ssnotedepfutureavoid-md.md)]<span data-ttu-id="8f6e8-103">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)]을 대신 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-103">Use [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] instead.</span></span>  
  
 <span data-ttu-id="8f6e8-104">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)]에 도입된 데이터베이스 미러링은 데이터베이스 가용성과 데이터 중복을 높이는 솔루션입니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-104">Database mirroring, introduced in [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)], is a solution for increasing database availability and data redundancy.</span></span> [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]<span data-ttu-id="8f6e8-105">Native Client는 데이터베이스 미러링을 암시적으로 지원 하므로 개발자는 데이터베이스에 대해 구성 된 후 코드를 작성 하거나 다른 작업을 수행할 필요가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-105">Native Client provides implicit support for database mirroring, so the developer does not need to write any code or take any other action once it has been configured for the database.</span></span>  
  
 <span data-ttu-id="8f6e8-106">데이터베이스 단위로 구현되는 데이터베이스 미러링은 대기 서버에 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 프로덕션 데이터베이스의 복사본을 보관합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-106">Database mirroring, which is implemented on a per-database basis, keeps a copy of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] production database on a standby server.</span></span> <span data-ttu-id="8f6e8-107">이 서버는 데이터베이스 미러링 세션의 구성 및 상태에 따라 핫 대기 서버나 웜 대기 서버가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-107">This server is either a hot or warm standby server, depending on the configuration and state of the database mirroring session.</span></span> <span data-ttu-id="8f6e8-108">핫 대기 서버는 커밋된 트랜잭션이 손실되지 않는 신속한 장애 조치(Failover)를 지원하며, 웜 대기 서버는 강제 서비스(데이터 손실 가능성이 있음)를 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-108">A hot standby server supports rapid failover with no loss of committed transactions, and a warm standby server supports forcing service (with possible data loss).</span></span>  
  
 <span data-ttu-id="8f6e8-109">프로덕션 데이터베이스는 *주 데이터베이스*라고 하며, 대기 복사본은 *미러 데이터베이스*라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-109">The production database is called the *principal database*, and the standby copy is called the *mirror database*.</span></span> <span data-ttu-id="8f6e8-110">주 데이터베이스 및 미러 데이터베이스는 별도의 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 인스턴스(서버 인스턴스)에 상주해야 하며 가능한 한 상주하는 컴퓨터도 달라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-110">The principal database and mirror database must reside on separate instances of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] (server instances), and they should reside on separate computers if possible.</span></span>  
  
 <span data-ttu-id="8f6e8-111">*주 서버*라고 하는 프로덕션 서버 인스턴스는 *미러 서버*라고 하는 대기 서버 인스턴스와 통신합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-111">The production server instance, called the *principal server*, communicates with the standby server instance, called the *mirror server*.</span></span> <span data-ttu-id="8f6e8-112">주 서버와 미러 서버는 데이터베이스 미러링 *세션*내에서 파트너로 작동 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-112">The principal and mirror servers act as partners within a database mirroring *session*.</span></span> <span data-ttu-id="8f6e8-113">주 서버가 실패하면 미러 서버가 *장애 조치(failover)* 라는 프로세스를 통해 자신의 데이터베이스를 주 데이터베이스로 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-113">If the principal server fails, the mirror server can make its database into the principal database through a process called *failover*.</span></span> <span data-ttu-id="8f6e8-114">예를 들어 서로 파트너 관계인 Partner_A와 Partner_B 서버가 있는데, 처음에 주 데이터베이스는 주 서버인 Partner_A에 상주하고 미러 데이터베이스는 미러 서버인 Partner_B에 상주한다고 가정합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-114">For example, Partner_A and Partner_B are two partner servers, with the principal database initially on Partner_A as principal server, and the mirror database residing on Partner_B as the mirror server.</span></span> <span data-ttu-id="8f6e8-115">Partner_A가 오프라인이 된 경우 Partner_B에 있는 데이터베이스가 장애 조치(Failover)되어 현재 주 데이터베이스가 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-115">If Partner_A goes offline, the database on Partner_B can fail over to become the current principal database.</span></span> <span data-ttu-id="8f6e8-116">Partner_A가 미러링 세션에 다시 참여하면 Partner_A는 미러 서버가 되고 그 데이터베이스가 미러 데이터베이스가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-116">When Partner_A rejoins the mirroring session, it becomes the mirror server and its database becomes the mirror database.</span></span>  
  
 <span data-ttu-id="8f6e8-117">대체 데이터베이스 미러링 구성은 성능 및 데이터 안전 수준이 다르며 지원되는 장애 조치(Failover) 형태도 다릅니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-117">Alternative database mirroring configurations offer different levels of performance and data safety, and support different forms of failover.</span></span> <span data-ttu-id="8f6e8-118">자세한 내용은 [데이터베이스 미러링&#40;SQL Server&#41;](../../../database-engine/database-mirroring/database-mirroring-sql-server.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-118">For more information, see [Database Mirroring &#40;SQL Server&#41;](../../../database-engine/database-mirroring/database-mirroring-sql-server.md).</span></span>  
  
 <span data-ttu-id="8f6e8-119">미러 데이터베이스 이름을 지정할 때 별칭을 사용할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-119">It is possible to use an alias when specifying the mirror database name.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f6e8-120">미러링된 데이터베이스에 대한 초기 연결 시도 및 재연결 시도에 대한 자세한 내용은 [데이터베이스 미러링 세션에 클라이언트 연결&#40;SQL Server&#41;](../../../database-engine/database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-120">For information about initial connection attempts and reconnection attempts to a mirrored database, see [Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](../../../database-engine/database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md).</span></span>  
  
## <a name="programming-considerations"></a><span data-ttu-id="8f6e8-121">프로그래밍 고려 사항</span><span class="sxs-lookup"><span data-stu-id="8f6e8-121">Programming Considerations</span></span>  
 <span data-ttu-id="8f6e8-122">주 데이터베이스 서버가 실패하면 클라이언트 애플리케이션에서 API 호출에 대한 응답으로 오류를 받게 되는데, 이는 데이터베이스 연결이 끊어졌다는 의미입니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-122">When the principal database server fails, the client application receives errors in response to API calls, which indicate that the connection to the database has been lost.</span></span> <span data-ttu-id="8f6e8-123">이러한 경우 커밋되지 않은 데이터베이스 변경 내용이 손실되고 현재 트랜잭션은 롤백됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-123">When this happens, any uncommitted changes to the database are lost and the current transaction is rolled back.</span></span> <span data-ttu-id="8f6e8-124">또한 애플리케이션에서는 연결을 종료하거나 데이터 원본 개체를 해제한 후 다시 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-124">If this occurs, the application should close the connection (or release the data source object) and re-open it.</span></span> <span data-ttu-id="8f6e8-125">이 연결은 이제 주 서버 역할을 수행할 미러 데이터베이스로 투명하게 리디렉션됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-125">The connection is transparently re-directed to the mirror database, which now acts as the principal server.</span></span>  
  
 <span data-ttu-id="8f6e8-126">연결이 설정되면 주 서버는 장애 조치(Failover) 파트너의 ID를 장애 조치(Failover) 시 사용할 클라이언트로 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-126">When a connection is established, the principal server sends the identity of its failover partner to the client to be used when failover occurs.</span></span> <span data-ttu-id="8f6e8-127">애플리케이션이 실패한 주 서버에 연결하려는 경우 클라이언트는 장애 조치(Failover) 파트너의 ID를 모릅니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-127">Where an application tried to establish a connection after the principal server failed, the client does not know the identity of the failover partner.</span></span> <span data-ttu-id="8f6e8-128">클라이언트는 초기화 속성 및 이와 관련된 연결 문자열 키워드를 사용하여 직접 장애 조치(Failover) 파트너의 ID를 지정함으로써 이러한 시나리오에 대처할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-128">To allow clients the opportunity to cope with this scenario, an initialization property and an associated connection string keyword allow the client to specify the identity of the failover partner on its own.</span></span> <span data-ttu-id="8f6e8-129">클라이언트 특성은 이 시나리오에서만 사용되며 주 서버를 사용할 수 있는 경우에는 사용되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-129">The client attribute is used only in this scenario; if the principal server is available, it is not used.</span></span> <span data-ttu-id="8f6e8-130">클라이언트가 제공한 장애 조치(Failover) 파트너 서버가 장애 조치(Failover) 파트너 역할을 하는 서버를 참조하지 않는 경우 해당 서버에서 연결을 거부합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-130">If the failover partner server supplied by the client does not refer to a server acting as a failover partner, the connection is refused by the server.</span></span> <span data-ttu-id="8f6e8-131">연결이 설정된 후 특성을 조사하여 실제 장애 조치(Failover) 파트너의 ID를 확인하면 애플리케이션에 구성 변경 내용을 적용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-131">To allow applications to adapt to configuration changes, the identity of the actual failover partner can be determined by inspecting the attribute after the connection has been established.</span></span> <span data-ttu-id="8f6e8-132">첫 번째 연결 시도가 실패한 경우에는 파트너 정보를 캐싱하여 연결 문자열을 업데이트하거나 재시도 전략을 세우는 방법을 고려해 보십시오.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-132">You should consider caching the partner information to update the connection string or devise a retry strategy in the event that the first attempt at making a connection fails.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f6e8-133">이 기능을 DSN, 연결 문자열 또는 연결 속성/특성에서 사용하려는 경우에는 연결에 사용할 데이터베이스를 명시적으로 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-133">You must explicitly specify the database to be used by a connection if you want to use this feature in a DSN, connection string, or connection property/attribute.</span></span> <span data-ttu-id="8f6e8-134">그렇지 않으면 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client가 파트너 데이터베이스에 장애 조치(Failover)를 시도하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client will not attempt to failover to the partner database if this is not done.</span></span>  
>   
>  <span data-ttu-id="8f6e8-135">미러링은 데이터베이스의 기능입니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-135">Mirroring is a feature of the database.</span></span> <span data-ttu-id="8f6e8-136">여러 데이터베이스를 사용하는 애플리케이션에서는 이 기능을 이용하지 못할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-136">Applications that use multiple databases might not be able to exploit this feature.</span></span>  
>   
>  <span data-ttu-id="8f6e8-137">또한 서버 이름은 대/소문자를 구분하지 않지만 데이터베이스 이름은 대/소문자를 구분합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-137">In addition, server names are case insensitive, but database names are case sensitive.</span></span> <span data-ttu-id="8f6e8-138">따라서 DSN 및 연결 문자열에서 동일한 대/소문자 조합을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-138">You should therefore make sure that you use the same casing in DSNs and connection strings.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="8f6e8-139">SQL Server Native Client OLE DB 공급자</span><span class="sxs-lookup"><span data-stu-id="8f6e8-139">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="8f6e8-140">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 연결 및 연결 문자열 특성을 통해 데이터베이스 미러링을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-140">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider supports database mirroring through connection and connection string attributes.</span></span> <span data-ttu-id="8f6e8-141">DBPROPSET_SQLSERVERDBINIT 속성 집합에 SSPROP_INIT_FAILOVERPARTNER 속성이 추가되었으며 DBPROP_INIT_PROVIDERSTRING의 새로운 연결 문자열 특성으로 `FailoverPartner` 키워드가 추가되었습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-141">The SSPROP_INIT_FAILOVERPARTNER property has been added to the DBPROPSET_SQLSERVERDBINIT property set, and the `FailoverPartner` keyword is a new connection string attribute for DBPROP_INIT_PROVIDERSTRING.</span></span> <span data-ttu-id="8f6e8-142">자세한 내용은 [SQL Server Native Client 연결 문자열 키워드 사용](../applications/using-connection-string-keywords-with-sql-server-native-client.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-142">For more information, see [Using Connection String Keywords with SQL Server Native Client](../applications/using-connection-string-keywords-with-sql-server-native-client.md).</span></span>  
  
 <span data-ttu-id="8f6e8-143">**CoUninitialize** 가 호출 될 때까지 또는 응용 프로그램에 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 데이터 원본 개체와 같은 Native Client OLE DB 공급자가 관리 하는 일부 개체에 대 한 참조가 있는 경우에만 장애 조치 (failover) 캐시가 유지 됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-143">The failover cache is maintained as long as the provider is loaded, which is until **CoUninitialize** is called or as long as the application has a reference to some object managed by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider such as a data source object.</span></span>  
  
 <span data-ttu-id="8f6e8-144">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자의 데이터베이스 미러링 지원에 대 한 자세한 내용은 [초기화 및 권한 부여 속성](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-144">For details about [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for database mirroring, see [Initialization and Authorization Properties](../../native-client-ole-db-data-source-objects/initialization-and-authorization-properties.md).</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="8f6e8-145">SQL Server Native Client ODBC 드라이버</span><span class="sxs-lookup"><span data-stu-id="8f6e8-145">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="8f6e8-146">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT ODBC 드라이버는 연결 및 연결 문자열 특성을 통해 데이터베이스 미러링을 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-146">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports database mirroring through connection and connection string attributes.</span></span> <span data-ttu-id="8f6e8-147">특히 SQL_COPT_SS_FAILOVER_PARTNER 특성은 [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) 및 [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) 함수에 사용할 수 있도록 추가 되었습니다. 그리고 `Failover_Partner` 키워드가 새 연결 문자열 특성으로 추가 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-147">Specifically, the SQL_COPT_SS_FAILOVER_PARTNER attribute has been added for use with the [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) and [SQLGetConnectAttr](../../native-client-odbc-api/sqlgetconnectattr.md) functions; and the `Failover_Partner` keyword has been added as a new connection string attribute.</span></span>  
  
 <span data-ttu-id="8f6e8-148">장애 조치(Failover) 캐시는 애플리케이션에 한 개 이상의 환경 핸들이 할당되어 있는 동안 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-148">The failover cache is maintained as long as the application has at least one environment handle allocated.</span></span> <span data-ttu-id="8f6e8-149">반대로 마지막 환경 핸들의 할당이 취소되면 장애 조치(Failover) 캐시가 손실됩니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-149">Conversely, it is lost when the last environment handle is deallocated.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="8f6e8-150">ODBC 드라이버 관리자는 장애 조치(Failover) 서버 이름의 사양을 지원하도록 향상되었습니다.</span><span class="sxs-lookup"><span data-stu-id="8f6e8-150">The ODBC Driver Manager has been enhanced to support the specification of the failover server name.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8f6e8-151">참고 항목</span><span class="sxs-lookup"><span data-stu-id="8f6e8-151">See Also</span></span>  
 <span data-ttu-id="8f6e8-152">[SQL Server Native Client 기능](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="8f6e8-152">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="8f6e8-153">[데이터베이스 미러링 세션에 클라이언트 연결&#40;SQL Server&#41;](../../../database-engine/database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="8f6e8-153">[Connect Clients to a Database Mirroring Session &#40;SQL Server&#41;](../../../database-engine/database-mirroring/connect-clients-to-a-database-mirroring-session-sql-server.md) </span></span>  
 [<span data-ttu-id="8f6e8-154">데이터베이스 미러링&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="8f6e8-154">Database Mirroring &#40;SQL Server&#41;</span></span>](../../../database-engine/database-mirroring/database-mirroring-sql-server.md)  
  
  
