---
title: 대량 복사 작업 수행 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- bulk copy [SQL Server Native Client]
- data access [SQL Server Native Client], bulk copy operations
- SQL Server Native Client, bulk copy operations
- SQLNCLI, bulk copy operations
ms.assetid: 50d8456b-e6a1-4b25-bc7e-56946ed654a7
author: rothja
ms.author: jroth
ms.openlocfilehash: 51a4cd3ebd4cb2e16baa75a268bf307a549a694b
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87647665"
---
# <a name="performing-bulk-copy-operations"></a><span data-ttu-id="d9d3c-102">대량 복사 작업 수행</span><span class="sxs-lookup"><span data-stu-id="d9d3c-102">Performing Bulk Copy Operations</span></span>
  <span data-ttu-id="d9d3c-103">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 대량 복사 기능은 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 테이블 또는 뷰와의 대량 데이터 전송을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-103">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy feature supports the transfer of large amounts of data into or out of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table or view.</span></span> <span data-ttu-id="d9d3c-104">SELECT 문을 지정하여 데이터를 전송할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-104">Data can also be transferred out by specifying a SELECT statement.</span></span> <span data-ttu-id="d9d3c-105">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 및 ASCII 파일과 같은 운영 체제 데이터 파일 간에 데이터를 이동할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-105">The data can be moved between [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and an operating-system data file, such as an ASCII file.</span></span> <span data-ttu-id="d9d3c-106">데이터 파일은 다른 형식을 가질 수 있습니다. 형식은 형식 파일에서 대량 복사로 정의됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-106">The data file can have different formats; the format is defined to bulk copy in a format file.</span></span> <span data-ttu-id="d9d3c-107">필요에 따라 데이터를 프로그램 변수로 로드하고 대량 복사 함수와 메서드를 사용하여 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]로 전송할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-107">Optionally, data can be loaded into program variables and transferred to [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] using bulk copy functions and methods.</span></span>  
  
 <span data-ttu-id="d9d3c-108">이 기능을 보여 주는 샘플 애플리케이션은 [IRowsetFastLoad를 사용하여 데이터 대량 복사&#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-108">For a sample application that demonstrates this feature, see [Bulk Copy Data Using IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md).</span></span>  
  
 <span data-ttu-id="d9d3c-109">애플리케이션은 보통 다음 두 가지 방법 중 하나로 대량 복사를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-109">An application typically uses bulk copy in one of the following ways:</span></span>  
  
-   <span data-ttu-id="d9d3c-110">Transact-SQL 문의 테이블, 뷰 또는 결과 집합에서 데이터가 테이블 또는 뷰와 동일한 형식으로 저장되는 데이터 파일로 대량 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-110">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in the same format as the table or view.</span></span>  
  
     <span data-ttu-id="d9d3c-111">이것을 기본 모드 데이터 파일이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-111">This is called a native-mode data file.</span></span>  
  
-   <span data-ttu-id="d9d3c-112">Transact-SQL 문의 테이블, 뷰 또는 결과 집합에서 데이터가 테이블 또는 뷰 중 하나와 다른 형식으로 저장되는 데이터 파일로 대량 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-112">Bulk copy from a table, view, or the result set of a Transact-SQL statement into a data file where the data is stored in a format other than the one of the table or view.</span></span>  
  
     <span data-ttu-id="d9d3c-113">이 경우 데이터 파일에 저장되는 각 열의 특징(데이터 형식, 위치, 길이, 종결자 등)을 정의하는 별도의 형식 파일이 만들어집니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-113">In this case, a separate format file is created that defines the characteristics (data type, position, length, terminator, and so on) of each column as it is stored in the data file.</span></span> <span data-ttu-id="d9d3c-114">모든 열이 문자 형식으로 변환된 경우 결과 파일을 문자 모드 데이터 파일이라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-114">If all columns are converted to character format, the resulting file is called a character-mode data file.</span></span>  
  
-   <span data-ttu-id="d9d3c-115">데이터 파일에서 테이블 또는 뷰로 대량 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-115">Bulk copy from a data file into a table or view.</span></span>  
  
     <span data-ttu-id="d9d3c-116">필요한 경우 형식 파일을 사용하여 데이터 파일의 레이아웃을 결정합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-116">If needed, a format file is used to determine the layout of the data file.</span></span>  
  
-   <span data-ttu-id="d9d3c-117">데이터를 프로그램 변수로 로드한 다음 한 번에 한 행씩, 대량 복사하기 위한 대량 복사 함수를 사용하여 데이터를 테이블 또는 뷰로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-117">Load data into program variables, then import the data into a table or view using the bulk copy functions for bulk copying in a row at a time.</span></span>  
  
 <span data-ttu-id="d9d3c-118">다른 대량 복사 프로그램에서 대량 복사 함수에 사용되는 데이터 파일을 만들 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-118">Data files used by bulk copy functions do not have to be created by another bulk copy program.</span></span> <span data-ttu-id="d9d3c-119">대량 복사 정의에 따라 다른 모든 시스템에서 데이터 파일과 형식 파일을 생성할 수 있습니다. 이러한 파일을 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 대량 복사 프로그램과 함께 사용하여 데이터를 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]로 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-119">Any other system can generate a data file and format file according to bulk copy definitions; these files can then be used with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] bulk copy program to import data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d9d3c-120">예를 들어 탭으로 구분된 파일의 스프레드시트에서 데이터를 내보내고, 탭으로 구분된 파일을 설명하는 형식 파일을 작성한 다음 대량 복사 프로그램을 사용하여 신속하게 데이터를 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]로 가져올 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-120">For example, you could export data from a spreadsheet in a tab-delimited file, build a format file describing the tab-delimited file, and then use a bulk copy program to quickly import the data into [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d9d3c-121">대량 복사에서 생성된 데이터 파일을 다른 애플리케이션으로 가져올 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-121">Data files generated by bulk copy can also be imported into other applications.</span></span> <span data-ttu-id="d9d3c-122">예를 들어 대량 복사 함수를 사용하여 테이블 또는 뷰의 데이터를 탭으로 구분된 파일로 내보낸 다음 스프레드시트에 로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-122">For example, you could use bulk copy functions to export data from a table or view into a tab-delimited file that could then be loaded into a spreadsheet.</span></span>  
  
 <span data-ttu-id="d9d3c-123">대량 복사 함수를 사용할 애플리케이션을 코딩하는 프로그래머가 우수한 대량 복사 성능을 얻으려면 일반 규칙을 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-123">Programmers coding applications to use the bulk copy functions should follow the general rules for good bulk copy performance.</span></span> <span data-ttu-id="d9d3c-124">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 대량 복사 작업을 지원하는 방법에 대한 자세한 내용은 [데이터 대량 내보내기 및 가져오기&#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-124">For more information about support for bulk copy operations in [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], see [Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md).</span></span>  
  
## <a name="limitations-and-restrictions"></a><span data-ttu-id="d9d3c-125">제한 사항</span><span class="sxs-lookup"><span data-stu-id="d9d3c-125">Limitations and Restrictions</span></span>  
 <span data-ttu-id="d9d3c-126">CLR UDT(사용자 정의 형식)를 이진 데이터로 바인딩해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-126">A CLR user-defined type (UDT) must be bound as binary data.</span></span> <span data-ttu-id="d9d3c-127">형식 파일에서 SQLCHAR를 대상 UDT 열의 데이터 형식으로 지정하는 경우에도 BCP 유틸리티는 해당 데이터를 이진으로 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-127">Even if a format file specifies SQLCHAR as the data type for a target UDT column, The BCP utility will treat the data as binary.</span></span>  
  
 <span data-ttu-id="d9d3c-128">대량 복사 작업에는 SET FMTONLY OFF를 사용하지 마십시오.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-128">Do not use SET FMTONLY OFF with bulk copy operations.</span></span> <span data-ttu-id="d9d3c-129">SET FMTONLY OFF로 인해 대량 복사 작업이 실패하거나 예기치 않은 결과를 제공할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-129">SET FMTONLY OFF may cause your bulk copy operation to fail or give unexpected results.</span></span>  
  
## <a name="sql-server-native-client-ole-db-provider"></a><span data-ttu-id="d9d3c-130">SQL Server Native Client OLE DB 공급자</span><span class="sxs-lookup"><span data-stu-id="d9d3c-130">SQL Server Native Client OLE DB Provider</span></span>  
 <span data-ttu-id="d9d3c-131">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 데이터베이스를 사용 하 여 대량 복사 작업을 수행 하는 두 가지 메서드를 구현 합니다 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="d9d3c-131">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements two methods for performing bulk copy operations with a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] database.</span></span> <span data-ttu-id="d9d3c-132">첫 번째 방법은 메모리 기반 대량 복사 작업에 [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) 인터페이스를 사용하고 두 번째 방법은 파일 기반 대량 복사 작업에 [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) 인터페이스를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-132">The first method involves using the [IRowsetFastLoad](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) interface for memory-based bulk copy operations; and the second involves using the [IBCPSession](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) interface for file-based bulk copy operations.</span></span>  
  
### <a name="using-memory-based-bulk-copy-operations"></a><span data-ttu-id="d9d3c-133">메모리 기반 대량 복사 작업 사용</span><span class="sxs-lookup"><span data-stu-id="d9d3c-133">Using Memory Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="d9d3c-134">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 **IRowsetFastLoad** 인터페이스를 구현 하 여 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 메모리 기반 대량 복사 작업에 대 한 지원을 노출 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-134">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IRowsetFastLoad** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] memory-based bulk copy operations.</span></span> <span data-ttu-id="d9d3c-135">**IRowsetFastLoad** 인터페이스는 [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) 및 [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) 메서드를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-135">The **IRowsetFastLoad** interface implements the [IRowsetFastLoad::Commit](../../native-client-ole-db-interfaces/irowsetfastload-commit-ole-db.md) and [IRowsetFastLoad::InsertRow](../../native-client-ole-db-interfaces/irowsetfastload-insertrow-ole-db.md) methods.</span></span>  
  
#### <a name="enabling-a-session-for-irowsetfastload"></a><span data-ttu-id="d9d3c-136">IRowsetFastLoad에 세션 사용</span><span class="sxs-lookup"><span data-stu-id="d9d3c-136">Enabling a Session for IRowsetFastLoad</span></span>  
 <span data-ttu-id="d9d3c-137">소비자는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자별 데이터 원본 속성 SSPROP_ENABLEFASTLOAD를 VARIANT_TRUE로 설정하여 대량 복사가 필요하다는 것을 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자에 알립니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-137">The consumer notifies the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider of its need for bulk copy by setting the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider-specific data source property SSPROP_ENABLEFASTLOAD to VARIANT_TRUE.</span></span> <span data-ttu-id="d9d3c-138">데이터 원본의 속성 집합을 사용하여 소비자는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 세션을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-138">With the property set on the data source, the consumer creates a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session.</span></span> <span data-ttu-id="d9d3c-139">새 세션을 사용하여 소비자는 **IRowsetFastLoad** 인터페이스에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-139">The new session allows consumer access to the **IRowsetFastLoad** interface.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="d9d3c-140">**IDataInitialize** 인터페이스가 데이터 원본 초기화에 사용되는 경우 **IOpenRowset::OpenRowset** 메서드의 *rgPropertySets* 매개 변수에 있는 SSPROP_IRowsetFastLoad 속성을 설정해야 합니다. 그렇지 않으면 **OpenRowset** 메서드를 호출할 때 E_NOINTERFACE가 반환됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-140">If the **IDataInitialize** interface is used for initializing the data source, then it is necessary to set the SSPROP_IRowsetFastLoad property in the *rgPropertySets* parameter of the **IOpenRowset::OpenRowset** method; otherwise, the call to the **OpenRowset** method will return E_NOINTERFACE.</span></span>  
  
 <span data-ttu-id="d9d3c-141">대량 복사에 세션을 사용하면 세션의 인터페이스에 대한 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 지원이 제한됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-141">Enabling a session for bulk copy constrains the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider support for interfaces on the session.</span></span> <span data-ttu-id="d9d3c-142">대량 복사 사용 세션은 다음과 같은 인터페이스만 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-142">A bulk copy-enabled session exposes only the following interfaces:</span></span>  
  
-   <span data-ttu-id="d9d3c-143">**IDBSchemaRowset**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-143">**IDBSchemaRowset**</span></span>  
  
-   <span data-ttu-id="d9d3c-144">**IGetDataSource**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-144">**IGetDataSource**</span></span>  
  
-   <span data-ttu-id="d9d3c-145">**IOpenRowset**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-145">**IOpenRowset**</span></span>  
  
-   <span data-ttu-id="d9d3c-146">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-146">**ISupportErrorInfo**</span></span>  
  
-   <span data-ttu-id="d9d3c-147">**ITransactionJoin**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-147">**ITransactionJoin**</span></span>  
  
 <span data-ttu-id="d9d3c-148">대량 복사 사용 행 집합을 만들지 않고 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 세션이 표준 처리로 돌아가게 하려면 SSPROP_ENABLEFASTLOAD를 VARIANT_FALSE로 다시 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-148">To disable the creation of bulk copy-enabled rowsets and cause the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider session to revert to standard processing, reset SSPROP_ENABLEFASTLOAD to VARIANT_FALSE.</span></span>  
  
#### <a name="irowsetfastload-rowsets"></a><span data-ttu-id="d9d3c-149">IRowsetFastLoad 행 집합</span><span class="sxs-lookup"><span data-stu-id="d9d3c-149">IRowsetFastLoad Rowsets</span></span>  
 <span data-ttu-id="d9d3c-150">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 대량 복사 행 집합은 쓰기 전용이지만 소비자가 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 테이블의 구조를 결정할 수 있도록 하는 인터페이스를 노출합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-150">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk copy rowsets are write-only, but they expose interfaces that allow the consumer to determine the structure of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table.</span></span> <span data-ttu-id="d9d3c-151">대량 복사 사용 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 행 집합에는 다음과 같은 인터페이스가 노출됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-151">The following interfaces are exposed on a bulk copy-enabled [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider rowset:</span></span>  
  
-   <span data-ttu-id="d9d3c-152">**IAccessor**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-152">**IAccessor**</span></span>  
  
-   <span data-ttu-id="d9d3c-153">**IColumnsInfo**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-153">**IColumnsInfo**</span></span>  
  
-   <span data-ttu-id="d9d3c-154">**IColumnsRowset**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-154">**IColumnsRowset**</span></span>  
  
-   <span data-ttu-id="d9d3c-155">**IConvertType**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-155">**IConvertType**</span></span>  
  
-   <span data-ttu-id="d9d3c-156">**IRowsetFastLoad**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-156">**IRowsetFastLoad**</span></span>  
  
-   <span data-ttu-id="d9d3c-157">**IRowsetInfo**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-157">**IRowsetInfo**</span></span>  
  
-   <span data-ttu-id="d9d3c-158">**ISupportErrorInfo**</span><span class="sxs-lookup"><span data-stu-id="d9d3c-158">**ISupportErrorInfo**</span></span>  
  
 <span data-ttu-id="d9d3c-159">공급자별 속성 SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS 및 SSPROP_FASTLOADKEEPIDENTITY는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 대량 복사 행 집합의 동작을 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-159">The provider-specific properties SSPROP_FASTLOADOPTIONS, SSPROP_FASTLOADKEEPNULLS, and SSPROP_FASTLOADKEEPIDENTITY control behaviors of a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider bulk-copy rowset.</span></span> <span data-ttu-id="d9d3c-160">속성은 _rgPropertySets_**iopenrowset**매개 변수 멤버의 *rgProperties* 멤버에 지정 됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-160">The properties are specified in the *rgProperties* member of an _rgPropertySets_**IOpenRowset**parameter member.</span></span>  
  
|<span data-ttu-id="d9d3c-161">속성 ID</span><span class="sxs-lookup"><span data-stu-id="d9d3c-161">Property ID</span></span>|<span data-ttu-id="d9d3c-162">Description</span><span class="sxs-lookup"><span data-stu-id="d9d3c-162">Description</span></span>|  
|-----------------|-----------------|  
|<span data-ttu-id="d9d3c-163">SSPROP_FASTLOADKEEPIDENTITY</span><span class="sxs-lookup"><span data-stu-id="d9d3c-163">SSPROP_FASTLOADKEEPIDENTITY</span></span>|<span data-ttu-id="d9d3c-164">열: 예</span><span class="sxs-lookup"><span data-stu-id="d9d3c-164">Column: No</span></span><br /><br /> <span data-ttu-id="d9d3c-165">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="d9d3c-165">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="d9d3c-166">유형: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="d9d3c-166">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="d9d3c-167">Default: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="d9d3c-167">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="d9d3c-168">설명: 소비자가 제공한 ID 값을 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-168">Description: Maintains identity values supplied by the consumer.</span></span><br /><br /> <span data-ttu-id="d9d3c-169">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 테이블에 있는 ID 열의 값은 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-169">VARIANT_FALSE: Values for an identity column in the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] table are generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="d9d3c-170">Native Client OLE DB 공급자는 열에 바인딩되는 모든 값을 무시 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-170">Any value bound for the column is ignored by the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider.</span></span><br /><br /> <span data-ttu-id="d9d3c-171">VARIANT_TRUE: 소비자는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ID 열의 값을 제공하는 접근자를 바인딩합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-171">VARIANT_TRUE: The consumer binds an accessor providing a value for a [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] identity column.</span></span> <span data-ttu-id="d9d3c-172">NULL을 허용하는 열에서는 ID 속성을 사용할 수 없으므로 소비자가 **IRowsetFastLoad::Insert**를 호출할 때마다 고유한 값을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-172">The identity property is not available on columns accepting NULL, so the consumer provides a unique value on each **IRowsetFastLoad::Insert** call.</span></span>|  
|<span data-ttu-id="d9d3c-173">SSPROP_FASTLOADKEEPNULLS</span><span class="sxs-lookup"><span data-stu-id="d9d3c-173">SSPROP_FASTLOADKEEPNULLS</span></span>|<span data-ttu-id="d9d3c-174">열: 예</span><span class="sxs-lookup"><span data-stu-id="d9d3c-174">Column: No</span></span><br /><br /> <span data-ttu-id="d9d3c-175">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="d9d3c-175">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="d9d3c-176">유형: VT_BOOL</span><span class="sxs-lookup"><span data-stu-id="d9d3c-176">Type: VT_BOOL</span></span><br /><br /> <span data-ttu-id="d9d3c-177">Default: VARIANT_FALSE</span><span class="sxs-lookup"><span data-stu-id="d9d3c-177">Default: VARIANT_FALSE</span></span><br /><br /> <span data-ttu-id="d9d3c-178">설명: DEFAULT 제약 조건이 있는 열에 대해 NULL을 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-178">Description: Maintains NULL for columns with a DEFAULT constraint.</span></span> <span data-ttu-id="d9d3c-179">NULL을 허용하고 DEFAULT 제약 조건이 적용된 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 열에만 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-179">Affects only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] columns that accept NULL and have a DEFAULT constraint applied.</span></span><br /><br /> <span data-ttu-id="d9d3c-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 소비자가 열에 대해 NULL이 포함된 행을 삽입하는 경우 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 열의 기본값을 삽입합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-180">VARIANT_FALSE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts the default value for the column when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span><br /><br /> <span data-ttu-id="d9d3c-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB 공급자 소비자가 열에 대해 NULL이 포함된 행을 삽입하는 경우 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 열 값으로 NULL을 삽입합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-181">VARIANT_TRUE: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] inserts NULL for the column value when the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider consumer inserts a row containing NULL for the column.</span></span>|  
|<span data-ttu-id="d9d3c-182">SSPROP_FASTLOADOPTIONS</span><span class="sxs-lookup"><span data-stu-id="d9d3c-182">SSPROP_FASTLOADOPTIONS</span></span>|<span data-ttu-id="d9d3c-183">열: 예</span><span class="sxs-lookup"><span data-stu-id="d9d3c-183">Column: No</span></span><br /><br /> <span data-ttu-id="d9d3c-184">R/W: 읽기/쓰기</span><span class="sxs-lookup"><span data-stu-id="d9d3c-184">R/W: Read/write</span></span><br /><br /> <span data-ttu-id="d9d3c-185">유형: VT_BSTR</span><span class="sxs-lookup"><span data-stu-id="d9d3c-185">Type: VT_BSTR</span></span><br /><br /> <span data-ttu-id="d9d3c-186">기본값: 없음</span><span class="sxs-lookup"><span data-stu-id="d9d3c-186">Default: none</span></span><br /><br /> <span data-ttu-id="d9d3c-187">설명: 이 속성은 **bcp** 유틸리티의 **-h** "*hint*[,...*n*]" 옵션과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-187">Description: This property is the same as the **-h** "*hint*[,...*n*]" option of the **bcp** utility.</span></span> <span data-ttu-id="d9d3c-188">데이터를 테이블로 대량 복사할 때 다음 문자열을 옵션으로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-188">The following string(s) can be used as option(s) in the bulk copying of data into a table.</span></span><br /><br /> <span data-ttu-id="d9d3c-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): 데이터 파일에 있는 데이터의 순서를 정렬합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-189">**ORDER**(*column*[**ASC** &#124; **DESC**][,...*n*]): Sort order of data in the data file.</span></span> <span data-ttu-id="d9d3c-190">로드되는 데이터 파일을 테이블의 클러스터형 인덱스에 따라 정렬하면 대량 복사 성능이 향상됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-190">Bulk copy performance is improved if the data file being loaded is sorted according to the clustered index on the table.</span></span><br /><br /> <span data-ttu-id="d9d3c-191">**ROWS_PER_BATCH** = *bb*: 일괄 처리당 데이터 행 수( *bb*)입니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-191">**ROWS_PER_BATCH** = *bb*: Number of rows of data per batch (as *bb*).</span></span> <span data-ttu-id="d9d3c-192">서버는 *bb*값에 따라 대량 로드를 최적화합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-192">The server optimizes the bulk load according to the value *bb*.</span></span> <span data-ttu-id="d9d3c-193">기본적으로 **ROWS_PER_BATCH**는 알 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-193">By default, **ROWS_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="d9d3c-194">**KILOBYTES_PER_BATCH** = *cc*: 일괄 처리당 데이터의 대략적인 KB 수(cc)입니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-194">**KILOBYTES_PER_BATCH** = *cc*: Number of kilobytes (KB) of data per batch (as cc).</span></span> <span data-ttu-id="d9d3c-195">기본적으로 **KILOBYTES_PER_BATCH**는 알 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-195">By default, **KILOBYTES_PER_BATCH** is unknown.</span></span><br /><br /> <span data-ttu-id="d9d3c-196">**TABLOCK**: 대량 복사 작업이 지속되는 동안 테이블 수준 잠금이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-196">**TABLOCK**: A table-level lock is acquired for the duration of the bulk copy operation.</span></span> <span data-ttu-id="d9d3c-197">대량 복사 작업 동안에만 잠금을 사용하면 테이블의 잠금 경쟁이 줄어들기 때문에 이 옵션을 사용하면 성능이 훨씬 향상됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-197">This option significantly improves performance because holding a lock only for the duration of the bulk copy operation reduces lock contention on the table.</span></span> <span data-ttu-id="d9d3c-198">테이블에 인덱스가 없고 **TABLOCK**이 지정되어 있으면 여러 클라이언트가 동시에 테이블을 로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-198">A table can be loaded by multiple clients concurrently if the table has no indexes and **TABLOCK** is specified.</span></span> <span data-ttu-id="d9d3c-199">기본적으로 잠금 동작은 **table lock on bulk load** 테이블 옵션에 의해 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-199">By default, the locking behavior is determined by the table option **table lock on bulk load**.</span></span><br /><br /> <span data-ttu-id="d9d3c-200">**CHECK_CONSTRAINTS**: 대량 복사 작업 동안 *table_name*의 모든 제약 조건이 확인됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-200">**CHECK_CONSTRAINTS**: Any constraints on *table_name* are checked during the bulk copy operation.</span></span> <span data-ttu-id="d9d3c-201">기본적으로 제약 조건은 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-201">By default, constraints are ignored.</span></span><br /><br /> <span data-ttu-id="d9d3c-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 트리거에 대해 행 버전 관리를 사용하고 **tempdb**의 버전 저장소에 행 버전을 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-202">**FIRE_TRIGGER**: [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses row versioning for triggers and stores the row versions in the version store in **tempdb**.</span></span> <span data-ttu-id="d9d3c-203">따라서 트리거가 사용되는 경우에도 대량 로깅 최적화를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-203">Therefore, bulk logging optimizations are available even when triggers are enabled.</span></span> <span data-ttu-id="d9d3c-204">트리거를 사용하여 많은 행이 포함된 일괄 처리를 대량 가져오기 전에 **tempdb**의 크기를 확장해야 할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-204">Before bulk importing a batch with a large number of rows with triggers enabled, you may need to expand the size of **tempdb**.</span></span>|  
  
### <a name="using-file-based-bulk-copy-operations"></a><span data-ttu-id="d9d3c-205">파일 기반 대량 복사 작업 사용</span><span class="sxs-lookup"><span data-stu-id="d9d3c-205">Using File Based Bulk Copy Operations</span></span>  
 <span data-ttu-id="d9d3c-206">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native Client OLE DB 공급자는 **IBCPSession** 인터페이스를 구현 하 여 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 파일 기반 대량 복사 작업에 대 한 지원을 노출 합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-206">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client OLE DB provider implements the **IBCPSession** interface to expose support for [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] file-based bulk copy operations.</span></span> <span data-ttu-id="d9d3c-207">**IBCPSession** 인터페이스는 [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md) 및 [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md) 메서드를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-207">The **IBCPSession** interface implements the [IBCPSession::BCPColFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpcolfmt-ole-db.md), [IBCPSession::BCPColumns](../../native-client-ole-db-interfaces/ibcpsession-bcpcolumns-ole-db.md), [IBCPSession::BCPControl](../../native-client-ole-db-interfaces/ibcpsession-bcpcontrol-ole-db.md), [IBCPSession::BCPDone](../../native-client-ole-db-interfaces/ibcpsession-bcpdone-ole-db.md), [IBCPSession::BCPExec](../../native-client-ole-db-interfaces/ibcpsession-bcpexec-ole-db.md), [IBCPSession::BCPInit](../../native-client-ole-db-interfaces/ibcpsession-bcpinit-ole-db.md), [IBCPSession::BCPReadFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpreadfmt-ole-db.md), and [IBCPSession::BCPWriteFmt](../../native-client-ole-db-interfaces/ibcpsession-bcpwritefmt-ole-db.md)methods.</span></span>  
  
## <a name="sql-server-native-client-odbc-driver"></a><span data-ttu-id="d9d3c-208">SQL Server Native Client ODBC 드라이버</span><span class="sxs-lookup"><span data-stu-id="d9d3c-208">SQL Server Native Client ODBC Driver</span></span>  
 <span data-ttu-id="d9d3c-209">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 드라이버는 이전 버전의 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC 드라이버에 포함된 대량 복사 작업에 대해 동일한 지원을 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-209">The [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver maintains the same support for bulk copy operations that were part of previous versions of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] ODBC driver.</span></span> <span data-ttu-id="d9d3c-210">Native Client ODBC 드라이버를 사용 하는 대량 복사 작업에 대 한 자세한 내용은 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] [odbc&#41;&#40;대량 복사 작업 수행 ](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md)을 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="d9d3c-210">For information about bulk copy operations using the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, see [Performing Bulk Copy Operations &#40;ODBC&#41;](../../native-client-odbc-bulk-copy-operations/performing-bulk-copy-operations-odbc.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d9d3c-211">참고 항목</span><span class="sxs-lookup"><span data-stu-id="d9d3c-211">See Also</span></span>  
 <span data-ttu-id="d9d3c-212">[SQL Server Native Client 기능](sql-server-native-client-features.md) </span><span class="sxs-lookup"><span data-stu-id="d9d3c-212">[SQL Server Native Client Features](sql-server-native-client-features.md) </span></span>  
 <span data-ttu-id="d9d3c-213">[데이터 원본 속성&#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="d9d3c-213">[Data Source Properties &#40;OLE DB&#41;](../../native-client-ole-db-data-source-objects/data-source-properties-ole-db.md) </span></span>  
 <span data-ttu-id="d9d3c-214">[데이터 대량 가져오기 및 내보내기&#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="d9d3c-214">[Bulk Import and Export of Data &#40;SQL Server&#41;](../../import-export/bulk-import-and-export-of-data-sql-server.md) </span></span>  
 <span data-ttu-id="d9d3c-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="d9d3c-215">[IRowsetFastLoad &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/irowsetfastload-ole-db.md) </span></span>  
 <span data-ttu-id="d9d3c-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span><span class="sxs-lookup"><span data-stu-id="d9d3c-216">[IBCPSession &#40;OLE DB&#41;](../../native-client-ole-db-interfaces/ibcpsession-ole-db.md) </span></span>  
 <span data-ttu-id="d9d3c-217">[대량 가져오기 성능 최적화](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span><span class="sxs-lookup"><span data-stu-id="d9d3c-217">[Optimizing Bulk Import Performance](https://msdn.microsoft.com/library/ms190421\(SQL.105\).aspx)</span></span>  
  
  
