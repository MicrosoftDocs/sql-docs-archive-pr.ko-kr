---
title: 암호화 사용 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: ''
ms.topic: reference
helpviewer_keywords:
- database master key [SMO]
- cryptography [SMO]
- cryptography [SQL Server], SMO
- encryption keys [SMO]
- encryption [SQL Server], SMO
- encryption [SMO]
- certificates [SMO]
- service master key [SMO]
ms.assetid: 405e0ed7-50a9-430e-a343-471f54b4af76
author: stevestein
ms.author: sstein
ms.openlocfilehash: 1f1f7d6a8714deb1317562dce669fa0e7adbd45c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87659906"
---
# <a name="using-encryption"></a><span data-ttu-id="39ad6-102">암호화 사용</span><span class="sxs-lookup"><span data-stu-id="39ad6-102">Using Encryption</span></span>
  <span data-ttu-id="39ad6-103">SMO에서 서비스 마스터 키는 <xref:Microsoft.SqlServer.Management.Smo.ServiceMasterKey> 개체로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-103">In SMO, the service master key is represented by the <xref:Microsoft.SqlServer.Management.Smo.ServiceMasterKey> object.</span></span> <span data-ttu-id="39ad6-104"><xref:Microsoft.SqlServer.Management.Smo.Server.ServiceMasterKey%2A> 개체의 <xref:Microsoft.SqlServer.Management.Smo.Server> 속성에서 참조하며,</span><span class="sxs-lookup"><span data-stu-id="39ad6-104">This is referenced by the <xref:Microsoft.SqlServer.Management.Smo.Server.ServiceMasterKey%2A> property of the <xref:Microsoft.SqlServer.Management.Smo.Server> object.</span></span> <span data-ttu-id="39ad6-105"><xref:Microsoft.SqlServer.Management.Smo.ServiceMasterKey.Regenerate%2A> 메서드를 사용하여 다시 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-105">It can be regenerated by using the <xref:Microsoft.SqlServer.Management.Smo.ServiceMasterKey.Regenerate%2A> method.</span></span>  
  
 <span data-ttu-id="39ad6-106">데이터베이스 마스터 키는 <xref:Microsoft.SqlServer.Management.Smo.MasterKey> 개체로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-106">The database master key is represented by the <xref:Microsoft.SqlServer.Management.Smo.MasterKey> object.</span></span> <span data-ttu-id="39ad6-107"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.IsEncryptedByServer%2A> 속성은 데이터베이스 마스터 키가 서비스 마스터 키로 암호화되는지 여부를 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-107">The <xref:Microsoft.SqlServer.Management.Smo.MasterKey.IsEncryptedByServer%2A> property indicates whether or not the database master key is encrypted by the service master key.</span></span> <span data-ttu-id="39ad6-108">데이터베이스 마스터 키가 변경될 때마다 master 데이터베이스의 암호화된 복사본이 자동으로 업데이트됩니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-108">The encrypted copy in the master database is automatically updated whenever the database master key is changed.</span></span>  
  
 <span data-ttu-id="39ad6-109"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.DropServiceKeyEncryption%2A> 메서드를 사용하여 서비스 키 암호화를 삭제하고 암호를 사용하여 데이터베이스 암호화 키를 암호화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-109">It is possible to drop service key encryption using the <xref:Microsoft.SqlServer.Management.Smo.MasterKey.DropServiceKeyEncryption%2A> method and encrypt the database master key with a password.</span></span> <span data-ttu-id="39ad6-110">이 경우 보안 구성된 프라이빗 키에 액세스하기 전에 데이터베이스 마스터 키를 명시적으로 열어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-110">In that situation, you will have to explicitly open the database master key before accessing private keys that it has secured.</span></span>  
  
 <span data-ttu-id="39ad6-111">데이터베이스가 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 인스턴스에 연결되어 있으면 데이터베이스 마스터 키에 대한 암호를 제공하거나 <xref:Microsoft.SqlServer.Management.Smo.MasterKey.AddServiceKeyEncryption%2A> 메서드를 실행하여 서비스 마스터 키와 함께 암호화에 사용되는 데이터베이스 마스터 키의 암호화되지 않은 복사본을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-111">When a database is being attached to an instance of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], you must either supply the password for the database master key or execute the <xref:Microsoft.SqlServer.Management.Smo.MasterKey.AddServiceKeyEncryption%2A> method to make an unencrypted copy of the database master key available for encryption with the service master key.</span></span> <span data-ttu-id="39ad6-112">데이터베이스 마스터 키를 명시적으로 열어야 하는 상황을 피하려면 이 단계를 수행하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-112">This step is recommended to avoid the need to explicitly open the database master key.</span></span>  
  
 <span data-ttu-id="39ad6-113"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.Regenerate%2A> 메서드는 데이터베이스 마스터 키를 다시 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-113">The <xref:Microsoft.SqlServer.Management.Smo.MasterKey.Regenerate%2A> method regenerates the database master key.</span></span> <span data-ttu-id="39ad6-114">데이터베이스 마스터 키가 다시 생성되면 데이터베이스 마스터 키로 암호화되었던 모든 키가 해독되고 이들을 새 데이터베이스 마스터 키로 암호화합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-114">When the database master key is regenerated, all the keys that have been encrypted with the database master key are decrypted, and then encrypts them with the new database master key.</span></span> <span data-ttu-id="39ad6-115"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.DropServiceKeyEncryption%2A> 메서드는 서비스 마스터 키에 의한 데이터베이스 마스터 키의 암호화를 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-115">The <xref:Microsoft.SqlServer.Management.Smo.MasterKey.DropServiceKeyEncryption%2A> method removes the encryption of the database master key by the service master key.</span></span> <span data-ttu-id="39ad6-116"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.AddServiceKeyEncryption%2A>은 마스터 키의 복사본이 서비스 마스터 키를 사용하여 암호화되도록 하고 현재 데이터베이스와 master 데이터베이스에 모두 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-116"><xref:Microsoft.SqlServer.Management.Smo.MasterKey.AddServiceKeyEncryption%2A> causes a copy of the master key to be encrypted using the service master key and stored in both the current database and in the master database.</span></span>  
  
 <span data-ttu-id="39ad6-117">SMO에서 인증서는 <xref:Microsoft.SqlServer.Management.Smo.Certificate> 개체로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-117">In SMO, certificates are represented by the <xref:Microsoft.SqlServer.Management.Smo.Certificate> object.</span></span> <span data-ttu-id="39ad6-118"><xref:Microsoft.SqlServer.Management.Smo.Certificate> 개체에는 공개 키, 주체 이름, 유효 기간 및 발급자 정보를 지정하는 속성이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-118">The <xref:Microsoft.SqlServer.Management.Smo.Certificate> object has properties that specify the public key, the name of the subject, period of validity, and information about the issuer.</span></span> <span data-ttu-id="39ad6-119">인증서에 대한 액세스 권한은 `Grant`, `Revoke` 및 `Deny` 메서드를 사용하여 제어합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-119">Permission to access the certificate is controlled by using the `Grant`, `Revoke` and `Deny` methods.</span></span>  
  
## <a name="example"></a><span data-ttu-id="39ad6-120">예제</span><span class="sxs-lookup"><span data-stu-id="39ad6-120">Example</span></span>  
 <span data-ttu-id="39ad6-121">다음 코드 예제를 사용하려면 애플리케이션을 만들 프로그래밍 환경, 프로그래밍 템플릿 및 프로그래밍 언어를 선택해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-121">For the following code example, you will have to select the programming environment, programming template and the programming language to create your application.</span></span> <span data-ttu-id="39ad6-122">자세한 내용은 visual studio [.net에서 VISUAL BASIC SMO 프로젝트 만들기](../../../database-engine/dev-guide/create-a-visual-basic-smo-project-in-visual-studio-net.md) 및 visual [Studio .Net에서 VISUAL C&#35; smo 프로젝트 만들기](../how-to-create-a-visual-csharp-smo-project-in-visual-studio-net.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="39ad6-122">For more information, see [Create a Visual Basic SMO Project in Visual Studio .NET](../../../database-engine/dev-guide/create-a-visual-basic-smo-project-in-visual-studio-net.md) and [Create a Visual C&#35; SMO Project in Visual Studio .NET](../how-to-create-a-visual-csharp-smo-project-in-visual-studio-net.md).</span></span>  
  
## <a name="adding-a-certificate-in-visual-basic"></a><span data-ttu-id="39ad6-123">Visual Basic에서 인증서 추가</span><span class="sxs-lookup"><span data-stu-id="39ad6-123">Adding a Certificate in Visual Basic</span></span>  
 <span data-ttu-id="39ad6-124">코드 예제는 암호화된 암호를 사용하여 간단한 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-124">The code example creates a simple certificate with an encryption password.</span></span> <span data-ttu-id="39ad6-125">다른 개체와 달리 <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> 메서드에는 몇 가지 오버로드가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-125">Unlike other objects, the <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> method has several overloads.</span></span> <span data-ttu-id="39ad6-126">이 예에 사용된 오버로드는 암호화된 암호를 사용하여 새 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-126">The overload used in the example creates a new certificate with an encryption password.</span></span>  
  
<!-- TODO: review snippet reference  [!CODE [SMO How to#SMO_VBCertificate1](SMO How to#SMO_VBCertificate1)]  -->  
  
## <a name="adding-a-certificate-in-visual-c"></a><span data-ttu-id="39ad6-127">Visual C#에서 인증서 추가</span><span class="sxs-lookup"><span data-stu-id="39ad6-127">Adding a Certificate in Visual C#</span></span>  
 <span data-ttu-id="39ad6-128">코드 예제는 암호화된 암호를 사용하여 간단한 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-128">The code example creates a simple certificate with an encryption password.</span></span> <span data-ttu-id="39ad6-129">다른 개체와 달리 <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> 메서드에는 몇 가지 오버로드가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-129">Unlike other objects, the <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> method has several overloads.</span></span> <span data-ttu-id="39ad6-130">이 예에 사용된 오버로드는 암호화된 암호를 사용하여 새 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-130">The overload used in the example creates a new certificate with an encryption password.</span></span>  
  
```csharp
{  
            //Connect to the local, default instance of SQL Server.   
            {  
                Server srv = new Server();  
  
                //Reference the AdventureWorks2012 database.   
                Database db = srv.Databases["AdventureWorks2012"];  
  
                //Define a Certificate object variable by supplying the parent database and name in the constructor.   
                Certificate c = new Certificate(db, "Test_Certificate");  
  
                //Set the start date, expiry date, and description.   
                System.DateTime dt;  
                DateTime.TryParse("January 01, 2010", out dt);  
                c.StartDate = dt;  
                DateTime.TryParse("January 01, 2015", out dt);  
                c.ExpirationDate = dt;  
                c.Subject = "This is a test certificate.";  
                //Create the certificate on the instance of SQL Server by supplying the certificate password argument.   
                c.Create("pGFD4bb925DGvbd2439587y");  
            }  
        }   
```  
  
## <a name="adding-a-certificate-in-powershell"></a><span data-ttu-id="39ad6-131">PowerShell에서 인증서 추가</span><span class="sxs-lookup"><span data-stu-id="39ad6-131">Adding a Certificate in PowerShell</span></span>  
 <span data-ttu-id="39ad6-132">코드 예제는 암호화된 암호를 사용하여 간단한 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-132">The code example creates a simple certificate with an encryption password.</span></span> <span data-ttu-id="39ad6-133">다른 개체와 달리 <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> 메서드에는 몇 가지 오버로드가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-133">Unlike other objects, the <xref:Microsoft.SqlServer.Management.Smo.Certificate.Create%2A> method has several overloads.</span></span> <span data-ttu-id="39ad6-134">이 예에 사용된 오버로드는 암호화된 암호를 사용하여 새 인증서를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="39ad6-134">The overload used in the example creates a new certificate with an encryption password.</span></span>  
  
```powershell
# Set the path context to the local, default instance of SQL Server and get a reference to AdventureWorks2012  
CD \sql\localhost\default\databases  
$db = get-item AdventureWorks2012  
  
#Create a certificate
$c = New-Object -TypeName Microsoft.SqlServer.Management.Smo.Certificate -ArgumentList $db, "Test_Certificate"  
$c.StartDate = "January 01, 2010"  
$c.Subject = "This is a test certificate."  
$c.ExpirationDate = "January 01, 2015"  
  
#Create the certificate on the instance of SQL Server by supplying the certificate password argument.  
$c.Create("pGFD4bb925DGvbd2439587y")
```  
  
## <a name="see-also"></a><span data-ttu-id="39ad6-135">참고 항목</span><span class="sxs-lookup"><span data-stu-id="39ad6-135">See Also</span></span>  
 [<span data-ttu-id="39ad6-136">암호화 키 사용</span><span class="sxs-lookup"><span data-stu-id="39ad6-136">Using Encryption Keys</span></span>](using-encryption.md)  
