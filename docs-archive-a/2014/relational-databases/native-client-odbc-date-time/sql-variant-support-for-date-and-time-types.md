---
title: 날짜 및 시간 형식에 대 한 sql_variant 지원 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- sql_variant data type
ms.assetid: 12ff1ea6-e2cc-40e6-910c-3126974a90b3
author: rothja
ms.author: jroth
ms.openlocfilehash: 0818f0ccee72264ea7cab69b90e18418179031ca
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87738332"
---
# <a name="sql_variant-support-for-date-and-time-types"></a><span data-ttu-id="a00aa-102">날짜 및 시간 형식에 대한 sql_variant 지원</span><span class="sxs-lookup"><span data-stu-id="a00aa-102">sql_variant Support for Date and Time Types</span></span>
  <span data-ttu-id="a00aa-103">이 항목에서는 `sql_variant` 데이터 형식에서 향상된 날짜 및 시간 기능을 지원하는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-103">This topic describes how the `sql_variant` data type supports enhanced date and time functionality.</span></span>  
  
 <span data-ttu-id="a00aa-104">열 특성 SQL_CA_SS_VARIANT_TYPE은 C 형식의 variant 결과 열을 반환하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-104">The column attribute SQL_CA_SS_VARIANT_TYPE is used to return the C type of a variant result column.</span></span> [!INCLUDE[ssKatmai](../../includes/sskatmai-md.md)]<span data-ttu-id="a00aa-105">IRD (구현 행 설명자)에서 변형 결과 열의 SQL 형식을 설정 하는 추가 특성인 SQL_CA_SS_VARIANT_SQL_TYPE를 소개 합니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-105">introduces an additional attribute, SQL_CA_SS_VARIANT_SQL_TYPE, which sets the SQL type of a variant result column in the implementation row descriptor (IRD).</span></span> <span data-ttu-id="a00aa-106">IPD(구현 매개 변수 설명자)에서 SQL_SS_VARIANT 형식으로 바인딩된 SQL_C_BINARY C 형식을 갖는 SQL 형식의 SQL_SS_TIME2 또는 SQL_SS_TIMESTAMPOFFSET 매개 변수를 지정하는 데에도 SQL_CA_SS_VARIANT_SQL_TYPE을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-106">SQL_CA_SS_VARIANT_SQL_TYPE can also be used in the implementation parameter descriptor (IPD) to specify the SQL type of a SQL_SS_TIME2 or SQL_SS_TIMESTAMPOFFSET parameter that has SQL_C_BINARY C type bound with type SQL_SS_VARIANT.</span></span>  
  
 <span data-ttu-id="a00aa-107">새 형식 SQL_SS_TIME2 및 SQL_SS_TIMESTAMPOFFSET는 SQLColAttribute로 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-107">The new types SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET can be set by SQLColAttribute.</span></span> <span data-ttu-id="a00aa-108">SQL_CA_SS_VARIANT_SQL_TYPE는 SQLGetDescField에서 반환 될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-108">SQL_CA_SS_VARIANT_SQL_TYPE can be returned by SQLGetDescField.</span></span>  
  
 <span data-ttu-id="a00aa-109">결과 열의 경우 드라이버에서는 variant를 날짜/시간 형식으로 변환합니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-109">For result columns, the driver will convert from the variant to date/time types.</span></span> <span data-ttu-id="a00aa-110">자세한 내용은 [SQL에서 C로 변환](datetime-data-type-conversions-from-sql-to-c.md)을 참조 하세요. SQL_C_BINARY에 바인딩할 때 버퍼 길이는 SQL 형식에 해당 하는 구조체를 받을 수 있을 만큼 커야 합니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-110">For more information, see [Conversions from SQL to C](datetime-data-type-conversions-from-sql-to-c.md). When binding to SQL_C_BINARY, the buffer length must be large enough to receive the struct that corresponds to the SQL type.</span></span>  
  
 <span data-ttu-id="a00aa-111">SQL_SS_TIME2 및 SQL_SS_TIMESTAMPOFFSET 매개 변수의 경우 드라이버에서는 아래 표에 설명된 대로 C 값을 `sql_variant` 값으로 변환합니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-111">For the SQL_SS_TIME2 and SQL_SS_TIMESTAMPOFFSET parameters, the driver will convert C values to `sql_variant` values, as described in the table below.</span></span> <span data-ttu-id="a00aa-112">매개 변수가 SQL_C_BINARY로 바인딩되어 있고 서버 형식이 SQL_SS_VARIANT인 경우에는 애플리케이션에서 SQL_CA_SS_VARIANT_SQL_TYPE을 다른 SQL 형식으로 설정한 경우 외에는 이진 값으로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-112">If a parameter is bound as SQL_C_BINARY and the server type is SQL_SS_VARIANT, it will be treated as a binary value unless the application has set SQL_CA_SS_VARIANT_SQL_TYPE to some other SQL type.</span></span> <span data-ttu-id="a00aa-113">이 경우 SQL_CA_SS_VARIANT_SQL_TYPE이 우선 순위가 높습니다. 즉, SQL_CA_SS_VARIANT_SQL_TYPE이 설정된 경우 C 형식에서 variant SQL 형식을 추론하는 기본 동작이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-113">In this case, SQL_CA_SS_VARIANT_SQL_TYPE takes precedence; that is, if SQL_CA_SS_VARIANT_SQL_TYPE is set, it overrides the default behavior of deducing the variant SQL type from the C type.</span></span>  
  
|<span data-ttu-id="a00aa-114">C 형식</span><span class="sxs-lookup"><span data-stu-id="a00aa-114">C type</span></span>|<span data-ttu-id="a00aa-115">서버 유형</span><span class="sxs-lookup"><span data-stu-id="a00aa-115">Server type</span></span>|<span data-ttu-id="a00aa-116">주석</span><span class="sxs-lookup"><span data-stu-id="a00aa-116">Comments</span></span>|  
|------------|-----------------|--------------|  
|<span data-ttu-id="a00aa-117">SQL_C_CHAR</span><span class="sxs-lookup"><span data-stu-id="a00aa-117">SQL_C_CHAR</span></span>|<span data-ttu-id="a00aa-118">varchar</span><span class="sxs-lookup"><span data-stu-id="a00aa-118">varchar</span></span>|<span data-ttu-id="a00aa-119">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-119">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-120">SQL_C_WCHAR</span><span class="sxs-lookup"><span data-stu-id="a00aa-120">SQL_C_WCHAR</span></span>|<span data-ttu-id="a00aa-121">nvarcar</span><span class="sxs-lookup"><span data-stu-id="a00aa-121">nvarcar</span></span>|<span data-ttu-id="a00aa-122">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-122">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-123">SQL_C_TINYINT</span><span class="sxs-lookup"><span data-stu-id="a00aa-123">SQL_C_TINYINT</span></span>|<span data-ttu-id="a00aa-124">smallint</span><span class="sxs-lookup"><span data-stu-id="a00aa-124">smallint</span></span>|<span data-ttu-id="a00aa-125">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-125">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-126">SQL_C_STINYINT</span><span class="sxs-lookup"><span data-stu-id="a00aa-126">SQL_C_STINYINT</span></span>|<span data-ttu-id="a00aa-127">smallint</span><span class="sxs-lookup"><span data-stu-id="a00aa-127">smallint</span></span>|<span data-ttu-id="a00aa-128">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-128">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-129">SQL_C_SHORT</span><span class="sxs-lookup"><span data-stu-id="a00aa-129">SQL_C_SHORT</span></span>|<span data-ttu-id="a00aa-130">smallint</span><span class="sxs-lookup"><span data-stu-id="a00aa-130">smallint</span></span>|<span data-ttu-id="a00aa-131">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-131">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-132">SQL_C_SSHORT</span><span class="sxs-lookup"><span data-stu-id="a00aa-132">SQL_C_SSHORT</span></span>|<span data-ttu-id="a00aa-133">smallint</span><span class="sxs-lookup"><span data-stu-id="a00aa-133">smallint</span></span>|<span data-ttu-id="a00aa-134">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-134">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-135">SQL_C_USHORT</span><span class="sxs-lookup"><span data-stu-id="a00aa-135">SQL_C_USHORT</span></span>|<span data-ttu-id="a00aa-136">Int</span><span class="sxs-lookup"><span data-stu-id="a00aa-136">int</span></span>|<span data-ttu-id="a00aa-137">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-137">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-138">SQL_C_LONG</span><span class="sxs-lookup"><span data-stu-id="a00aa-138">SQL_C_LONG</span></span>|<span data-ttu-id="a00aa-139">Int</span><span class="sxs-lookup"><span data-stu-id="a00aa-139">int</span></span>|<span data-ttu-id="a00aa-140">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-140">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-141">SQL_C_SLONG</span><span class="sxs-lookup"><span data-stu-id="a00aa-141">SQL_C_SLONG</span></span>|<span data-ttu-id="a00aa-142">Int</span><span class="sxs-lookup"><span data-stu-id="a00aa-142">int</span></span>|<span data-ttu-id="a00aa-143">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-143">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-144">SQL_C_ULONG</span><span class="sxs-lookup"><span data-stu-id="a00aa-144">SQL_C_ULONG</span></span>|<span data-ttu-id="a00aa-145">bigint</span><span class="sxs-lookup"><span data-stu-id="a00aa-145">bigint</span></span>|<span data-ttu-id="a00aa-146">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-146">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-147">SQL_C_SBIGINT</span><span class="sxs-lookup"><span data-stu-id="a00aa-147">SQL_C_SBIGINT</span></span>|<span data-ttu-id="a00aa-148">bigint</span><span class="sxs-lookup"><span data-stu-id="a00aa-148">bigint</span></span>|<span data-ttu-id="a00aa-149">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-149">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-150">SQL_C_FLOAT</span><span class="sxs-lookup"><span data-stu-id="a00aa-150">SQL_C_FLOAT</span></span>|<span data-ttu-id="a00aa-151">real</span><span class="sxs-lookup"><span data-stu-id="a00aa-151">real</span></span>|<span data-ttu-id="a00aa-152">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-152">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-153">SQL_C_DOUBLE</span><span class="sxs-lookup"><span data-stu-id="a00aa-153">SQL_C_DOUBLE</span></span>|<span data-ttu-id="a00aa-154">float</span><span class="sxs-lookup"><span data-stu-id="a00aa-154">float</span></span>|<span data-ttu-id="a00aa-155">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-155">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-156">SQL_C_BIT</span><span class="sxs-lookup"><span data-stu-id="a00aa-156">SQL_C_BIT</span></span>|<span data-ttu-id="a00aa-157">bit</span><span class="sxs-lookup"><span data-stu-id="a00aa-157">bit</span></span>|<span data-ttu-id="a00aa-158">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-158">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-159">SQL_C_UTINYINT</span><span class="sxs-lookup"><span data-stu-id="a00aa-159">SQL_C_UTINYINT</span></span>|<span data-ttu-id="a00aa-160">tinyint</span><span class="sxs-lookup"><span data-stu-id="a00aa-160">tinyint</span></span>|<span data-ttu-id="a00aa-161">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-161">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-162">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="a00aa-162">SQL_C_BINARY</span></span>|<span data-ttu-id="a00aa-163">varbinary</span><span class="sxs-lookup"><span data-stu-id="a00aa-163">varbinary</span></span>|<span data-ttu-id="a00aa-164">SQL_CA_SS_VARIANT_SQL_TYPE이 설정되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-164">SQL_CA_SS_VARIANT_SQL_TYPE is not set.</span></span>|  
|<span data-ttu-id="a00aa-165">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="a00aa-165">SQL_C_BINARY</span></span>|<span data-ttu-id="a00aa-166">time</span><span class="sxs-lookup"><span data-stu-id="a00aa-166">time</span></span>|<span data-ttu-id="a00aa-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="a00aa-167">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIME2</span></span><br /><br /> <span data-ttu-id="a00aa-168">Scale은 SQL_DESC_PRECISION (의 *DecimalDigits* 매개 변수)로 설정 됩니다 `SQLBindParameter` .</span><span class="sxs-lookup"><span data-stu-id="a00aa-168">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="a00aa-169">SQL_C_BINARY</span><span class="sxs-lookup"><span data-stu-id="a00aa-169">SQL_C_BINARY</span></span>|<span data-ttu-id="a00aa-170">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="a00aa-170">datetimeoffset</span></span>|<span data-ttu-id="a00aa-171">SQL_CA_SS_VARIANT_SQL_TYPE= SQL_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="a00aa-171">SQL_CA_SS_VARIANT_SQL_TYPE = SQL_SS_TIMESTAMPOFFSET</span></span><br /><br /> <span data-ttu-id="a00aa-172">Scale은 SQL_DESC_PRECISION (의 *DecimalDigits* 매개 변수)로 설정 됩니다 `SQLBindParameter` .</span><span class="sxs-lookup"><span data-stu-id="a00aa-172">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="a00aa-173">SQL_C_TYPE_DATE</span><span class="sxs-lookup"><span data-stu-id="a00aa-173">SQL_C_TYPE_DATE</span></span>|<span data-ttu-id="a00aa-174">date</span><span class="sxs-lookup"><span data-stu-id="a00aa-174">date</span></span>|<span data-ttu-id="a00aa-175">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-175">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-176">SQL_C_TYPE_TIME</span><span class="sxs-lookup"><span data-stu-id="a00aa-176">SQL_C_TYPE_TIME</span></span>|<span data-ttu-id="a00aa-177">time(0)</span><span class="sxs-lookup"><span data-stu-id="a00aa-177">time(0)</span></span>|<span data-ttu-id="a00aa-178">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-178">SQL_CA_SS_VARIANT_SQL_TYPE is ignored.</span></span>|  
|<span data-ttu-id="a00aa-179">SQL_C_TYPE_TIMESTAMP</span><span class="sxs-lookup"><span data-stu-id="a00aa-179">SQL_C_TYPE_TIMESTAMP</span></span>|<span data-ttu-id="a00aa-180">datetime2</span><span class="sxs-lookup"><span data-stu-id="a00aa-180">datetime2</span></span>|<span data-ttu-id="a00aa-181">Scale은 SQL_DESC_PRECISION (의 *DecimalDigits* 매개 변수)로 설정 됩니다 `SQLBindParameter` .</span><span class="sxs-lookup"><span data-stu-id="a00aa-181">Scale is set to SQL_DESC_PRECISION (the *DecimalDigits* parameter of `SQLBindParameter`).</span></span>|  
|<span data-ttu-id="a00aa-182">SQL_C_NUMERIC</span><span class="sxs-lookup"><span data-stu-id="a00aa-182">SQL_C_NUMERIC</span></span>|<span data-ttu-id="a00aa-183">decimal</span><span class="sxs-lookup"><span data-stu-id="a00aa-183">decimal</span></span>|<span data-ttu-id="a00aa-184">전체 자릿수는 SQL_DESC_PRECISION (의 *Columnsize* 매개 변수)로 설정 됩니다 `SQLBindParameter` .</span><span class="sxs-lookup"><span data-stu-id="a00aa-184">Precision is set to SQL_DESC_PRECISION (the *ColumnSize* parameter of `SQLBindParameter`).</span></span><br /><br /> <span data-ttu-id="a00aa-185">소수 자릿수가 SQL_DESC_SCALE(SQLBindParameter의 *DecimalDigits* 매개 변수)로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-185">Scale set to SQL_DESC_SCALE (the *DecimalDigits* parameter of SQLBindParameter).</span></span>|  
|<span data-ttu-id="a00aa-186">SQL_C_SS_TIME2</span><span class="sxs-lookup"><span data-stu-id="a00aa-186">SQL_C_SS_TIME2</span></span>|<span data-ttu-id="a00aa-187">time</span><span class="sxs-lookup"><span data-stu-id="a00aa-187">time</span></span>|<span data-ttu-id="a00aa-188">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-188">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
|<span data-ttu-id="a00aa-189">SQL_C_SS_TIMESTAMPOFFSET</span><span class="sxs-lookup"><span data-stu-id="a00aa-189">SQL_C_SS_TIMESTAMPOFFSET</span></span>|<span data-ttu-id="a00aa-190">datetimeoffset</span><span class="sxs-lookup"><span data-stu-id="a00aa-190">datetimeoffset</span></span>|<span data-ttu-id="a00aa-191">SQL_CA_SS_VARIANT_SQL_TYPE이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="a00aa-191">SQL_CA_SS_VARIANT_SQL_TYPE is ignored</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="a00aa-192">참고 항목</span><span class="sxs-lookup"><span data-stu-id="a00aa-192">See Also</span></span>  
 [<span data-ttu-id="a00aa-193">ODBC&#41;&#40;날짜 및 시간 기능 향상</span><span class="sxs-lookup"><span data-stu-id="a00aa-193">Date and Time Improvements &#40;ODBC&#41;</span></span>](date-and-time-improvements-odbc.md)  
  
  
