---
title: 밀어넣기 구독 만들기 | Microsoft 문서
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- push subscriptions [SQL Server replication], creating
- merge replication subscribing [SQL Server replication], push subscriptions
- subscriptions [SQL Server replication], push
- snapshot replication [SQL Server], subscribing
- transactional replication, subscribing
ms.assetid: adfbbc61-58d1-4330-9ad6-b14ab1142e2b
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 2195d96f4337cc60ba213deb5e3cc2831d27da76
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87661638"
---
# <a name="create-a-push-subscription"></a><span data-ttu-id="7bb0e-102">밀어넣기 구독 만들기</span><span class="sxs-lookup"><span data-stu-id="7bb0e-102">Create a Push Subscription</span></span>
  <span data-ttu-id="7bb0e-103">이 항목에서는 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]또는 RMO(복제 관리 개체)를 사용하여 [!INCLUDE[tsql](../../includes/tsql-md.md)]에서 밀어넣기 구독을 만드는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-103">This topic describes how to create a push subscription in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="7bb0e-104">이외 구독자에 대 한 밀어넣기 구독을 만드는 방법에 대 한 자세한 내용은 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] [SQL Server 하지 않는 구독자에 대 한 구독 만들기](create-a-subscription-for-a-non-sql-server-subscriber.md)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-104">For information about creating a push subscription for a non-[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Subscriber, see [Create a Subscription for a Non-SQL Server Subscriber](create-a-subscription-for-a-non-sql-server-subscriber.md).</span></span>  
  
  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="7bb0e-105">SQL Server Management Studio 사용</span><span class="sxs-lookup"><span data-stu-id="7bb0e-105">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="7bb0e-106">새 구독 마법사를 사용하여 게시자 또는 구독자에서 밀어넣기 구독을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-106">Create a push subscription at the Publisher or the Subscriber using the New Subscription Wizard.</span></span> <span data-ttu-id="7bb0e-107">마법사의 페이지에 따라 다음을 수행하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-107">Follow the pages in the wizard to:</span></span>  
  
-   <span data-ttu-id="7bb0e-108">게시자와 게시를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-108">Specify the Publisher and publication.</span></span>  
  
-   <span data-ttu-id="7bb0e-109">복제 에이전트가 실행될 위치를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-109">Select where replication agents will run.</span></span> <span data-ttu-id="7bb0e-110">밀어넣기 구독의 경우 게시 유형에 따라 **배포 에이전트 위치** 페이지 또는 **병합 에이전트 위치** 페이지에서 **배포자 (밀어넣기 구독)에서 모든 에이전트 실행** 을 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-110">For a push subscription, select **Run all agents at the Distributor (push subscriptions)** on the **Distribution Agent Location** page or **Merge Agent Location** page, depending on the type of publication.</span></span>  
  
-   <span data-ttu-id="7bb0e-111">구독자와 구독 데이터베이스를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-111">Specify Subscribers and subscription databases.</span></span>  
  
-   <span data-ttu-id="7bb0e-112">복제 에이전트에서 설정한 연결에 사용할 로그인과 암호를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-112">Specify the logins and passwords used for connections made by replication agents:</span></span>  
  
    -   <span data-ttu-id="7bb0e-113">스냅샷 및 트랜잭션 게시에 대한 구독의 경우 **배포 에이전트 보안** 페이지에서 자격 증명을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-113">For subscriptions to snapshot and transactional publications, specify credentials on the **Distribution Agent Security** page.</span></span>  
  
    -   <span data-ttu-id="7bb0e-114">병합 게시에 대한 구독의 경우 **병합 에이전트 보안** 페이지에서 자격 증명을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-114">For subscriptions to merge publications, specify credentials on the **Merge Agent Security** page.</span></span>  
  
     <span data-ttu-id="7bb0e-115">각 에이전트에 필요한 사용 권한에 대한 자세한 내용은 [복제 에이전트 보안 모델](security/replication-agent-security-model.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-115">For information about the permissions required by each agent, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
-   <span data-ttu-id="7bb0e-116">동기화 일정과 구독자의 초기화 시기를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-116">Specify a synchronization schedule and when the Subscriber should be initialized.</span></span>  
  
-   <span data-ttu-id="7bb0e-117">게시 유형 및 매개 변수가 있는 필터링 값 등의 병합 게시에 대한 추가 옵션을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-117">Specify additional options for merge publications: subscription type; and values for parameterized filtering.</span></span>  
  
-   <span data-ttu-id="7bb0e-118">구독자가 게시자의 변경 내용을 즉시 커밋할지 아니면 큐에 쓸지 여부, 구독자에서 게시자로 연결하는 데 사용할 자격 증명 등, 트랜잭션 게시에 대해 구독 업데이트를 허용하는 추가 옵션을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-118">Specify additional options for transactional publications that allow updating subscriptions: whether Subscribers should commit changes at the Publisher immediately or write them to a queue; credentials used to connect from the Subscriber to the Publisher.</span></span>  
  
-   <span data-ttu-id="7bb0e-119">경우에 따라 구독을 스크립팅합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-119">Optionally script the subscription.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-publisher"></a><span data-ttu-id="7bb0e-120">게시자에서 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-120">To create a push subscription from the Publisher</span></span>  
  
1.  <span data-ttu-id="7bb0e-121">[!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]에서 게시자에 연결한 다음, 해당 서버 노드를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-121">Connect to the Publisher in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="7bb0e-122">**복제** 폴더를 확장한 다음 **로컬 게시** 폴더를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-122">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="7bb0e-123">하나 이상의 구독을 만들 게시를 마우스 오른쪽 단추로 클릭한 다음 **새 구독**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-123">Right-click the publication for which you want to create one or more subscriptions, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="7bb0e-124">새 구독 마법사의 페이지를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-124">Complete the pages in the New Subscription Wizard.</span></span>  
  
#### <a name="to-create-a-push-subscription-from-the-subscriber"></a><span data-ttu-id="7bb0e-125">구독자에서 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-125">To create a push subscription from the Subscriber</span></span>  
  
1.  <span data-ttu-id="7bb0e-126">[!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]에서 구독자에 연결한 다음 해당 서버 노드를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-126">Connect to the Subscriber in [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="7bb0e-127">**복제** 폴더를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-127">Expand the **Replication** folder.</span></span>  
  
3.  <span data-ttu-id="7bb0e-128">**로컬 구독** 폴더를 마우스 오른쪽 단추로 클릭한 다음 **새 구독**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-128">Right-click the **Local Subscriptions** folder, and then click **New Subscriptions**.</span></span>  
  
4.  <span data-ttu-id="7bb0e-129">새 구독 마법사의 **게시** 페이지에 있는 **게시자** 드롭다운 목록에서 **\<Find SQL Server Publisher>** 또는 **\<Find Oracle Publisher>** 를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-129">On the **Publication** page of the New Subscription Wizard, select **\<Find SQL Server Publisher>** or **\<Find Oracle Publisher>** from the **Publisher** drop-down list.</span></span>  
  
5.  <span data-ttu-id="7bb0e-130">**서버에 연결** 대화 상자에서 게시자에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-130">Connect to the Publisher in the **Connect to Server** dialog box.</span></span>  
  
6.  <span data-ttu-id="7bb0e-131">**게시** 페이지에서 게시를 선택합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-131">Select a publication on the **Publication** page.</span></span>  
  
7.  <span data-ttu-id="7bb0e-132">새 구독 마법사의 페이지를 완료합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-132">Complete the pages in the New Subscription Wizard.</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="7bb0e-133">Transact-SQL 사용</span><span class="sxs-lookup"><span data-stu-id="7bb0e-133">Using Transact-SQL</span></span>  
 <span data-ttu-id="7bb0e-134">밀어넣기 구독은 복제 저장 프로시저를 사용하여 프로그래밍 방식으로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-134">Push subscriptions can be created programmatically using replication stored procedures.</span></span> <span data-ttu-id="7bb0e-135">사용되는 저장 프로시저는 구독이 속한 게시 유형에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-135">The stored procedures used will depend on the type of publication to which the subscription belongs.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7bb0e-136">가능한 경우 런타임 시 사용자에게 보안 자격 증명을 입력하라는 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-136">When possible, prompt users to enter security credentials at run time.</span></span> <span data-ttu-id="7bb0e-137">자격 증명을 스크립트 파일에 저장해야 하는 경우에는 파일에 무단으로 액세스하지 못하도록 보안을 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="7bb0e-138">스냅샷 또는 트랜잭션 게시에 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-138">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="7bb0e-139">게시 데이터베이스의 게시자에서 [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql)을 실행하여 게시에서 밀어넣기 구독을 지원하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-139">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helppublication](/sql/relational-databases/system-stored-procedures/sp-helppublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="7bb0e-140">**allow_push** 의 값이 **1**이면 게시에서 밀어넣기 구독을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-140">If the value of **allow_push** is **1**, push subscriptions are supported.</span></span>  
  
    -   <span data-ttu-id="7bb0e-141">**Allow_push** 값이 **0**이면 [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql)를 실행 하 고에 대해 및에 대해 **allow_push** 를 지정 **@property** `true` **@value** 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-141">If the value of **allow_push** is **0**, execute [sp_changepublication](/sql/relational-databases/system-stored-procedures/sp-changepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="7bb0e-142">게시 데이터베이스의 게시자에서 [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql)을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-142">At the Publisher on the publication database, execute [sp_addsubscription](/sql/relational-databases/system-stored-procedures/sp-addsubscription-transact-sql).</span></span> <span data-ttu-id="7bb0e-143">**@publication**, 및를 지정 **@subscriber** **@destination_db** 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-143">Specify **@publication**, **@subscriber** and **@destination_db**.</span></span> <span data-ttu-id="7bb0e-144">**@subscription_type**에 **push** 값을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-144">Specify a value of **push** for **@subscription_type**.</span></span> <span data-ttu-id="7bb0e-145">구독을 업데이트 하는 방법에 대 한 자세한 내용은 [트랜잭션 게시에 업데이트할 수 있는 구독 만들기](publish/create-an-updatable-subscription-to-a-transactional-publication.md) 를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-145">For information about how to update subscriptions, see [Create an Updatable Subscription to a Transactional Publication](publish/create-an-updatable-subscription-to-a-transactional-publication.md)</span></span>  
  
3.  <span data-ttu-id="7bb0e-146">게시 데이터베이스의 게시자에서 [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-146">At the Publisher on the publication database, execute [sp_addpushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addpushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="7bb0e-147">다음을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-147">Specify the following:</span></span>  
  
    -   <span data-ttu-id="7bb0e-148">**@subscriber**, **@subscriber_db** 및 **@publication** 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-148">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="7bb0e-149">[!INCLUDE[msCoName](../../includes/msconame-md.md)]배포자에서 및에 대 한 배포 에이전트 실행 되는 Windows 자격 증명입니다 **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="7bb0e-149">The [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows credentials under which the Distribution Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7bb0e-150">Windows 통합 인증을 사용 하 여 만든 연결은 항상 및로 지정 된 Windows 자격 증명을 사용 합니다 **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="7bb0e-150">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="7bb0e-151">배포 에이전트는 항상 Windows 통합 인증을 사용하여 배포자에 대한 로컬 연결을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-151">The Distribution Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="7bb0e-152">기본적으로 에이전트는 Windows 통합 인증을 사용하여 구독자에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-152">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="7bb0e-153">(옵션) **0** 에 **@subscriber_security_mode** 값 및 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 및 **@subscriber_login** 를 지정하고 **@subscriber_password**를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-153">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="7bb0e-154">구독자에 연결할 때 SQL Server 인증을 사용해야 하는 경우 이러한 매개 변수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-154">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="7bb0e-155">이 구독에 대한 배포 에이전트 작업 일정.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-155">A schedule for the Distribution Agent job for this subscription.</span></span> <span data-ttu-id="7bb0e-156">자세한 내용은 [Specify Synchronization Schedules](specify-synchronization-schedules.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-156">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7bb0e-157">게시자에서 원격 배포자를 사용하여 밀어넣기 구독을 만드는 경우 *job_login* 및 *job_password*를 비롯한 모든 매개 변수에 제공된 값이 일반 텍스트로 배포자에게 보내집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-157">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7bb0e-158">이 저장 프로시저를 실행하기 전에 게시자와 해당 원격 배포자 간 연결을 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-158">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="7bb0e-159">자세한 내용은 [데이터베이스 엔진에 암호화 연결 사용&#40;SQL Server 구성 관리자&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-159">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="7bb0e-160">병합 게시에 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-160">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="7bb0e-161">_게시 데이터베이스의 게시자에서 [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql)을 실행하여 게시에서 밀어넣기 구독을 지원하는지 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-161">At the Publisher on the publication database, verify that the publication supports push subscriptions by executing [sp_helpmergepublication](/sql/relational-databases/system-stored-procedures/sp-helpmergepublication-transact-sql).</span></span>  
  
    -   <span data-ttu-id="7bb0e-162">**allow_push** 값이 **1**이면 게시에서 밀어넣기 구독을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-162">If the value of **allow_push** is **1**, the publication supports push subscriptions.</span></span>  
  
    -   <span data-ttu-id="7bb0e-163">**Allow_push** 값이 **1**이 아닌 경우 [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql)를 실행 하 여에 대해 및에 대해 **allow_push** 를 지정 **@property** `true` **@value** 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-163">If the value of **allow_push** is not **1**, execute [sp_changemergepublication](/sql/relational-databases/system-stored-procedures/sp-changemergepublication-transact-sql), specifying **allow_push** for **@property** and `true` for **@value**.</span></span>  
  
2.  <span data-ttu-id="7bb0e-164">게시 데이터베이스의 게시자에서 [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql)을 실행하고 다음 매개 변수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-164">At the Publisher on the publication database, execute [sp_addmergesubscription](/sql/relational-databases/system-stored-procedures/sp-addmergesubscription-transact-sql), specifying the following parameters:</span></span>  
  
    -   <span data-ttu-id="7bb0e-165">**@publication**.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-165">**@publication**.</span></span> <span data-ttu-id="7bb0e-166">게시의 이름입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-166">This is the name of the publication.</span></span>  
  
    -   <span data-ttu-id="7bb0e-167">**@subscriber_type**.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-167">**@subscriber_type**.</span></span> <span data-ttu-id="7bb0e-168">클라이언트 구독에 **local** 을 지정하고 서버 구독에 **global**을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-168">For a client subscription, specify **local** and for a server subscription, specify **global**.</span></span>  
  
    -   <span data-ttu-id="7bb0e-169">**@subscription_priority**.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-169">**@subscription_priority**.</span></span> <span data-ttu-id="7bb0e-170">서버 구독에 대해 구독의 우선 순위를 지정합니다(**0.00** ~ **99.99**).</span><span class="sxs-lookup"><span data-stu-id="7bb0e-170">For a server subscription, specify a priority for the subscription (**0.00** to **99.99**).</span></span>  
  
         <span data-ttu-id="7bb0e-171">자세한 내용은 [고급 병합 복제 충돌 감지 및 해결](merge/advanced-merge-replication-conflict-detection-and-resolution.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-171">For more information, see [Advanced Merge Replication Conflict Detection and Resolution](merge/advanced-merge-replication-conflict-detection-and-resolution.md).</span></span>  
  
3.  <span data-ttu-id="7bb0e-172">게시 데이터베이스의 게시자에서 [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-172">At the Publisher on the publication database, execute [sp_addmergepushsubscription_agent](/sql/relational-databases/system-stored-procedures/sp-addmergepushsubscription-agent-transact-sql).</span></span> <span data-ttu-id="7bb0e-173">다음을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-173">Specify the following:</span></span>  
  
    -   <span data-ttu-id="7bb0e-174">**@subscriber**, **@subscriber_db** 및 **@publication** 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-174">The **@subscriber**, **@subscriber_db**, and **@publication** parameters.</span></span>  
  
    -   <span data-ttu-id="7bb0e-175">배포자에서 및에 대 한 병합 에이전트 실행 되는 Windows 자격 증명입니다 **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="7bb0e-175">The Windows credentials under which the Merge Agent at the Distributor runs for **@job_login** and **@job_password**.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7bb0e-176">Windows 통합 인증을 사용 하 여 만든 연결은 항상 및로 지정 된 Windows 자격 증명을 사용 합니다 **@job_login** **@job_password** .</span><span class="sxs-lookup"><span data-stu-id="7bb0e-176">Connections made using Windows Integrated Authentication always use the Windows credentials specified by **@job_login** and **@job_password**.</span></span> <span data-ttu-id="7bb0e-177">병합 에이전트는 항상 Windows 통합 인증을 사용하여 배포자에 로컬로 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-177">The Merge Agent always makes the local connection to the Distributor using Windows Integrated Authentication.</span></span> <span data-ttu-id="7bb0e-178">기본적으로 에이전트는 Windows 통합 인증을 사용하여 구독자에 연결합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-178">By default, the agent will connect to the Subscriber using Windows Integrated Authentication.</span></span>  
  
    -   <span data-ttu-id="7bb0e-179">(옵션) **0** 에 **@subscriber_security_mode** 값 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 및 **@subscriber_login** 를 지정하고 **@subscriber_password**를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-179">(Optional) A value of **0** for **@subscriber_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@subscriber_login** and **@subscriber_password**.</span></span> <span data-ttu-id="7bb0e-180">구독자에 연결할 때 SQL Server 인증을 사용해야 하는 경우 이러한 매개 변수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-180">Specify these parameters if you need to use SQL Server Authentication when connecting to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="7bb0e-181">(옵션) **0** 에 **@publisher_security_mode** 값 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 및 **@publisher_login** 를 지정하고 **@publisher_password**를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-181">(Optional) A value of **0** for **@publisher_security_mode** and the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] login information for **@publisher_login** and **@publisher_password**.</span></span> <span data-ttu-id="7bb0e-182">구독자에 연결할 때 SQL Server 인증을 사용해야 하는 경우 이러한 값을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-182">Specify these values if you need to use SQL Server Authentication when connecting to the Publisher.</span></span>  
  
    -   <span data-ttu-id="7bb0e-183">이 구독에 대한 병합 에이전트 작업 일정.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-183">A schedule for the Merge Agent job for this subscription.</span></span> <span data-ttu-id="7bb0e-184">자세한 내용은 [Specify Synchronization Schedules](specify-synchronization-schedules.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-184">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7bb0e-185">게시자에서 원격 배포자를 사용하여 밀어넣기 구독을 만드는 경우 *job_login* 및 *job_password*를 비롯한 모든 매개 변수에 제공된 값이 일반 텍스트로 배포자에게 보내집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-185">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7bb0e-186">이 저장 프로시저를 실행하기 전에 게시자와 해당 원격 배포자 간 연결을 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-186">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="7bb0e-187">자세한 내용은 [데이터베이스 엔진에 암호화 연결 사용&#40;SQL Server 구성 관리자&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-187">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="7bb0e-188">예(Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="7bb0e-188">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="7bb0e-189">다음은 트랜잭션 게시에 밀어넣기 구독을 만드는 예입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-189">The following example creates a push subscription to a transactional publication.</span></span> <span data-ttu-id="7bb0e-190">로그인 및 암호 값은 **sqlcmd** 스크립팅 변수를 사용하여 런타임 시 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-190">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addtranpushsubscription_agent](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpushsub.sql#sp_addtranpushsubscription_agent)]  
  
 <span data-ttu-id="7bb0e-191">다음은 병합 게시에 밀어넣기 구독을 만드는 예입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-191">The following example creates a push subscription to a merge publication.</span></span> <span data-ttu-id="7bb0e-192">로그인 및 암호 값은 **sqlcmd** 스크립팅 변수를 사용하여 런타임 시 제공됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-192">Login and password values are supplied at run time by using **sqlcmd** scripting variables.</span></span>  
  
 [!code-sql[HowTo#sp_addmergepushsubscriptionagent](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepushsub.sql#sp_addmergepushsubscriptionagent)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="7bb0e-193">RMO(복제 관리 개체) 사용</span><span class="sxs-lookup"><span data-stu-id="7bb0e-193">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="7bb0e-194">RMO(복제 관리 개체)를 사용하여 프로그래밍 방식으로 밀어넣기 구독을 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-194">You can create push subscriptions programmatically by using Replication Management Objects (RMO).</span></span> <span data-ttu-id="7bb0e-195">_밀어넣기 구독을 만들 때 사용하는 RMO 클래스는 구독을 만드는 게시 유형에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-195">The RMO classes you use to create a push subscription depend on the type of publication to which the subscription is created.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="7bb0e-196">가능한 경우 런타임 시 사용자에게 보안 자격 증명을 입력하라는 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-196">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="7bb0e-197">자격 증명을 저장해야 하는 경우 [Windows .NET Framework에서 제공하는](https://go.microsoft.com/fwlink/?LinkId=34733) 암호화 서비스 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-197">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-snapshot-or-transactional-publication"></a><span data-ttu-id="7bb0e-198">스냅샷 또는 트랜잭션 게시에 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-198">To create a push subscription to a snapshot or transactional publication</span></span>  
  
1.  <span data-ttu-id="7bb0e-199"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 클래스를 사용하여 게시자 연결을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-199">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="7bb0e-200">1단계에서 만든 게시자 연결을 사용하여 <xref:Microsoft.SqlServer.Replication.TransPublication> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-200">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="7bb0e-201"><xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>및 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-201">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="7bb0e-202"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-202">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="7bb0e-203">이 메서드가 `false`를 반환하는 경우 2단계에서 지정한 속성이 올바르지 않거나 서버에 게시가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-203">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="7bb0e-204"><xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> 속성과 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> 사이에서 비트 논리 AND(Visual C#의 `&` 및 Visual Basic의 `And`)를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-204">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="7bb0e-205">결과가 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>이면 <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>와 <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> 사이의 비트 논리 OR(Visual C#의 `|` 및 Visual Basic의 `Or`)의 결과에 대해 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-205">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="7bb0e-206">그런 다음 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 를 호출하여 밀어넣기 구독을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-206">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="7bb0e-207">구독 데이터베이스가 없는 경우 <xref:Microsoft.SqlServer.Management.Smo.Database> 클래스를 사용하여 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-207">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="7bb0e-208">자세한 내용은 [데이터베이스 생성, 변경 및 제거](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-208">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="7bb0e-209"><xref:Microsoft.SqlServer.Replication.TransSubscription> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-209">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransSubscription> class.</span></span>  
  
7.  <span data-ttu-id="7bb0e-210">다음 구독 속성을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-210">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="7bb0e-211"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 에 대해 1단계에서 만든 게시자에 대한 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A></span><span class="sxs-lookup"><span data-stu-id="7bb0e-211">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-212"><xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>에 대한 구독 데이터베이스 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-212">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-213"><xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>에 대한 구독자 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-213">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-214"><xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>에 대한 게시 데이터베이스 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-214">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-215"><xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>에 대한 게시 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-215">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-216">배포자에서 배포 에이전트가 실행되는 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 계정에 대한 자격 증명을 제공하는 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A>의 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 필드와 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> 또는 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> 필드.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-216">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Distribution Agent runs at the Distributor.</span></span> <span data-ttu-id="7bb0e-217">이 계정은 Windows 인증을 사용하여 배포자에 대한 로컬 연결 및 원격 연결을 만드는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-217">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7bb0e-218">`sysadmin` 고정 서버 역할의 멤버가 구독을 만들 때 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>를 설정할 필요는 없지만 설정해 두는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-218">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="7bb0e-219">이 경우 에이전트는 SQL Server 에이전트 계정을 가장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-219">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="7bb0e-220">자세한 내용은 [복제 에이전트 보안 모델](security/replication-agent-security-model.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-220">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="7bb0e-221">(옵션) 구독을 동기화하는 데 사용되는 에이전트 작업을 만드는 <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A>에 `true` 값(기본값).</span><span class="sxs-lookup"><span data-stu-id="7bb0e-221">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="7bb0e-222">`false`를 지정한 경우 구독은 프로그래밍 방식으로만 동기화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-222">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="7bb0e-223">(옵션) SQL Server 인증을 사용하여 구독자에 연결할 때 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 의 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 필드와 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> 또는 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 필드</span><span class="sxs-lookup"><span data-stu-id="7bb0e-223">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
8.  <span data-ttu-id="7bb0e-224"><xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-224">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7bb0e-225">원격 배포자가 있는 게시자에서 밀어넣기 구독을 만드는 경우 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>를 비롯한 모든 속성에 제공된 값이 일반 텍스트로 배포자에게 보내집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-225">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7bb0e-226"><xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> 메서드를 호출하기 전에 게시자와 해당 원격 배포자 간 연결을 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-226">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="7bb0e-227">자세한 내용은 [데이터베이스 엔진에 암호화 연결 사용&#40;SQL Server 구성 관리자&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-227">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
#### <a name="to-create-a-push-subscription-to-a-merge-publication"></a><span data-ttu-id="7bb0e-228">병합 게시에 밀어넣기 구독을 만들려면</span><span class="sxs-lookup"><span data-stu-id="7bb0e-228">To create a push subscription to a merge publication</span></span>  
  
1.  <span data-ttu-id="7bb0e-229"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 클래스를 사용하여 게시자 연결을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-229">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="7bb0e-230">1단계에서 만든 게시자 연결을 사용하여 <xref:Microsoft.SqlServer.Replication.MergePublication> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-230">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class by using the Publisher connection from step 1.</span></span> <span data-ttu-id="7bb0e-231"><xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>및 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-231">Specify <xref:Microsoft.SqlServer.Replication.Publication.Name%2A>, <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A>, and <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
3.  <span data-ttu-id="7bb0e-232"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-232">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method.</span></span> <span data-ttu-id="7bb0e-233">이 메서드가 `false`를 반환하는 경우 2단계에서 지정한 속성이 올바르지 않거나 서버에 게시가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-233">If this method returns `false`, either the properties specified in step 2 are incorrect or the publication does not exists on the server.</span></span>  
  
4.  <span data-ttu-id="7bb0e-234"><xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> 속성과 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush> 사이에서 비트 논리 AND(Visual C#의 `&` 및 Visual Basic의 `And`)를 수행합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-234">Perform a bitwise logical AND (`&` in Visual C# and `And` in Visual Basic) between the <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> property and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="7bb0e-235">결과가 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>이면 <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A>와 <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> 사이의 비트 논리 OR(Visual C#의 `|` 및 Visual Basic의 `Or`)의 결과에 대해 <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-235">If the result is <xref:Microsoft.SqlServer.Replication.PublicationAttributes.None>, set <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> to the result of a bitwise logical OR (`|` in Visual C# and `Or` in Visual Basic) between <xref:Microsoft.SqlServer.Replication.Publication.Attributes%2A> and <xref:Microsoft.SqlServer.Replication.PublicationAttributes.AllowPush>.</span></span> <span data-ttu-id="7bb0e-236">그런 다음 <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> 를 호출하여 밀어넣기 구독을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-236">Then, call <xref:Microsoft.SqlServer.Replication.ReplicationObject.CommitPropertyChanges%2A> to enable push subscriptions.</span></span>  
  
5.  <span data-ttu-id="7bb0e-237">구독 데이터베이스가 없는 경우 <xref:Microsoft.SqlServer.Management.Smo.Database> 클래스를 사용하여 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-237">If the subscription database does not exist, create it by using the <xref:Microsoft.SqlServer.Management.Smo.Database> class.</span></span> <span data-ttu-id="7bb0e-238">자세한 내용은 [데이터베이스 생성, 변경 및 제거](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-238">For more information, see [Creating, Altering, and Removing Databases](../server-management-objects-smo/tasks/creating-altering-and-removing-databases.md).</span></span>  
  
6.  <span data-ttu-id="7bb0e-239"><xref:Microsoft.SqlServer.Replication.MergeSubscription> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-239">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergeSubscription> class.</span></span>  
  
7.  <span data-ttu-id="7bb0e-240">다음 구독 속성을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-240">Set the following subscription properties:</span></span>  
  
    -   <span data-ttu-id="7bb0e-241"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 에 대해 1단계에서 만든 게시자에 대한 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A></span><span class="sxs-lookup"><span data-stu-id="7bb0e-241">The <xref:Microsoft.SqlServer.Management.Common.ServerConnection> to the Publisher created in step 1 for <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-242"><xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>에 대한 구독 데이터베이스 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-242">Name of the subscription database for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriptionDBName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-243"><xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>에 대한 구독자 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-243">Name of the Subscriber for <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-244"><xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>에 대한 게시 데이터베이스 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-244">Name of the publication database for <xref:Microsoft.SqlServer.Replication.Subscription.DatabaseName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-245"><xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>에 대한 게시 이름</span><span class="sxs-lookup"><span data-stu-id="7bb0e-245">Name of the publication for <xref:Microsoft.SqlServer.Replication.Subscription.PublicationName%2A>.</span></span>  
  
    -   <span data-ttu-id="7bb0e-246">배포자에서 병합 에이전트가 실행되는 [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows 계정에 대한 자격 증명을 제공하는 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A>의 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> 필드와 <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> 또는 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> 필드.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-246">The <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Login%2A> and <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.Password%2A> or <xref:Microsoft.SqlServer.Replication.IProcessSecurityContext.SecurePassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> to provide the credentials for the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows account under which the Merge Agent runs at the Distributor.</span></span> <span data-ttu-id="7bb0e-247">이 계정은 Windows 인증을 사용하여 배포자에 대한 로컬 연결 및 원격 연결을 만드는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-247">This account is used to make local connections to the Distributor and to make remote connections using Windows Authentication.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="7bb0e-248">`sysadmin` 고정 서버 역할의 멤버가 구독을 만들 때 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>를 설정할 필요는 없지만 설정해 두는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-248">Setting <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A> is not required when the subscription is created by a member of the `sysadmin` fixed server role, however it is recommended.</span></span> <span data-ttu-id="7bb0e-249">이 경우 에이전트는 SQL Server 에이전트 계정을 가장합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-249">In this case, the agent will impersonate the SQL Server Agent account.</span></span> <span data-ttu-id="7bb0e-250">자세한 내용은 [복제 에이전트 보안 모델](security/replication-agent-security-model.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-250">For more information, see [Replication Agent Security Model](security/replication-agent-security-model.md).</span></span>  
  
    -   <span data-ttu-id="7bb0e-251">(옵션) 구독을 동기화하는 데 사용되는 에이전트 작업을 만드는 <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A>에 `true` 값(기본값).</span><span class="sxs-lookup"><span data-stu-id="7bb0e-251">(Optional) A value of `true` (the default) for <xref:Microsoft.SqlServer.Replication.Subscription.CreateSyncAgentByDefault%2A> to create an agent job that is used to synchronize the subscription.</span></span> <span data-ttu-id="7bb0e-252">`false`를 지정한 경우 구독은 프로그래밍 방식으로만 동기화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-252">If you specify `false`, the subscription can only be synchronized programmatically.</span></span>  
  
    -   <span data-ttu-id="7bb0e-253">(옵션) SQL Server 인증을 사용하여 구독자에 연결할 때 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 의 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 필드와 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> 또는 <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> 필드</span><span class="sxs-lookup"><span data-stu-id="7bb0e-253">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.Subscription.SubscriberSecurity%2A> when using SQL Server Authentication to connect to the Subscriber.</span></span>  
  
    -   <span data-ttu-id="7bb0e-254">(옵션) SQL Server 인증을 사용하여 게시자에 연결할 때 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> 의 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> 필드와 <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> 또는 <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> 필드</span><span class="sxs-lookup"><span data-stu-id="7bb0e-254">(Optional) Set the <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardLogin%2A> and <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SqlStandardPassword%2A> or <xref:Microsoft.SqlServer.Replication.ConnectionSecurityContext.SecureSqlStandardPassword%2A> fields of <xref:Microsoft.SqlServer.Replication.PullSubscription.PublisherSecurity%2A> when using SQL Server Authentication to connect to the Publisher.</span></span>  
  
8.  <span data-ttu-id="7bb0e-255"><xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-255">Call the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="7bb0e-256">원격 배포자가 있는 게시자에서 밀어넣기 구독을 만드는 경우 <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>를 비롯한 모든 속성에 제공된 값이 일반 텍스트로 배포자에게 보내집니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-256">When creating a push subscription at a Publisher with a remote Distributor, the values supplied for all properties, including <xref:Microsoft.SqlServer.Replication.Subscription.SynchronizationAgentProcessSecurity%2A>, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="7bb0e-257"><xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> 메서드를 호출하기 전에 게시자와 해당 원격 배포자 간 연결을 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-257">You should encrypt the connection between the Publisher and its remote Distributor before calling the <xref:Microsoft.SqlServer.Replication.Subscription.Create%2A> method.</span></span> <span data-ttu-id="7bb0e-258">자세한 내용은 [데이터베이스 엔진에 암호화 연결 사용&#40;SQL Server 구성 관리자&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-258">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="7bb0e-259">예(RMO)</span><span class="sxs-lookup"><span data-stu-id="7bb0e-259">Examples (RMO)</span></span>  
 <span data-ttu-id="7bb0e-260">다음은 트랜잭션 게시에 _새 밀어넣기 구독을 만드는 예입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-260">This example creates a new push subscription to a transactional publication.</span></span> <span data-ttu-id="7bb0e-261">배포 에이전트 작업을 실행하는 데 사용되는 Windows 계정 자격 증명은 런타임에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-261">The Windows account credentials you use to run the Distribution Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateTranPushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createtranpushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateTranPushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createtranpushsub)]  
  
 <span data-ttu-id="7bb0e-262">다음은 병합 게시에 새 밀어넣기 구독을 만드는 예입니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-262">This example creates a new push subscription to a merge publication.</span></span> <span data-ttu-id="7bb0e-263">병합 에이전트 작업을 실행하는 데 사용되는 Windows 계정 자격 증명은 런타임에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="7bb0e-263">The Windows account credentials you use to run the Merge Agent job are passed at runtime.</span></span>  
  
 [!code-csharp[HowTo#rmo_CreateMergePushSub](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_createmergepushsub)]  
  
 [!code-vb[HowTo#rmo_vb_CreateMergePushSub](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_createmergepushsub)]  
  
## <a name="see-also"></a><span data-ttu-id="7bb0e-264">참고 항목</span><span class="sxs-lookup"><span data-stu-id="7bb0e-264">See Also</span></span>  
 <span data-ttu-id="7bb0e-265">[밀어넣기 구독 속성 보기 및 수정](view-and-modify-push-subscription-properties.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-265">[View and Modify Push Subscription Properties](view-and-modify-push-subscription-properties.md) </span></span>  
 <span data-ttu-id="7bb0e-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-266">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="7bb0e-267">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-267">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="7bb0e-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-268">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="7bb0e-269">[밀어넣기 구독 동기화](synchronize-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-269">[Synchronize a Push Subscription](synchronize-a-push-subscription.md) </span></span>  
 <span data-ttu-id="7bb0e-270">[Subscribe to Publications](subscribe-to-publications.md) </span><span class="sxs-lookup"><span data-stu-id="7bb0e-270">[Subscribe to Publications](subscribe-to-publications.md) </span></span>  
 [<span data-ttu-id="7bb0e-271">스크립팅 변수와 함께 sqlcmd 사용</span><span class="sxs-lookup"><span data-stu-id="7bb0e-271">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
