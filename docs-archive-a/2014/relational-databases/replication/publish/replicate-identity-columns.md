---
title: ID 열 복제 | Microsoft 문서
ms.custom: ''
ms.date: 10/04/2016
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- identities [SQL Server replication]
- identity values [SQL Server replication]
- merge replication [SQL Server replication], identity range management
- publishing [SQL Server replication], identity columns
- transactional replication, identity range management
- identity columns [SQL Server], replication
ms.assetid: eb2f23a8-7ec2-48af-9361-0e3cb87ebaf7
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: c899d902e403e9f7cdbdfd1a83cde110e627ab11
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87647596"
---
# <a name="replicate-identity-columns"></a><span data-ttu-id="18ef7-102">ID 열 복제</span><span class="sxs-lookup"><span data-stu-id="18ef7-102">Replicate Identity Columns</span></span>
  <span data-ttu-id="18ef7-103">열에 IDENTITY 속성을 할당하면 [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]는 ID 열을 포함하는 테이블에 순차적 개수대로 삽입되는 새 행을 자동으로 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-103">When you assign an IDENTITY property to a column, [!INCLUDE[msCoName](../../../includes/msconame-md.md)] [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] automatically generates sequential numbers for new rows inserted in the table containing the identity column.</span></span> <span data-ttu-id="18ef7-104">자세한 내용은 [IDENTITY&#40;속성&#41;&#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="18ef7-104">For more information, see [IDENTITY &#40;Property&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property).</span></span> <span data-ttu-id="18ef7-105">ID 열은 기본 키의 일부분으로 포함될 수 있으므로 ID 열에 중복 값을 사용하지 않아야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-105">Because identity columns might be included as a part of the primary key, it is important to avoid duplicate values in the identity columns.</span></span> <span data-ttu-id="18ef7-106">둘 이상의 노드에서 업데이트된 ID 열을 복제 토폴로지에서 사용하려면 복제 토폴로지의 각 노드가 다른 범위의 ID 값을 사용해야 중복이 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-106">To use identity columns in a replication topology that has updates at more than one node, each node in the replication topology must use a different range of identity values, so that duplicates do not occur.</span></span>  
  
 <span data-ttu-id="18ef7-107">예를 들어 게시자에 1-100 범위, 구독자 A에 101-200 범위, 그리고 구독자 B에 201-300 범위를 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-107">For example, the Publisher could be assigned the range 1-100, Subscriber A the range 101-200, and Subscriber B the range 201-300.</span></span> <span data-ttu-id="18ef7-108">예를 들어 게시자에 행이 삽입되고 ID 값이 65라면 이 값이 각 구독자에 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-108">If a row is inserted at the Publisher and the identity value is, for example, 65, that value is replicated to each Subscriber.</span></span> <span data-ttu-id="18ef7-109">복제가 각 구독자에 데이터를 삽입할 때 구독자 테이블의 ID 열 값을 증가시키지는 않습니다. 대신 리터럴 값 65가 삽입됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-109">When replication inserts data at each Subscriber, it does not increment the identity column value in the Subscriber table; instead, the literal value 65 is inserted.</span></span> <span data-ttu-id="18ef7-110">복제 에이전트 삽입이 아닌 사용자 삽입만 ID 열 값을 증가시킵니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-110">Only user inserts, but not replication agent inserts cause the identity column value to be incremented.</span></span>  
  
 <span data-ttu-id="18ef7-111">복제는 모든 게시 및 구독 유형에서 ID 열을 처리하므로 사용자가 열을 수동으로 관리하거나 복제를 통해 자동으로 관리되도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-111">Replication handles identity columns across all publication and subscription types, allowing you to manage the columns manually or have replication manage them automatically.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="18ef7-112">열이 구독자로 복제될 때 데이터가 일치하지 않을 수 있기 때문에 게시된 테이블에 ID 열을 추가할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-112">Adding an identity column to a published table is not supported, because it can result in non-convergence when the column is replicated to the Subscriber.</span></span> <span data-ttu-id="18ef7-113">게시자의 ID 열 값은 영향을 받는 테이블 행이 실제로 저장된 순서에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-113">The values in the identity column at the Publisher depend on the order in which the rows for the affected table are physically stored.</span></span> <span data-ttu-id="18ef7-114">구독자에서는 행이 다르게 저장될 수 있으므로 ID 열의 값이 같은 행에 대해 다를 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-114">The rows might be stored differently at the Subscriber; therefore the value for the identity column can be different for the same rows.</span></span>  
  
## <a name="specifying-an-identity-range-management-option"></a><span data-ttu-id="18ef7-115">ID 범위 관리 옵션 지정</span><span class="sxs-lookup"><span data-stu-id="18ef7-115">Specifying an Identity Range Management Option</span></span>  
 <span data-ttu-id="18ef7-116">복제는 3가지 ID 범위 관리 옵션을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-116">Replication offers three identity range management options:</span></span>  
  
-   <span data-ttu-id="18ef7-117">자동.</span><span class="sxs-lookup"><span data-stu-id="18ef7-117">Automatic.</span></span> <span data-ttu-id="18ef7-118">구독자에서 업데이트를 수행하는 병합 복제 및 트랜잭션 복제에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-118">Used for merge replication and transactional replication with updates at the Subscriber.</span></span> <span data-ttu-id="18ef7-119">게시자 및 구독자에 대한 크기 범위를 지정하면 복제는 새 범위의 할당을 자동으로 관리합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-119">Specify size ranges for the Publisher and Subscribers, and replication automatically manages the assignment of new ranges.</span></span> <span data-ttu-id="18ef7-120">복제는 구독자의 ID 열에 NOT FOR REPLICATION 옵션을 설정하므로 사용자 삽입만 구독자에서 값을 증가시킬 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-120">Replication sets the NOT FOR REPLICATION option on the identity column at the Subscriber, so that only user inserts cause the value to be incremented at the Subscriber.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="18ef7-121">구독자는 게시자와 동기화해야 새 범위를 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-121">Subscribers must synchronize with the Publisher to receive new ranges.</span></span> <span data-ttu-id="18ef7-122">구독자에게는 ID 범위가 자동으로 할당되므로 구독자가 계속해서 새 범위를 요청할 경우 전체 ID 범위 공급이 중단될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-122">Because Subscribers are assigned identity ranges automatically, it is possible for any Subscriber to exhaust the entire supply of identity ranges if it repeatedly requests new ranges.</span></span>  
  
-   <span data-ttu-id="18ef7-123">수동.</span><span class="sxs-lookup"><span data-stu-id="18ef7-123">Manual.</span></span> <span data-ttu-id="18ef7-124">구독자에서 업데이트를 수행하지 않는 스냅샷 복제와 트랜잭션 복제 또는 피어 투 피어 트랜잭션 복제에 사용되거나 애플리케이션이 ID 범위를 프로그래밍 방식으로 제어해야 할 경우 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-124">Used for snapshot and transactional replication without updates at the Subscriber, peer-to-peer transactional replication, or if your application must control identity ranges programmatically.</span></span> <span data-ttu-id="18ef7-125">수동 관리를 지정하면 범위가 게시자 및 각 구독자에 할당되었는지 확인하고 초기 범위가 사용된 경우에는 새 범위가 할당되었는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-125">If you specify manual management, you must ensure that ranges are assigned to the Publisher and each Subscriber and that new ranges are assigned if the initial ranges are used.</span></span> <span data-ttu-id="18ef7-126">복제는 구독자의 ID 열에 NOT FOR REPLICATION 옵션을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-126">Replication sets the NOT FOR REPLICATION option on the identity column at the Subscriber.</span></span>  
  
-   <span data-ttu-id="18ef7-127">없음</span><span class="sxs-lookup"><span data-stu-id="18ef7-127">None.</span></span> <span data-ttu-id="18ef7-128">이 옵션은 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 이전 버전과의 호환성을 위해서만 권장되며 트랜잭션 게시용 저장 프로시저 인터페이스에서만 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-128">This option is recommended only for backwards compatibility with earlier versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] and is available only from the stored procedure interface for transactional publications.</span></span>  
  
 <span data-ttu-id="18ef7-129">ID 범위 관리 옵션을 지정하려면 [ID 열 관리](manage-identity-columns.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="18ef7-129">To specify an identity range management option, see [Manage Identity Columns](manage-identity-columns.md).</span></span>  
  
## <a name="assigning-identity-ranges"></a><span data-ttu-id="18ef7-130">ID 범위 할당</span><span class="sxs-lookup"><span data-stu-id="18ef7-130">Assigning Identity Ranges</span></span>  
 <span data-ttu-id="18ef7-131">병합 복제 및 트랜잭션 복제는 여러 가지 방법으로 범위를 할당합니다. 이 섹션에서는 3가지 방법을 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-131">Merge replication and transactional replication use different methods for assigning ranges; these methods are described in this section.</span></span>  
  
 <span data-ttu-id="18ef7-132">ID 열을 복제하는 경우에는 두 가지 범위, 즉 게시자와 구독자에 할당된 범위와 열의 데이터 형식 범위를 고려해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-132">There are two types of ranges to take into account when replicating identity columns: the ranges assigned to the Publisher and Subscribers, and the range of the data type in the column.</span></span> <span data-ttu-id="18ef7-133">다음 표에서는 일반적으로 ID 열에 사용되는 데이터 형식에 사용할 수 있는 범위를 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-133">The following table shows the ranges available for the data types typically used in identity columns.</span></span> <span data-ttu-id="18ef7-134">범위는 토폴로지의 모든 노드에서 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-134">The range is used across all nodes in a topology.</span></span> <span data-ttu-id="18ef7-135">예를 들어 `smallint` 1에서 시작 하 여 1 씩 증가 하는 경우 게시자 및 모든 구독자에 대 한 최대 삽입 수는 32767입니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-135">For example, if you use `smallint` starting at 1 with an increment of 1, the maximum number of inserts is 32,767 for the Publisher and all Subscribers.</span></span> <span data-ttu-id="18ef7-136">실제 삽입 수는 사용된 값에 차이가 있는지 여부와 임계값이 사용되는지 여부에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-136">The actual number of inserts depends on whether there are gaps in the values used and whether a threshold value is used.</span></span> <span data-ttu-id="18ef7-137">임계값에 대한 자세한 내용은 이 항목의 뒷부분에 나올 "병합 복제" 및 "지연 업데이트 구독이 있는 트랜잭션 복제" 섹션을 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="18ef7-137">For more information about thresholds, see the following sections "Merge Replication" and "Transactional Replication with Queued Updating Subscriptions".</span></span>  
  
 <span data-ttu-id="18ef7-138">**db_owner** 고정 데이터베이스 역할의 멤버가 삽입을 수행했으면 게시자가 삽입 후 ID 범위를 모두 사용한 경우 구독자가 자동으로 새 범위를 할당할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-138">If the Publisher exhausts its identity range after an insert, it can automatically assign a new range if the insert was performed by a member of the **db_owner** fixed database role.</span></span> <span data-ttu-id="18ef7-139">해당 역할의 사용자가 아닌 사용자가 삽입을 수행했으면 로그 판독기 에이전트, 병합 에이전트 또는 **db_owner** 역할의 멤버인 사용자가 [sp_adjustpublisheridentityrange&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql)를 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-139">If the insert was performed by a user not in that role, the Log Reader Agent, Merge Agent, or a user who is a member of the **db_owner** role must run [sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql).</span></span> <span data-ttu-id="18ef7-140">트랜잭션 게시의 경우 새 범위를 자동으로 할당하려면 로그 판독기 에이전트가 실행되고 있어야 합니다. 기본적으로 에이전트는 계속 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-140">For transactional publications, the Log Reader Agent must be running to automatically allocate a new range (the default is for the agent to run continuously).</span></span>  
  
> [!WARNING]  
>  <span data-ttu-id="18ef7-141">큰 일괄 처리 동안 복제 트리거 삽입은 삽입의 각 행에 대해 한 번만 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-141">During a large batch insert the replication trigger is fired only once, not for each row of the insert.</span></span> <span data-ttu-id="18ef7-142">ID 범위가 큰 삽입 시 사용되는 경우 `INSERT INTO` 문과 같은 insert 문이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-142">This can lead to a failure of the insert statement if an identity range is exhausted during an large insert, such as an `INSERT INTO` statement.</span></span>  
  
|<span data-ttu-id="18ef7-143">데이터 형식</span><span class="sxs-lookup"><span data-stu-id="18ef7-143">Data type</span></span>|<span data-ttu-id="18ef7-144">범위</span><span class="sxs-lookup"><span data-stu-id="18ef7-144">Range</span></span>|  
|---------------|-----------|  
|`tinyint`|<span data-ttu-id="18ef7-145">자동 관리에서 지원되지 않음</span><span class="sxs-lookup"><span data-stu-id="18ef7-145">Not supported for automatic management</span></span>|  
|`smallint`|<span data-ttu-id="18ef7-146">-2^15(-32,768) ~ 2^15-1(32,767)</span><span class="sxs-lookup"><span data-stu-id="18ef7-146">-2^15 (-32,768) to 2^15-1 (32,767)</span></span>|  
|`int`|<span data-ttu-id="18ef7-147">-2^31(-2,147,483,648) ~ 2^31-1(2,147,483,647)</span><span class="sxs-lookup"><span data-stu-id="18ef7-147">-2^31 (-2,147,483,648) to 2^31-1 (2,147,483,647)</span></span>|  
|`bigint`|<span data-ttu-id="18ef7-148">-2^63(-9,223,372,036,854,775,808) ~ 2^63-1(9,223,372,036,854,775,807)</span><span class="sxs-lookup"><span data-stu-id="18ef7-148">-2^63 (-9,223,372,036,854,775,808) to 2^63-1 (9,223,372,036,854,775,807)</span></span>|  
|<span data-ttu-id="18ef7-149">`decimal` 및 `numeric`</span><span class="sxs-lookup"><span data-stu-id="18ef7-149">`decimal` and `numeric`</span></span>|<span data-ttu-id="18ef7-150">-10^38+1 ~ 10^38-1</span><span class="sxs-lookup"><span data-stu-id="18ef7-150">-10^38+1 through 10^38-1</span></span>|  
  
> [!NOTE]  
>  <span data-ttu-id="18ef7-151">여러 테이블에서 사용할 수 있거나 테이블을 참조하지 않고 애플리케이션에서 호출할 수 있는 자동으로 증가하는 번호를 만들려면 [시퀀스 번호](../../sequence-numbers/sequence-numbers.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="18ef7-151">To create an automatically incrementing number that can be used in multiple tables or that can be called from applications without referencing any table, see [Sequence Numbers](../../sequence-numbers/sequence-numbers.md).</span></span>  
  
### <a name="merge-replication"></a><span data-ttu-id="18ef7-152">병합 복제</span><span class="sxs-lookup"><span data-stu-id="18ef7-152">Merge Replication</span></span>  
 <span data-ttu-id="18ef7-153">ID 범위는 게시자에 의해 관리되고 병합 에이전트에 의해 구독자로 전파됩니다. 재게시 계층에서는 범위가 루트 게시자와 재게시자에 의해 관리됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-153">Identity ranges are managed by the Publisher and propagated to Subscribers by the Merge Agent (in a republishing hierarchy, ranges are managed by the root Publisher and the republishers).</span></span> <span data-ttu-id="18ef7-154">ID 값은 게시자의 풀에서 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-154">The identity values are assigned from a pool at the Publisher.</span></span> <span data-ttu-id="18ef7-155">새 게시 마법사 또는 [sp_addmergearticle&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql)을 사용하여 ID 열이 있는 아티클을 게시에 추가할 경우 다음에 대한 값을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-155">When you add an article with an identity column to a publication in the New Publication Wizard or by using [sp_addmergearticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addmergearticle-transact-sql), you specify values for:</span></span>  
  
-   <span data-ttu-id="18ef7-156">\*\* \@ Identity_range\*\* 매개 변수는 게시자와 클라이언트 구독이 있는 구독자 모두에 초기에 할당 되는 id 범위 크기를 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-156">The **\@identity_range** parameter, which controls the identity range size initially allocated both to the Publisher and to Subscribers with client subscriptions.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="18ef7-157">이전 버전의를 실행 하는 구독자의 경우 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] \*\* \@ pub_identity_range\*\* 매개 변수 대신이 매개 변수는 재게시 구독자 에서도 id 범위 크기를 제어 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-157">For Subscribers running previous versions of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)], this parameter (rather than the **\@pub_identity_range** parameter) also controls the identity range size at republishing Subscribers.</span></span>  
  
-   <span data-ttu-id="18ef7-158">서버 구독을 사용 하 여 구독자에 할당 된 재게시의 id 범위 크기를 제어 하는 \*\* \@ pub_identity_range\*\* 매개 변수입니다 (데이터를 재게시 하는 데 필요).</span><span class="sxs-lookup"><span data-stu-id="18ef7-158">The **\@pub_identity_range** parameter, which controls the identity range size for republishing allocated to Subscribers with server subscriptions (required for republishing data).</span></span> <span data-ttu-id="18ef7-159">구독 유형이 서버 구독인 모든 구독자는 실제로 데이터를 재게시하지 않더라도 재게시 작업을 위한 범위를 받습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-159">All Subscribers with server subscriptions receive a range for republishing, even if they don't actually republish data.</span></span>  
  
-   <span data-ttu-id="18ef7-160">\*\* \@ 임계값\*\* 매개 변수- [!INCLUDE[ssEW](../../../includes/ssew-md.md)] 또는 이전 버전의에 대 한 구독에 새 id 범위가 필요한 시기를 결정 하는 데 사용 됩니다 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] .</span><span class="sxs-lookup"><span data-stu-id="18ef7-160">The **\@threshold** parameter, which is used to determine when a new range of identities is required for a subscription to [!INCLUDE[ssEW](../../../includes/ssew-md.md)] or a previous version of [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span>  
  
 <span data-ttu-id="18ef7-161">예를 들어 50만 \*\* \@ identity_range\*\* \*\* \@ pub_identity_range\*\*에 대해 1만을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-161">For example, you could specify 10000 for **\@identity_range** and 500000 for **\@pub_identity_range**.</span></span> <span data-ttu-id="18ef7-162">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 이상 버전을 실행하는 게시자 및 모든 구독자(구독 유형이 서버 구독인 구독자 포함)에게 기본 범위 10000이 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-162">The Publisher and all Subscribers running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version, including the Subscriber with the server subscription, are assigned a primary range of 10000.</span></span> <span data-ttu-id="18ef7-163">서버 구독이 있는 구독자에는 재게시 구독자와 동기화 하는 구독자가 사용할 수 있는 50만의 기본 범위가 할당 됩니다. 또한 재게시 구독자에서 게시의 아티클에 대 한 \*\* \@ identity_range**, \*\* \@ pub_identity_range**및 \*\* \@ 임계값\*\* 을 지정 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-163">The Subscriber with the server subscription is also assigned a primary range of 500000, which can be used by Subscribers that synchronize with the republishing Subscriber (you must also specify **\@identity_range**, **\@pub_identity_range**, and **\@threshold** for the articles in the publication at the republishing Subscriber).</span></span>  
  
 <span data-ttu-id="18ef7-164">[!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] 이상을 실행하는 각 구독자는 보조 ID 범위도 받습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-164">Each Subscriber running [!INCLUDE[ssVersion2005](../../../includes/ssversion2005-md.md)] or a later version also receives a secondary identity range.</span></span> <span data-ttu-id="18ef7-165">보조 범위의 크기는 주 범위의 크기와 같습니다. 주 범위를 모두 사용하면 보조 범위가 사용되고 병합 에이전트가 구독자에 새 범위를 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-165">The secondary range is equal in size to the primary range; when the primary range is exhausted, the secondary range is used, and the Merge Agent assigns a new range to the Subscriber.</span></span> <span data-ttu-id="18ef7-166">새 범위는 보조 범위가 되고 구독자가 ID 값을 사용하는 한 프로세스는 계속 진행됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-166">The new range becomes the secondary range, and the process continues as the Subscriber uses identity values.</span></span>  
  
  
### <a name="transactional-replication-with-queued-updating-subscriptions"></a><span data-ttu-id="18ef7-167">지연 업데이트 구독이 있는 트랜잭션 복제</span><span class="sxs-lookup"><span data-stu-id="18ef7-167">Transactional Replication with Queued Updating Subscriptions</span></span>  
 <span data-ttu-id="18ef7-168">ID 범위는 배포자에 의해 관리되고 배포 에이전트에 의해 구독자로 전파됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-168">Identity ranges are managed by the Distributor and propagated to Subscribers by the Distribution Agent.</span></span> <span data-ttu-id="18ef7-169">ID 값은 배포자의 풀에서 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-169">The identity values are assigned from a pool at the Distributor.</span></span> <span data-ttu-id="18ef7-170">풀 크기는 데이터 형식의 크기와 ID 열에 사용되는 증가값을 기반으로 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-170">The pool size is based on the size of the data type and the increment used for the identity column.</span></span> <span data-ttu-id="18ef7-171">새 게시 마법사 또는 [sp_addarticle&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql)을 사용하여 ID 열이 있는 아티클을 게시에 추가할 경우 다음에 대한 값을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-171">When you add an article with an identity column to a publication in the New Publication Wizard or by using [sp_addarticle &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addarticle-transact-sql), you specify values for:</span></span>  
  
-   <span data-ttu-id="18ef7-172">모든 구독자에 초기에 할당 되는 id 범위 크기를 제어 하는 \*\* \@ identity_range\*\* 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-172">The **\@identity_range** parameter, which controls the identity range size initially allocated to all Subscribers.</span></span>  
  
-   <span data-ttu-id="18ef7-173">게시자에 할당 된 id 범위 크기를 제어 하는 \*\* \@ pub_identity_range\*\* 매개 변수입니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-173">The **\@pub_identity_range** parameter, which controls the identity range size allocated to the Publisher.</span></span>  
  
-   <span data-ttu-id="18ef7-174">\*\* \@ 임계값\*\* 매개 변수-구독에 새 id 범위가 필요한 시기를 결정 하는 데 사용 됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-174">The **\@threshold** parameter, which is used to determine when a new range of identities is required for a subscription.</span></span>  
  
 <span data-ttu-id="18ef7-175">예를 들어 \*\* \@ pub_identity_range**에 대해 1만 \*\* \@ identity_range** 1000을 지정 하 고 (구독자에서 업데이트 수를 줄이는 경우), \*\* \@ 임계값\*\*에 대해 80%를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-175">For example, you could specify 10000 for **\@pub_identity_range**, 1000 for **\@identity_range** (assuming fewer updates at the Subscriber), and 80 percent for **\@threshold**.</span></span> <span data-ttu-id="18ef7-176">구독자에서 800(1000의 80%)이 삽입되면 구독자에 새 범위가 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-176">After 800 inserts at a Subscriber (80 percent of 1000), a Subscriber is assigned a new range.</span></span> <span data-ttu-id="18ef7-177">게시자에서 8000이 삽입되면 게시자에 새 범위가 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-177">After 8000 inserts at the Publisher, the Publisher is assigned a new range.</span></span> <span data-ttu-id="18ef7-178">새 범위를 지정하면 테이블의 ID 범위 값에 간격이 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-178">When a new range is assigned, there will be a gap in the identity range values in the table.</span></span> <span data-ttu-id="18ef7-179">더 높은 임계값을 지정하면 이러한 간격이 줄어들지만 시스템의 내결함성이 저하됩니다. 어떤 이유로든 배포 에이전트를 실행할 수 없으면 구독자에서 ID가 보다 빠른 속도로 줄어들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-179">Specifying a higher threshold results in smaller gaps, but the system is less fault-tolerant: if the Distribution Agent cannot run for some reason, a Subscriber could more easily run out of identities.</span></span>  
  
## <a name="assigning-ranges-for-manual-identity-range-management"></a><span data-ttu-id="18ef7-180">ID 범위 수동 관리를 위한 범위 할당</span><span class="sxs-lookup"><span data-stu-id="18ef7-180">Assigning ranges for manual identity range management</span></span>  
 <span data-ttu-id="18ef7-181">ID 범위 수동 관리를 지정할 경우 게시자와 각 구독자가 서로 다른 ID 범위를 사용하고 있는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-181">If you specify manual identity range management, you must ensure that the Publisher and each Subscriber use different identity ranges.</span></span> <span data-ttu-id="18ef7-182">예를 들어 게시자에 있는 테이블의 ID 열이 `IDENTITY(1,1)`로 정의되어 있다고 가정합니다. 이 ID 열은 1에서 시작하고 행이 삽입될 때마다 1씩 증가합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-182">For example, consider a table at the Publisher with an identity column defined as `IDENTITY(1,1)`: the identity column starts at 1 and is incremented by 1 each time a row is inserted.</span></span> <span data-ttu-id="18ef7-183">게시자의 테이블에 5,000개의 행이 있고 애플리케이션 수명 동안 테이블이 얼마간 커질 것으로 예상되는 경우 게시자는 1-10,000 범위를 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-183">If the table at the Publisher has 5,000 rows, and you expect some growth in the table over the life of the application, the Publisher could use the range 1-10,000.</span></span> <span data-ttu-id="18ef7-184">두 구독자가 있는 경우 구독자 A는 10,001-20,000을 사용하고 구독자 B는 20,001-30,000을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-184">Given two Subscribers, Subscriber A could use 10,001-20,000, and Subscriber B could use 20,001-30,000.</span></span>  
  
 <span data-ttu-id="18ef7-185">스냅샷 또는 다른 방법으로 구독자가 초기화되면 DBCC CHECKIDENT를 실행하여 구독자에게 해당 ID 범위의 시작 지점을 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-185">After a Subscriber is initialized with a snapshot or through another means, execute DBCC CHECKIDENT to assign the Subscriber a starting point for its identity range.</span></span> <span data-ttu-id="18ef7-186">예를 들어 구독자 A에서 `DBCC CHECKIDENT('<TableName>','reseed',10001)`를 실행하고</span><span class="sxs-lookup"><span data-stu-id="18ef7-186">For example, at Subscriber A, you would execute `DBCC CHECKIDENT('<TableName>','reseed',10001)`.</span></span> <span data-ttu-id="18ef7-187">구독자 B에서 `CHECKIDENT('<TableName>','reseed',20001)`를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-187">At Subscriber B, you would execute `CHECKIDENT('<TableName>','reseed',20001)`.</span></span>  
  
 <span data-ttu-id="18ef7-188">게시자 또는 구독자에 새 범위를 할당하려면 DBCC CHECKIDENT를 실행하고 새 값을 지정하여 테이블의 초기값을 다시 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-188">To assign new ranges to the Publisher or Subscribers, execute DBCC CHECKIDENT and specify a new value to reseed the table.</span></span> <span data-ttu-id="18ef7-189">새 범위를 할당해야 하는 시기를 결정하는 몇 가지 방법이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-189">You should have some way to determine when a new range must be assigned.</span></span> <span data-ttu-id="18ef7-190">예를 들어 애플리케이션에 노드가 범위를 거의 다 사용하는 시기를 감지하고 DBCC CHECKIDENT를 사용하여 새 범위를 할당하는 메커니즘이 있을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-190">For example, your application could have a mechanism that detects when a node is about to use up its range and assign a new range using DBCC CHECKIDENT.</span></span> <span data-ttu-id="18ef7-191">또한 범위를 벗어나는 ID 값이 사용되는 경우 행을 추가할 수 없도록 하는 CHECK 제약 조건을 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-191">You can also add a check constraint to ensure that a row cannot be added if it would cause an out of range identity value to be used.</span></span>  
  
## <a name="handling-identity-ranges-after-a-database-restore"></a><span data-ttu-id="18ef7-192">데이터베이스 복원 후 ID 범위 처리</span><span class="sxs-lookup"><span data-stu-id="18ef7-192">Handling Identity Ranges after a Database Restore</span></span>  
 <span data-ttu-id="18ef7-193">ID 범위 자동 관리를 사용하는 경우 백업에서 구독자를 복원하면 구독자가 자동으로 새 ID 값 범위를 요청합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-193">If you are using automatic identity range management, when a Subscriber is restored from a backup, it automatically requests a new range of identity values.</span></span> <span data-ttu-id="18ef7-194">백업에서 게시자가 복원되는 경우에는 게시자에 적절한 범위가 할당되었는지 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-194">If a Publisher is restored from a backup, you must ensure that the Publisher is assigned an appropriate range.</span></span> <span data-ttu-id="18ef7-195">병합 복제의 경우 [sp_restoremergeidentityrange&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-restoremergeidentityrange-transact-sql)를 사용하여 새 범위를 할당합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-195">For merge replication, assign a new range using [sp_restoremergeidentityrange &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-restoremergeidentityrange-transact-sql).</span></span> <span data-ttu-id="18ef7-196">트랜잭션 복제의 경우 사용된 값 중 가장 높은 값을 확인한 후 새 범위의 시작 지점을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-196">For transactional replication, determine the highest value that has been used and then set the starting point for new ranges.</span></span> <span data-ttu-id="18ef7-197">게시 데이터베이스가 복원된 후 다음 절차를 따르십시오.</span><span class="sxs-lookup"><span data-stu-id="18ef7-197">Use the following procedure after the publication database has been restored:</span></span>  
  
1.  <span data-ttu-id="18ef7-198">모든 구독자에서 모든 작업을 중지합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-198">Stop all activity on all Subscribers.</span></span>  
  
2.  <span data-ttu-id="18ef7-199">ID 열을 포함하는 게시된 각 테이블의 경우에는 다음을 수행하십시오.</span><span class="sxs-lookup"><span data-stu-id="18ef7-199">For each published table that includes an identity column:</span></span>  
  
    1.  <span data-ttu-id="18ef7-200">각 구독자의 구독 데이터베이스에서 `IDENT_CURRENT('<TableName>')`를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-200">In the subscription database at each Subscriber, execute `IDENT_CURRENT('<TableName>')`.</span></span>  
  
    2.  <span data-ttu-id="18ef7-201">모든 구독자에서 발견된 값 중 가장 높은 값을 기록합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-201">Record the highest value found across all Subscribers.</span></span>  
  
    3.  <span data-ttu-id="18ef7-202">게시자의 게시 데이터베이스에서 `DBCC CHECKIDENT(<TableName>','reseed',<HighestValueFound+1>`)를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-202">In the publication database at the Publisher, execute `DBCC CHECKIDENT(<TableName>','reseed',<HighestValueFound+1>`).</span></span>  
  
    4.  <span data-ttu-id="18ef7-203">게시자의 게시 데이터베이스에서 `sp_adjustpublisheridentityrange <PublicationName>, <TableName>`를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-203">In the publication database at the Publisher, execute `sp_adjustpublisheridentityrange <PublicationName>, <TableName>`.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="18ef7-204">ID 열의 값이 증가값이 아닌 감소값으로 설정되면 발견된 값 중 가장 낮은 값을 기록하고 해당 값으로 초기값을 다시 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="18ef7-204">If the value in the identity column is set to decrement rather than increment, record the lowest value found, and then reseed with that value.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="18ef7-205">참고 항목</span><span class="sxs-lookup"><span data-stu-id="18ef7-205">See Also</span></span>  
 <span data-ttu-id="18ef7-206">[BACKUP&#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="18ef7-206">[BACKUP &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-transact-sql) </span></span>  
 <span data-ttu-id="18ef7-207">[DBCC CHECKIDENT&#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="18ef7-207">[DBCC CHECKIDENT &#40;Transact-SQL&#41;](/sql/t-sql/database-console-commands/dbcc-checkident-transact-sql) </span></span>  
 <span data-ttu-id="18ef7-208">[IDENT_CURRENT&#40;Transact-SQL&#41;](/sql/t-sql/functions/ident-current-transact-sql) </span><span class="sxs-lookup"><span data-stu-id="18ef7-208">[IDENT_CURRENT &#40;Transact-SQL&#41;](/sql/t-sql/functions/ident-current-transact-sql) </span></span>  
 <span data-ttu-id="18ef7-209">[IDENTITY&#40;속성&#41;&#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property) </span><span class="sxs-lookup"><span data-stu-id="18ef7-209">[IDENTITY &#40;Property&#41; &#40;Transact-SQL&#41;](/sql/t-sql/statements/create-table-transact-sql-identity-property) </span></span>  
 [<span data-ttu-id="18ef7-210">sp_adjustpublisheridentityrange&#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="18ef7-210">sp_adjustpublisheridentityrange &#40;Transact-SQL&#41;</span></span>](/sql/relational-databases/system-stored-procedures/sp-adjustpublisheridentityrange-transact-sql)  
  
  
