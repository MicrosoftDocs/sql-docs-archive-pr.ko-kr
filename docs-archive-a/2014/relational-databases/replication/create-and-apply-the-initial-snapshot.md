---
title: 초기 스냅샷 만들기 및 적용 | Microsoft 문서
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: replication
ms.topic: conceptual
helpviewer_keywords:
- snapshots [SQL Server replication], creating
- snapshot replication [SQL Server], initial snapshots
ms.assetid: 742727a1-5189-44ec-b3ae-6fd7aa1f5347
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: b7ac008fe139adf55376bb50fbf60dddcd6b9ae5
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87646938"
---
# <a name="create-and-apply-the-initial-snapshot"></a><span data-ttu-id="780f2-102">Create and Apply the Initial Snapshot</span><span class="sxs-lookup"><span data-stu-id="780f2-102">Create and Apply the Initial Snapshot</span></span>
  <span data-ttu-id="780f2-103">이 항목에서는 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] , [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)]또는 RMO(복제 관리 개체)를 사용하여 [!INCLUDE[tsql](../../includes/tsql-md.md)]에서 초기 스냅샷을 만들고 적용하는 방법에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-103">This topic describes how to create and apply the initial snapshot in [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] by using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)], [!INCLUDE[tsql](../../includes/tsql-md.md)], or Replication Management Objects (RMO).</span></span> <span data-ttu-id="780f2-104">매개 변수가 있는 필터를 사용하는 병합 게시에는 두 부분으로 구성된 스냅샷이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-104">Merge publications that use parameterized filters require a two-part snapshot.</span></span> <span data-ttu-id="780f2-105">자세한 내용은 [매개 변수가 있는 필터로 병합 게시에 대한 스냅샷 만들기](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-105">For more information, see [Create a Snapshot for a Merge Publication with Parameterized Filters](create-a-snapshot-for-a-merge-publication-with-parameterized-filters.md).</span></span>  
  
 <span data-ttu-id="780f2-106">**항목 내용**</span><span class="sxs-lookup"><span data-stu-id="780f2-106">**In This Topic**</span></span>  
  
-   <span data-ttu-id="780f2-107">**다음을 사용하여 초기 스냅샷을 만들고 적용하려면**</span><span class="sxs-lookup"><span data-stu-id="780f2-107">**To create and apply the initial snapshot, using:**</span></span>  
  
     [<span data-ttu-id="780f2-108">SQL Server Management Studio</span><span class="sxs-lookup"><span data-stu-id="780f2-108">SQL Server Management Studio</span></span>](#SSMSProcedure)  
  
     [<span data-ttu-id="780f2-109">Transact-SQL</span><span class="sxs-lookup"><span data-stu-id="780f2-109">Transact-SQL</span></span>](#TsqlProcedure)  
  
     [<span data-ttu-id="780f2-110">RMO(복제 관리 개체)</span><span class="sxs-lookup"><span data-stu-id="780f2-110">Replication Management Objects (RMO)</span></span>](#RMOProcedure)  
  
##  <a name="using-sql-server-management-studio"></a><a name="SSMSProcedure"></a> <span data-ttu-id="780f2-111">SQL Server Management Studio 사용</span><span class="sxs-lookup"><span data-stu-id="780f2-111">Using SQL Server Management Studio</span></span>  
 <span data-ttu-id="780f2-112">기본적으로 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 에이전트가 실행 중이면 새 게시 마법사로 게시를 만든 직후 스냅샷 에이전트에서 스냅샷을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-112">By default, if [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Agent is running, a snapshot is generated by the Snapshot Agent immediately after a publication is created with the New Publication Wizard.</span></span> <span data-ttu-id="780f2-113">이렇게 생성된 스냅샷은 기본적으로 모든 구독에 대해 배포 에이전트(스냅샷 및 트랜잭션 복제의 경우)나 병합 에이전트(병합 구독의 경우)에 의해 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-113">By default, it is then applied by the Distribution Agent (for snapshot and transactional replication) or Merge Agent (for merge subscriptions) for all subscriptions.</span></span> <span data-ttu-id="780f2-114">스냅샷은 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 및 복제 모니터를 사용하여 생성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-114">A snapshot can also be generated using [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] and Replication Monitor.</span></span> <span data-ttu-id="780f2-115">복제 모니터를 시작하는 방법은 [복제 모니터 시작](monitor/start-the-replication-monitor.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-115">For information about starting Replication Monitor, see [Start the Replication Monitor](monitor/start-the-replication-monitor.md).</span></span>  
  
#### <a name="to-create-a-snapshot-in-management-studio"></a><span data-ttu-id="780f2-116">Management Studio에서 스냅샷을 만들려면</span><span class="sxs-lookup"><span data-stu-id="780f2-116">To create a snapshot in Management Studio</span></span>  
  
1.  <span data-ttu-id="780f2-117">[!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)]에서 게시자에 연결한 다음 해당 서버 노드를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-117">Connect to the Publisher in [!INCLUDE[ssManStudio](../../includes/ssmanstudio-md.md)], and then expand the server node.</span></span>  
  
2.  <span data-ttu-id="780f2-118">**복제** 폴더를 확장한 다음 **로컬 게시** 폴더를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-118">Expand the **Replication** folder, and then expand the **Local Publications** folder.</span></span>  
  
3.  <span data-ttu-id="780f2-119">스냅샷을 생성할 게시를 마우스 오른쪽 단추로 클릭한 다음 **스냅샷 에이전트 상태 보기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-119">Right-click the publication for which you want to create a snapshot, and then click **View Snapshot Agent Status**.</span></span>  
  
4.  <span data-ttu-id="780f2-120">**스냅샷 에이전트 상태 보기 - \<Publication>** 대화 상자에서 **시작**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-120">In the **View Snapshot Agent Status - \<Publication>** dialog box, click **Start**.</span></span>  
  
 <span data-ttu-id="780f2-121">스냅샷 에이전트에서 스냅샷 생성을 마치면 "[100%] 17개 아티클의 스냅샷이 생성되었습니다"라는 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-121">When the Snapshot Agent finishes generating the snapshot, a message will be displayed, such as "[100%] A snapshot of 17 article(s) was generated."</span></span>  
  
#### <a name="to-create-a-snapshot-in-replication-monitor"></a><span data-ttu-id="780f2-122">복제 모니터에서 스냅샷을 만들려면</span><span class="sxs-lookup"><span data-stu-id="780f2-122">To create a snapshot in Replication Monitor</span></span>  
  
1.  <span data-ttu-id="780f2-123">복제 모니터에서 왼쪽 창의 게시자 그룹을 확장한 다음 게시자를 확장합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-123">In Replication Monitor, expand a Publisher group in the left pane, and then expand a Publisher.</span></span>  
  
2.  <span data-ttu-id="780f2-124">스냅샷을 생성할 게시를 마우스 오른쪽 단추로 클릭한 다음 **스냅샷 생성**을 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-124">Right-click the publication for which you want to generate a snapshot, and then click **Generate Snapshot**.</span></span>  
  
3.  <span data-ttu-id="780f2-125">스냅샷 에이전트 상태를 보려면 **에이전트** 탭을 클릭합니다. 자세한 내용을 보려면 표에서 스냅샷 에이전트를 마우스 오른쪽 단추로 클릭한 다음 **자세히 보기**를 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-125">To view the status of the Snapshot Agent, click the **Agents** tab. For more detailed information, right-click the Snapshot Agent in the grid, and then click **View Details**.</span></span>  
  
#### <a name="to-apply-a-snapshot"></a><span data-ttu-id="780f2-126">스냅샷을 적용하려면</span><span class="sxs-lookup"><span data-stu-id="780f2-126">To apply a snapshot</span></span>  
  
1.  <span data-ttu-id="780f2-127">스냅샷이 생성된 후에는 구독을 배포 에이전트나 병합 에이전트와 동기화하여 스냅샷을 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-127">After the snapshot is generated, it is applied by synchronizing the subscription with the Distribution Agent or the Merge Agent:</span></span>  
  
    -   <span data-ttu-id="780f2-128">에이전트가 계속 실행되도록 설정된 경우(트랜잭션 복제에 대한 기본값) 스냅샷은 생성된 후 자동으로 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-128">If the agent is set to run continuously (the default for transactional replication), the snapshot is automatically applied after it is generated.</span></span>  
  
    -   <span data-ttu-id="780f2-129">에이전트가 일정대로 실행되도록 설정된 경우 일정에 따라 다음에 에이전트가 실행될 때 스냅샷이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-129">If the agent is set to run on a schedule, the snapshot is applied the next time the agent is scheduled to run.</span></span>  
  
    -   <span data-ttu-id="780f2-130">에이전트가 요청 시 실행되도록 설정된 경우 사용자가 다음에 에이전트를 실행할 때 스냅숏이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-130">If the agent is set to run on demand, it is applied the next time you run the agent.</span></span>  
  
     <span data-ttu-id="780f2-131">구독 동기화 방법은 [Synchronize a Push Subscription](synchronize-a-push-subscription.md) 및 [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md)대화 상자에서 다시 초기화할 구독을 표시합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-131">For more information about synchronizing subscriptions, see [Synchronize a Push Subscription](synchronize-a-push-subscription.md) and [Synchronize a Pull Subscription](synchronize-a-pull-subscription.md).</span></span>  
  
##  <a name="using-transact-sql"></a><a name="TsqlProcedure"></a> <span data-ttu-id="780f2-132">Transact-SQL 사용</span><span class="sxs-lookup"><span data-stu-id="780f2-132">Using Transact-SQL</span></span>  
 <span data-ttu-id="780f2-133">초기 스냅샷은 스냅샷 에이전트 작업을 만들고 실행하거나 배치 파일에서 스냅샷 에이전트 실행 파일을 실행하여 프로그래밍 방식으로 작성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-133">Initial snapshots can be programmatically created either by creating and running a Snapshot Agent job or by running the Snapshot Agent executable file from a batch file.</span></span> <span data-ttu-id="780f2-134">초기 스냅샷이 생성되면 구독이 처음으로 동기화될 때 구독자로 전송되고 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-134">After an initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="780f2-135">명령 프롬프트 또는 배치 파일에서 스냅샷 에이전트를 실행하는 경우 기존 스냅샷이 무효화될 때마다 에이전트를 다시 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-135">If you run the Snapshot Agent from a command prompt or a batch file, you will need to rerun the agent whenever the existing snapshot becomes invalid.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="780f2-136">가능한 경우 런타임 시 사용자에게 보안 자격 증명을 입력하라는 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-136">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="780f2-137">자격 증명을 스크립트 파일에 저장해야 하는 경우에는 파일에 무단으로 액세스하지 못하도록 보안을 설정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-137">If you must store credentials in a script file, you must secure the file to prevent unauthorized access.</span></span>  
  
#### <a name="to-create-and-run-a-snapshot-agent-job-to-generate-the-initial-snapshot"></a><span data-ttu-id="780f2-138">스냅샷 에이전트 작업을 만들고 실행하여 초기 스냅샷을 생성하려면</span><span class="sxs-lookup"><span data-stu-id="780f2-138">To create and run a Snapshot Agent job to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="780f2-139">스냅샷, 트랜잭션 또는 병합 게시를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-139">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="780f2-140">자세한 내용은 [게시 만들기](publish/create-a-publication.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-140">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="780f2-141">[sp_addpublication_snapshot&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql)을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-141">Execute [sp_addpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-addpublication-snapshot-transact-sql).</span></span> <span data-ttu-id="780f2-142">**@publication**및 다음 매개 변수를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-142">Specify **@publication** and the following parameters:</span></span>  
  
    -   <span data-ttu-id="780f2-143">배포자에서 스냅샷 에이전트를 실행하는 Windows 인증 자격 증명을 지정하는 **@job_login**.</span><span class="sxs-lookup"><span data-stu-id="780f2-143">**The @job_login, which specifies** the Windows Authentication credentials under which the Snapshot Agent runs at the Distributor.</span></span>  
  
    -   <span data-ttu-id="780f2-144">제공된 Windows 자격 증명의 암호인 **@job_password**.</span><span class="sxs-lookup"><span data-stu-id="780f2-144">**The @job_password**, which is the password for the supplied Windows credentials.</span></span>  
  
    -   <span data-ttu-id="780f2-145">(옵션) 게시자에 연결할 때 에이전트가 SQL Server 인증을 사용하면 **@publisher_security_mode** 에 값 **@publisher_security_mode** .</span><span class="sxs-lookup"><span data-stu-id="780f2-145">(Optional) A value of **0** for **@publisher_security_mode** if the agent will use SQL Server Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="780f2-146">이 경우 및에 대 한 SQL Server 인증 로그인 정보도 지정 해야 합니다 **@publisher_login** **@publisher_password** .</span><span class="sxs-lookup"><span data-stu-id="780f2-146">In this case, you must also specify the SQL Server Authentication login information for **@publisher_login** and **@publisher_password**.</span></span>  
  
    -   <span data-ttu-id="780f2-147">(옵션) 스냅샷 에이전트 작업에 대한 동기화 일정.</span><span class="sxs-lookup"><span data-stu-id="780f2-147">(Optional) A synchronization schedule for the Snapshot Agent job.</span></span> <span data-ttu-id="780f2-148">자세한 내용은 [Specify Synchronization Schedules](specify-synchronization-schedules.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-148">For more information, see [Specify Synchronization Schedules](specify-synchronization-schedules.md).</span></span>  
  
    > [!IMPORTANT]  
    >  <span data-ttu-id="780f2-149">게시자를 원격 배포자로 구성할 경우 *job_login* 및 *job_password*를 비롯한 모든 매개 변수에 제공된 값이 일반 텍스트로 배포자에게 전송됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-149">When configuring a Publisher with a remote Distributor, the values supplied for all parameters, including *job_login* and *job_password*, are sent to the Distributor as plain text.</span></span> <span data-ttu-id="780f2-150">이 저장 프로시저를 실행하기 전에 게시자와 해당 원격 배포자 간 연결을 암호화해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-150">You should encrypt the connection between the Publisher and its remote Distributor before executing this stored procedure.</span></span> <span data-ttu-id="780f2-151">자세한 내용은 [데이터베이스 엔진에 암호화 연결 사용&#40;SQL Server 구성 관리자&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-151">For more information, see [Enable Encrypted Connections to the Database Engine &#40;SQL Server Configuration Manager&#41;](../../database-engine/configure-windows/enable-encrypted-connections-to-the-database-engine.md).</span></span>  
  
3.  <span data-ttu-id="780f2-152">아티클을 게시에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-152">Add articles to the publication.</span></span> <span data-ttu-id="780f2-153">자세한 내용은 [아티클을 정의](publish/define-an-article.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-153">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
4.  <span data-ttu-id="780f2-154">게시 데이터베이스의 게시자에서 1단계의 **@publication** 값을 지정하여 [sp_startpublication_snapshot&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql)을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-154">At the Publisher on the publication database, execute [sp_startpublication_snapshot &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-startpublication-snapshot-transact-sql), specifying the value of **@publication** from step 1.</span></span>  
  
#### <a name="to-run-the-snapshot-agent-to-generate-the-initial-snapshot"></a><span data-ttu-id="780f2-155">스냅샷 에이전트를 실행하여 초기 스냅샷을 생성하려면</span><span class="sxs-lookup"><span data-stu-id="780f2-155">To run the Snapshot Agent to generate the initial snapshot</span></span>  
  
1.  <span data-ttu-id="780f2-156">스냅샷, 트랜잭션 또는 병합 게시를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-156">Create a snapshot, transactional, or merge publication.</span></span> <span data-ttu-id="780f2-157">자세한 내용은 [게시 만들기](publish/create-a-publication.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-157">For more information, see [Create a Publication](publish/create-a-publication.md).</span></span>  
  
2.  <span data-ttu-id="780f2-158">아티클을 게시에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-158">Add articles to the publication.</span></span> <span data-ttu-id="780f2-159">자세한 내용은 [아티클을 정의](publish/define-an-article.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-159">For more information, see [Define an Article](publish/define-an-article.md).</span></span>  
  
3.  <span data-ttu-id="780f2-160">명령 프롬프트 또는 배치 파일에서 [snapshot.exe](agents/replication-snapshot-agent.md) 를 실행하여 **Replication Snapshot Agent**를 시작하고 다음 명령줄 인수를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-160">From the command prompt or in a batch file, start the [Replication Snapshot Agent](agents/replication-snapshot-agent.md) by running **snapshot.exe**, specifying the following command-line arguments:</span></span>  
  
    -   <span data-ttu-id="780f2-161">**-Publication**</span><span class="sxs-lookup"><span data-stu-id="780f2-161">**-Publication**</span></span>  
  
    -   <span data-ttu-id="780f2-162">**-Publisher**</span><span class="sxs-lookup"><span data-stu-id="780f2-162">**-Publisher**</span></span>  
  
    -   <span data-ttu-id="780f2-163">**-Distributor**</span><span class="sxs-lookup"><span data-stu-id="780f2-163">**-Distributor**</span></span>  
  
    -   <span data-ttu-id="780f2-164">**-PublisherDB**</span><span class="sxs-lookup"><span data-stu-id="780f2-164">**-PublisherDB**</span></span>  
  
    -   <span data-ttu-id="780f2-165">**-ReplicationType**</span><span class="sxs-lookup"><span data-stu-id="780f2-165">**-ReplicationType**</span></span>  
  
     <span data-ttu-id="780f2-166">SQL Server 인증을 사용하는 경우 다음 인수도 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-166">If you are using SQL Server Authentication, you must also specify the following arguments:</span></span>  
  
    -   <span data-ttu-id="780f2-167">**-DistributorLogin**</span><span class="sxs-lookup"><span data-stu-id="780f2-167">**-DistributorLogin**</span></span>  
  
    -   <span data-ttu-id="780f2-168">**-DistributorPassword**</span><span class="sxs-lookup"><span data-stu-id="780f2-168">**-DistributorPassword**</span></span>  
  
    -   <span data-ttu-id="780f2-169">**-DistributorSecurityMode** = **0**</span><span class="sxs-lookup"><span data-stu-id="780f2-169">**-DistributorSecurityMode** = **0**</span></span>  
  
    -   <span data-ttu-id="780f2-170">**-PublisherLogin**</span><span class="sxs-lookup"><span data-stu-id="780f2-170">**-PublisherLogin**</span></span>  
  
    -   <span data-ttu-id="780f2-171">**-PublisherPassword**</span><span class="sxs-lookup"><span data-stu-id="780f2-171">**-PublisherPassword**</span></span>  
  
    -   <span data-ttu-id="780f2-172">**-PublisherSecurityMode** =  **\@publisher_security_mode**</span><span class="sxs-lookup"><span data-stu-id="780f2-172">**-PublisherSecurityMode** = **0**</span></span>  
  
###  <a name="examples-transact-sql"></a><a name="TsqlExample"></a> <span data-ttu-id="780f2-173">예(Transact-SQL)</span><span class="sxs-lookup"><span data-stu-id="780f2-173">Examples (Transact-SQL)</span></span>  
 <span data-ttu-id="780f2-174">이 예제에서는 트랜잭션 게시를 만들고 **sqlcmd** 스크립팅 변수를 사용하여 새 게시에 대한 스냅샷 에이전트 작업을 추가하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-174">This example shows how to create a transactional publication and add a Snapshot Agent job for the new publication (using **sqlcmd** scripting variables).</span></span> <span data-ttu-id="780f2-175">또한 추가한 작업을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-175">The example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_trangenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createtranpubinitialsnapshot.sql#sp_trangenerate_snapshot)]  
  
 <span data-ttu-id="780f2-176">이 예제에서는 병합 게시를 만들고 **sqlcmd** 변수를 사용하여 게시에 대한 스냅샷 에이전트 작업을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-176">This example creates a merge publication and adds a Snapshot Agent job (using **sqlcmd** variables) for the publication.</span></span> <span data-ttu-id="780f2-177">또한 추가한 작업을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-177">This example also starts the job.</span></span>  
  
 [!code-sql[HowTo#sp_mergegenerate_snapshot](../../snippets/tsql/SQL15/replication/howto/tsql/createmergepubinitialsnapshot.sql#sp_mergegenerate_snapshot)]  
  
 <span data-ttu-id="780f2-178">다음 명령줄 인수는 스냅샷 에이전트를 시작하여 병합 게시에 대한 스냅샷을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-178">The following command-line arguments start the Snapshot Agent to generate the snapshot for a merge publication.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="780f2-179">가독성을 높이기 위해 줄 바꿈이 추가되었지만</span><span class="sxs-lookup"><span data-stu-id="780f2-179">Line breaks were added to improve readability.</span></span> <span data-ttu-id="780f2-180">배치 파일에서 명령은 단일 행으로 작성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-180">In a batch file, commands must be made in a single line.</span></span>  
  
 [!code-sql[HowTo#startmergesnapshot_10](../../snippets/tsql/SQL15/replication/howto/tsql/createmergesnapshot_10.bat)]  
  
##  <a name="using-replication-management-objects-rmo"></a><a name="RMOProcedure"></a> <span data-ttu-id="780f2-181">RMO(복제 관리 개체) 사용</span><span class="sxs-lookup"><span data-stu-id="780f2-181">Using Replication Management Objects (RMO)</span></span>  
 <span data-ttu-id="780f2-182">스냅샷 에이전트는 게시가 만들어진 후 스냅샷을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-182">The Snapshot Agent generates snapshots after a publication is created.</span></span> <span data-ttu-id="780f2-183">RMO(복제 관리 개체)를 사용하여 이러한 스냅샷을 프로그래밍 방식으로 생성하고 복제 에이전트 기능에 액세스하도록 관리 코드에 지시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-183">You can generate these snapshots programmatically by using Replication Management Objects (RMO) and direct managed code access to replication agent functionalities.</span></span> <span data-ttu-id="780f2-184">사용하는 개체는 복제 유형에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-184">The objects you use depend on the type of replication.</span></span> <span data-ttu-id="780f2-185">스냅샷 에이전트는 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> 개체를 사용하여 동기적으로 시작하거나 에이전트 작업을 사용하여 비동기적으로 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-185">The Snapshot Agent can be started synchronously using the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> object or asynchronously using the agent job.</span></span> <span data-ttu-id="780f2-186">생성된 초기 스냅샷은 구독이 처음 동기화될 때 구독자로 전송되어 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-186">After the initial snapshot has been generated, it is transferred to and applied at the Subscriber when the subscription is first synchronized.</span></span> <span data-ttu-id="780f2-187">기존 스냅샷에 유효한 최신 데이터가 필요하게 될 때마다 에이전트를 다시 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-187">You will need to rerun the agent whenever the existing snapshot no longer contains valid, up-to-date data.</span></span> <span data-ttu-id="780f2-188">자세한 내용은 [게시 유지 관리](publish/maintain-publications.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="780f2-188">For more information, see [Maintain Publications](publish/maintain-publications.md).</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="780f2-189">가능한 경우 런타임 시 사용자에게 보안 자격 증명을 입력하라는 메시지가 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-189">When possible, prompt users to enter security credentials at runtime.</span></span> <span data-ttu-id="780f2-190">자격 증명을 저장해야 하는 경우 [Windows .NET Framework에서 제공하는](https://go.microsoft.com/fwlink/?LinkId=34733) 암호화 서비스 [!INCLUDE[msCoName](../../includes/msconame-md.md)] 를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-190">If you must store credentials, use the [cryptographic services](https://go.microsoft.com/fwlink/?LinkId=34733) provided by the [!INCLUDE[msCoName](../../includes/msconame-md.md)] Windows .NET Framework.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="780f2-191">스냅샷 에이전트 작업을 시작하여 스냅샷 또는 트랜잭션 게시에 대한 초기 스냅샷을 생성하려면(비동기)</span><span class="sxs-lookup"><span data-stu-id="780f2-191">To generate the initial snapshot for a snapshot or transactional publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="780f2-192"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 클래스를 사용하여 게시자 연결을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-192">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="780f2-193"><xref:Microsoft.SqlServer.Replication.TransPublication> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-193">Create an instance of the <xref:Microsoft.SqlServer.Replication.TransPublication> class.</span></span> <span data-ttu-id="780f2-194">게시에 대해 <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> 및 <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> 속성을 설정하고 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 속성을 1단계에서 만든 연결로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-194">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="780f2-195"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 메서드를 호출하여 개체의 나머지 속성을 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-195">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="780f2-196">이 메서드가 `false`를 반환하는 경우 2단계에서 게시 속성이 올바르게 정의되지 않았거나 게시가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-196">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="780f2-197"><xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A>의 값이 `false`이면 <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A>를 호출하여 이 게시에 대한 스냅샷 에이전트 작업을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-197">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="780f2-198"><xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> 메서드를 호출하여 이 게시에 대한 스냅샷을 생성하는 에이전트 작업을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-198">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="780f2-199">(옵션) <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> 값이 `true`이면 구독자에서 스냅샷을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-199">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.TransPublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-snapshot-or-transactional-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="780f2-200">스냅샷 에이전트를 실행하여 스냅샷 또는 트랜잭션 게시에 대한 초기 스냅샷을 생성하려면(동기)</span><span class="sxs-lookup"><span data-stu-id="780f2-200">To generate the initial snapshot for a snapshot or transactional publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="780f2-201"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> 클래스의 인스턴스를 만들고 다음 필수 속성을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-201">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="780f2-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - 게시자의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-202"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="780f2-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - 게시 데이터베이스의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-203"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="780f2-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - 게시의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-204"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="780f2-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - 배포자의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-205"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="780f2-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - 게시자에 연결할 때 Windows 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 값, 게시자에 연결할 때 <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> , <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 값.</span><span class="sxs-lookup"><span data-stu-id="780f2-206"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="780f2-207">Windows 인증을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-207">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="780f2-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - 배포자에 연결할 때 Windows 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 값, 배포자에 연결할 때 <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> , <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 값.</span><span class="sxs-lookup"><span data-stu-id="780f2-208"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="780f2-209">Windows 인증을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-209">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="780f2-210"><xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> 에 <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> 또는 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>값을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-210">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Transactional> or <xref:Microsoft.SqlServer.Replication.ReplicationType.Snapshot> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="780f2-211"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-211">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-starting-the-snapshot-agent-job-asynchronous"></a><span data-ttu-id="780f2-212">스냅샷 에이전트 작업을 시작하여 병합 게시에 대한 초기 스냅샷을 생성하려면(비동기)</span><span class="sxs-lookup"><span data-stu-id="780f2-212">To generate the initial snapshot for a merge publication by starting the Snapshot Agent job (asynchronous)</span></span>  
  
1.  <span data-ttu-id="780f2-213"><xref:Microsoft.SqlServer.Management.Common.ServerConnection> 클래스를 사용하여 게시자 연결을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-213">Create a connection to the Publisher by using the <xref:Microsoft.SqlServer.Management.Common.ServerConnection> class.</span></span>  
  
2.  <span data-ttu-id="780f2-214"><xref:Microsoft.SqlServer.Replication.MergePublication> 클래스의 인스턴스를 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-214">Create an instance of the <xref:Microsoft.SqlServer.Replication.MergePublication> class.</span></span> <span data-ttu-id="780f2-215">게시에 대해 <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> 및 <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> 속성을 설정하고 <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> 속성을 1단계에서 만든 연결로 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-215">Set the <xref:Microsoft.SqlServer.Replication.Publication.Name%2A> and <xref:Microsoft.SqlServer.Replication.Publication.DatabaseName%2A> properties for the publication, and set the <xref:Microsoft.SqlServer.Replication.ReplicationObject.ConnectionContext%2A> property to the connection created in step 1.</span></span>  
  
3.  <span data-ttu-id="780f2-216"><xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> 메서드를 호출하여 개체의 나머지 속성을 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-216">Call the <xref:Microsoft.SqlServer.Replication.ReplicationObject.LoadProperties%2A> method to load the remaining properties of the object.</span></span> <span data-ttu-id="780f2-217">이 메서드가 `false`를 반환하는 경우 2단계에서 게시 속성이 올바르게 정의되지 않았거나 게시가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-217">If this method returns `false`, either the publication properties in step 2 were defined incorrectly or the publication does not exist.</span></span>  
  
4.  <span data-ttu-id="780f2-218"><xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A>의 값이 `false`이면 <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A>를 호출하여 이 게시에 대한 스냅샷 에이전트 작업을 만듭니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-218">If the value of <xref:Microsoft.SqlServer.Replication.Publication.SnapshotAgentExists%2A> is `false`, call <xref:Microsoft.SqlServer.Replication.Publication.CreateSnapshotAgent%2A> to create the snapshot agent job for this publication.</span></span>  
  
5.  <span data-ttu-id="780f2-219"><xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> 메서드를 호출하여 이 게시에 대한 스냅샷을 생성하는 에이전트 작업을 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-219">Call the <xref:Microsoft.SqlServer.Replication.Publication.StartSnapshotGenerationAgentJob%2A> method to start the agent job that generates the snapshot for this publication.</span></span>  
  
6.  <span data-ttu-id="780f2-220">(옵션) <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> 값이 `true`이면 구독자에서 스냅샷을 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-220">(Optional) When the value of <xref:Microsoft.SqlServer.Replication.MergePublication.SnapshotAvailable%2A> is `true`, the snapshot is available to Subscribers.</span></span>  
  
#### <a name="to-generate-the-initial-snapshot-for-a-merge-publication-by-running-the-snapshot-agent-synchronous"></a><span data-ttu-id="780f2-221">스냅샷 에이전트를 실행하여 병합 게시에 대한 초기 스냅샷을 생성하려면(동기)</span><span class="sxs-lookup"><span data-stu-id="780f2-221">To generate the initial snapshot for a merge publication by running the Snapshot Agent (synchronous)</span></span>  
  
1.  <span data-ttu-id="780f2-222"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> 클래스의 인스턴스를 만들고 다음 필수 속성을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-222">Create an instance of the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent> class, and set the following required properties:</span></span>  
  
    -   <span data-ttu-id="780f2-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - 게시자의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-223"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publisher%2A> - name of the Publisher</span></span>  
  
    -   <span data-ttu-id="780f2-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - 게시 데이터베이스의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-224"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherDatabase%2A> - name of the publication database</span></span>  
  
    -   <span data-ttu-id="780f2-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - 게시의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-225"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Publication%2A> - name of the publication</span></span>  
  
    -   <span data-ttu-id="780f2-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - 배포자의 이름</span><span class="sxs-lookup"><span data-stu-id="780f2-226"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.Distributor%2A> - name of the Distributor</span></span>  
  
    -   <span data-ttu-id="780f2-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - 게시자에 연결할 때 Windows 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 값, 게시자에 연결할 때 <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> , <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 값.</span><span class="sxs-lookup"><span data-stu-id="780f2-227"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Publisher or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.PublisherPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Publisher.</span></span> <span data-ttu-id="780f2-228">Windows 인증을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-228">Windows Authentication is recommended.</span></span>  
  
    -   <span data-ttu-id="780f2-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - 배포자에 연결할 때 Windows 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> 값, 배포자에 연결할 때 <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> 인증을 사용하려면 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> , <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> 및 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 값.</span><span class="sxs-lookup"><span data-stu-id="780f2-229"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorSecurityMode%2A> - a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Integrated> to use Windows Authentication when connecting to the Distributor or a value of <xref:Microsoft.SqlServer.Replication.SecurityMode.Standard> and values for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorLogin%2A> and <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.DistributorPassword%2A> to use [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] Authentication when connecting to the Distributor.</span></span> <span data-ttu-id="780f2-230">Windows 인증을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-230">Windows Authentication is recommended.</span></span>  
  
2.  <span data-ttu-id="780f2-231"><xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> 에 <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>값을 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-231">Set a value of <xref:Microsoft.SqlServer.Replication.ReplicationType.Merge> for <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.ReplicationType%2A>.</span></span>  
  
3.  <span data-ttu-id="780f2-232"><xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-232">Call the <xref:Microsoft.SqlServer.Replication.SnapshotGenerationAgent.GenerateSnapshot%2A> method.</span></span>  
  
###  <a name="examples-rmo"></a><a name="PShellExample"></a> <span data-ttu-id="780f2-233">예(RMO)</span><span class="sxs-lookup"><span data-stu-id="780f2-233">Examples (RMO)</span></span>  
 <span data-ttu-id="780f2-234">이 예에서는 스냅샷 에이전트를 동기적으로 실행하여 트랜잭션 게시에 대한 초기 스냅샷을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-234">This example synchronously runs the Snapshot Agent to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot)]  
  
 <span data-ttu-id="780f2-235">이 예에서는 에이전트 작업을 비동기적으로 시작하여 트랜잭션 게시에 대한 초기 스냅샷을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="780f2-235">This example asynchronously starts the agent job to generate the initial snapshot for a transactional publication.</span></span>  
  
 [!code-csharp[HowTo#rmo_GenerateSnapshot_WithJob](../../snippets/csharp/SQL15/replication/howto/cs/rmotestevelope.cs#rmo_generatesnapshot_withjob)]  
  
 [!code-vb[HowTo#rmo_vb_GenerateSnapshot_WithJob](../../snippets/visualbasic/SQL15/replication/howto/vb/rmotestenv.vb#rmo_vb_generatesnapshot_withjob)]  
  
## <a name="see-also"></a><span data-ttu-id="780f2-236">참고 항목</span><span class="sxs-lookup"><span data-stu-id="780f2-236">See Also</span></span>  
 <span data-ttu-id="780f2-237">[Create a Publication](publish/create-a-publication.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-237">[Create a Publication](publish/create-a-publication.md) </span></span>  
 <span data-ttu-id="780f2-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-238">[Create a Pull Subscription](create-a-pull-subscription.md) </span></span>  
 <span data-ttu-id="780f2-239">[ssSDSFull](create-a-push-subscription.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-239">[Create a Push Subscription](create-a-push-subscription.md) </span></span>  
 <span data-ttu-id="780f2-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-240">[Specify Synchronization Schedules](specify-synchronization-schedules.md) </span></span>  
 <span data-ttu-id="780f2-241">[스냅숏 만들기 및 적용](create-and-apply-the-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-241">[Create and Apply the Snapshot](create-and-apply-the-snapshot.md) </span></span>  
 <span data-ttu-id="780f2-242">[스냅샷으로 구독 초기화](initialize-a-subscription-with-a-snapshot.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-242">[Initialize a Subscription with a Snapshot](initialize-a-subscription-with-a-snapshot.md) </span></span>  
 <span data-ttu-id="780f2-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-243">[Replication Management Objects Concepts](concepts/replication-management-objects-concepts.md) </span></span>  
 <span data-ttu-id="780f2-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-244">[Replication Security Best Practices](security/replication-security-best-practices.md) </span></span>  
 <span data-ttu-id="780f2-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span><span class="sxs-lookup"><span data-stu-id="780f2-245">[Replication System Stored Procedures Concepts](concepts/replication-system-stored-procedures-concepts.md) </span></span>  
 [<span data-ttu-id="780f2-246">스크립팅 변수와 함께 sqlcmd 사용</span><span class="sxs-lookup"><span data-stu-id="780f2-246">Use sqlcmd with Scripting Variables</span></span>](../scripting/sqlcmd-use-with-scripting-variables.md)  
  
  
