---
title: ODBC 커서 라이브러리 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: native-client
ms.topic: reference
helpviewer_keywords:
- cursors [ODBC], library
- SQL_CUR_USE_DRIVER option
- ODBC applications, cursors
- ODBC cursors, library
- SQL_CUR_USE_IF_NEEDED option
- SQLSetConnectAttr function
- SQL_CUR_USE_ODBC option
ms.assetid: 3c610d3d-6e06-49cf-9a40-05b6a1c83a32
author: rothja
ms.author: jroth
ms.openlocfilehash: b0f0ad049c6b9e77f9888d582ab0cda2f5a5e0f7
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87649064"
---
# <a name="odbc-cursor-library"></a><span data-ttu-id="e202b-102">ODBC 커서 라이브러리</span><span class="sxs-lookup"><span data-stu-id="e202b-102">ODBC Cursor Library</span></span>
  <span data-ttu-id="e202b-103">일부 ODBC 드라이버는 기본 커서 설정만 지원 합니다. 또한 이러한 드라이버는 **SQLSetPos**와 같은 위치 지정 커서 작업을 지원 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-103">Some ODBC drivers only support the default cursor settings; these drivers also do not support positioned cursor operations, such as **SQLSetPos**.</span></span> <span data-ttu-id="e202b-104">ODBC 커서 라이브러리는 일반적으로 블록 또는 정적 커서를 지원하지 않는 드라이버에서 블록 또는 정적 커서를 구현하는 데 사용되는 MDAC(Microsoft Data Access Components) 구성 요소입니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-104">The ODBC cursor library is a component of the Microsoft Data Access Components (MDAC) used to implement block or static cursors on a driver that normally does not support them.</span></span> <span data-ttu-id="e202b-105">커서 라이브러리는 만든 커서에 대해 위치 지정 업데이트 및 DELETE 문과 **SQLSetPos** 도 구현 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-105">The cursor library also implements positioned UPDATE and DELETE statements and **SQLSetPos** for the cursors it creates.</span></span>  
  
 <span data-ttu-id="e202b-106">ODBC 커서 라이브러리는 ODBC 드라이버 관리자와 ODBC 드라이버 사이의 계층으로 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-106">The ODBC cursor library is implemented as a layer between the ODBC Driver Manager and an ODBC driver.</span></span> <span data-ttu-id="e202b-107">ODBC 커서 라이브러리가 로드되면 ODBC 드라이버 관리자에서 모든 커서 관련 명령을 드라이버 대신 커서 라이브러리로 라우팅합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-107">If the ODBC cursor library is loaded, the ODBC Driver Manager routes all cursor-related commands to the cursor library instead of the driver.</span></span> <span data-ttu-id="e202b-108">커서 라이브러리는 기본 드라이버에서 전체 결과 집합을 인출하고 결과 집합을 클라이언트에 캐시하여 커서를 구현합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-108">The cursor library implements a cursor by fetching the entire result set from the underlying driver and caching the result set on the client.</span></span> <span data-ttu-id="e202b-109">ODBC 커서 라이브러리를 사용하는 경우 애플리케이션은 커서 라이브러리의 커서 기능으로 제한됩니다. 기본 드라이버의 추가 커서 기능에 대한 지원은 애플리케이션에서 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-109">When using the ODBC cursor library, the application is limited to the cursor functionality of the cursor library; any support for additional cursor functionality in the underlying driver is not available to the application.</span></span>  
  
 <span data-ttu-id="e202b-110">드라이버 자체에서 ODBC 커서 라이브러리보다 많은 커서 기능을 지원하므로 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC 드라이버에서 ODBC 커서 라이브러리를 사용할 필요는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-110">There is little need to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver because the driver itself supports more cursor functionality than the ODBC cursor library.</span></span> <span data-ttu-id="e202b-111">Native Client ODBC 드라이버에서 ODBC 커서 라이브러리를 사용 하는 유일한 이유는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 드라이버가 서버 커서를 통해 커서 지원을 구현 하 고 서버 커서가 모든 SQL 문을 지원 하지 않기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-111">The only reason to use the ODBC cursor library with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver is because the driver implements its cursor support through server cursors, and server cursors do not support all SQL statements.</span></span> <span data-ttu-id="e202b-112">저장 프로시저, 일괄 처리 또는 COMPUTE, COMPUTE BY, FOR BROWSE 또는 INTO가 포함된 SQL 문에 정적 커서가 필요한 경우 ODBC 커서 라이브러리를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-112">Any time there is a need to have a static cursor with stored procedures, batches, or SQL statements containing COMPUTE, COMPUTE BY, FOR BROWSE, or INTO, consider using the ODBC cursor library.</span></span> <span data-ttu-id="e202b-113">하지만 커서 라이브러리는 전체 결과 집합을 클라이언트에 캐시하여 많은 메모리가 사용되고 성능이 저하될 수 있으므로 주의해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-113">However, care must be used with the cursor library because it caches the entire result set on the client, which can use large amounts of memory and slow performance.</span></span>  
  
 <span data-ttu-id="e202b-114">응용 프로그램은 데이터 원본에 연결 하기 전에 [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) 를 사용 하 여 SQL_ATTR_ODBC_CURSORS 연결 특성을 설정 함으로써 연결 별로 커서 라이브러리를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-114">An application invokes the cursor library on a connection-by-connection basis by using [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to set the SQL_ATTR_ODBC_CURSORS connection attribute before connecting to a data source.</span></span> <span data-ttu-id="e202b-115">SQL_ATTR_ODBC_CURSORS는 다음 세 값 중 하나로 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-115">SQL_ATTR_ODBC_CURSORS is set to one of three values:</span></span>  
  
 <span data-ttu-id="e202b-116">SQL_CUR_USE_ODBC</span><span class="sxs-lookup"><span data-stu-id="e202b-116">SQL_CUR_USE_ODBC</span></span>  
 <span data-ttu-id="e202b-117">Native Client ODBC 드라이버를 사용 하 여이 옵션을 설정 하면 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] odbc 커서 라이브러리는 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] NATIVE client odbc 드라이버의 네이티브 커서 지원 기능을 재정의 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-117">When this option is set with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver, the ODBC cursor library overrides the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver's native cursor support.</span></span> <span data-ttu-id="e202b-118">커서 라이브러리에서 지원되는 커서 유형만 연결에 사용할 수 있으며 서버 커서는 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-118">Only the cursor types supported by the cursor library can be used for the connection; server cursors cannot be used.</span></span>  
  
 <span data-ttu-id="e202b-119">SQL_CUR_USE_DRIVER</span><span class="sxs-lookup"><span data-stu-id="e202b-119">SQL_CUR_USE_DRIVER</span></span>  
 <span data-ttu-id="e202b-120">이 옵션을 설정 하면 native Client ODBC 드라이버의 네이티브를 지 원하는 모든 커서를 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 연결에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-120">When this option is set, all of the cursor support native to the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver can be used for the connection.</span></span> <span data-ttu-id="e202b-121">ODBC 커서 라이브러리는 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-121">The ODBC cursor library cannot be used.</span></span> <span data-ttu-id="e202b-122">모든 커서가 서버 커서로 구현됩니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-122">All cursors are implemented as server cursors.</span></span>  
  
 <span data-ttu-id="e202b-123">SQL_CUR_USE_IF_NEEDED</span><span class="sxs-lookup"><span data-stu-id="e202b-123">SQL_CUR_USE_IF_NEEDED</span></span>  
 <span data-ttu-id="e202b-124">이 옵션을 설정 하면 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native CLIENT ODBC 드라이버와 함께 사용 하는 경우의 효과는 SQL_CUR_USE_DRIVER 같습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-124">When this option is set, the effect is the same as SQL_CUR_USE_DRIVER when used with the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver.</span></span> <span data-ttu-id="e202b-125">연결 시 ODBC 드라이버 관리자는 연결 된 ODBC 드라이버가 [Sqlfetchscroll](../../native-client-odbc-api/sqlfetchscroll.md)의 SQL_FETCH_PRIOR 옵션을 지원 하는지 테스트 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-125">At connect time, the ODBC Driver Manager tests to see if the ODBC driver being connected to supports the SQL_FETCH_PRIOR option of [SQLFetchScroll](../../native-client-odbc-api/sqlfetchscroll.md).</span></span> <span data-ttu-id="e202b-126">드라이버가 이 옵션을 지원하지 않으면 ODBC 드라이버 관리자에서 ODBC 커서 라이브러리를 로드합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-126">If the driver does not support the option, the ODBC Driver Manager loads the ODBC cursor library.</span></span> <span data-ttu-id="e202b-127">드라이버가 이 옵션을 지원하면 ODBC 드라이버 관리자에서 ODBC 커서 라이브러리를 로드하지 않으며 애플리케이션이 드라이버의 기본 지원을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-127">If the driver does support the option, the ODBC Driver Manager does not load the ODBC cursor library and the application uses the native support of the driver.</span></span> <span data-ttu-id="e202b-128">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]Native CLIENT odbc 드라이버는 SQL_FETCH_PRIOR을 지원 하기 때문에 Odbc 드라이버 관리자는 odbc 커서 라이브러리를 로드 하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-128">Because the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] Native Client ODBC driver supports SQL_FETCH_PRIOR, the ODBC Driver Manager does not load the ODBC cursor library.</span></span>  
  
 <span data-ttu-id="e202b-129">커서 라이브러리를 사용하면 애플리케이션이 스크롤 및 업데이트 가능한 커서는 물론 한 연결에서 활성 문을 여러 개 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-129">The cursor library allows applications to use multiple active statements on a connection, as well as scrollable, updatable cursors.</span></span> <span data-ttu-id="e202b-130">이 기능을 지원하려면 커서 라이브러리를 로드해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-130">The cursor library must be loaded to support this functionality.</span></span> <span data-ttu-id="e202b-131">[SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) 를 사용 하 여 커서 라이브러리를 사용 하는 방법을 지정 하 고 [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) 를 사용 하 여 커서 유형, 동시성 및 행 집합 크기를 지정 합니다.</span><span class="sxs-lookup"><span data-stu-id="e202b-131">Use [SQLSetConnectAttr](../../native-client-odbc-api/sqlsetconnectattr.md) to specify how the cursor library should be used and [SQLSetStmtAttr](../../native-client-odbc-api/sqlsetstmtattr.md) to specify the cursor type, concurrency, and rowset size.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e202b-132">참고 항목</span><span class="sxs-lookup"><span data-stu-id="e202b-132">See Also</span></span>  
 [<span data-ttu-id="e202b-133">커서 구현 방법</span><span class="sxs-lookup"><span data-stu-id="e202b-133">How Cursors Are Implemented</span></span>](how-cursors-are-implemented.md)  
  
  
