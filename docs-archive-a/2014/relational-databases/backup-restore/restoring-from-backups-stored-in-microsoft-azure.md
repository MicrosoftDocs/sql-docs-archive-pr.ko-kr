---
title: Azure에 저장 된 백업에서 복원 | Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: backup-restore
ms.topic: conceptual
ms.assetid: 6ae358b2-6f6f-46e0-a7c8-f9ac6ce79a0e
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 68b270f18cb4dbc2724c5a062afae54fa711acec
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87653449"
---
# <a name="restoring-from-backups-stored-in-azure"></a><span data-ttu-id="da11d-102">Azure에 저장된 백업 복원</span><span class="sxs-lookup"><span data-stu-id="da11d-102">Restoring From Backups Stored in Azure</span></span>
  <span data-ttu-id="da11d-103">이 항목에서는 Azure Blob Storage 서비스에 저장된 백업을 사용하여 데이터베이스를 복원할 때의 고려 사항에 대해 간단히 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-103">This topic outlines the considerations when restoring a database using a backup stored in the Azure Blob storage service.</span></span> <span data-ttu-id="da11d-104">이 내용은 URL에 대한 SQL Server 백업이나 [!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)]을 사용하여 만들어진 백업에 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-104">This applies to backups created either by using SQL Server Backup to URL backup or by [!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)].</span></span>  
  
 <span data-ttu-id="da11d-105">복원할 백업이 Azure Blob Storage 서비스에 저장되어 있는 경우 이 항목을 검토한 다음 온-프레미스 백업과 Azure 백업 모두에 동일한 데이터베이스 복원 방법에 대한 단계를 설명하는 항목을 검토하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-105">We recommend reviewing this topic if you have backups stored in the Azure Blob storage service that you plan to restore, and then review the topics that describe the steps on how to restore a database which is the same for both on-premises and azure backups.</span></span>  
  
## <a name="overview"></a><span data-ttu-id="da11d-106">개요</span><span class="sxs-lookup"><span data-stu-id="da11d-106">Overview</span></span>  
 <span data-ttu-id="da11d-107">온-프레미스 백업에서 데이터베이스를 백업하는 데 사용되는 도구 및 방법은 클라우드 백업에서 데이터베이스를 복원하는 데 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-107">The tools and methods that are used to restore a database from an on-premises backup apply to restoring a database from a cloud backup.</span></span>  <span data-ttu-id="da11d-108">다음 섹션에서는 이러한 고려 사항 및 Azure Blob Storage 서비스에 저장된 백업을 사용할 때 알아야 하는 모든 차이점에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-108">The following sections describe these considerations and any differences you should know about when you use backups stored in the Azure Blob storage service.</span></span>  
  
### <a name="using-transact-sql"></a><span data-ttu-id="da11d-109">Transact-SQL 사용</span><span class="sxs-lookup"><span data-stu-id="da11d-109">Using Transact-SQL</span></span>  
  
-   <span data-ttu-id="da11d-110">SQL Server는 백업 파일을 검색하기 위해 외부 원본에 연결해야 하므로 스토리지 계정을 인증하는 데 SQL 자격 증명이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-110">Since SQL Server must connect to an external source to retrieve the backup files, SQL Credential is used to authenticate to the storage account.</span></span> <span data-ttu-id="da11d-111">결과적으로 RESTORE 문에 WITH CREDENTIAL 옵션이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-111">Consequently, the RESTORE statement requires WITH CREDENTIAL option.</span></span> <span data-ttu-id="da11d-112">자세한 내용은 [Azure Blob Storage 서비스로 SQL Server 백업 및 복원](sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-112">For more information, see [SQL Server Backup and Restore with Azure Blob Storage Service](sql-server-backup-and-restore-with-microsoft-azure-blob-storage-service.md).</span></span>  
  
-   <span data-ttu-id="da11d-113">[!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)] 을 사용하여 클라우드로의 백업을 관리하는 경우 **smart_admin.fn_available_backups** 시스템 함수를 사용하여 스토리지에서 사용 가능한 모든 백업을 검토할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-113">If you are using the [!INCLUDE[ss_smartbackup](../../includes/ss-smartbackup-md.md)] to manage your backups to the cloud, you can review all the available backups in the storage, by using the **smart_admin.fn_available_backups** system function.</span></span> <span data-ttu-id="da11d-114">이 시스템 함수는 테이블에 데이터베이스에 대한 사용 가능한 모든 백업을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-114">This system function returns all the available backups for a database in a table.</span></span> <span data-ttu-id="da11d-115">결과가 테이블에 반환되면 해당 결과를 필터링하거나 정렬할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-115">As the results are returned in a table, you can filter or sort the results.</span></span> <span data-ttu-id="da11d-116">자세한 내용은 [smart_admin fn_available_backups &#40;transact-sql&#41;](/sql/relational-databases/system-functions/managed-backup-fn-available-backups-transact-sql)를 참조 하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-116">For more information, see [smart_admin.fn_available_backups &#40;Transact-SQL&#41;](/sql/relational-databases/system-functions/managed-backup-fn-available-backups-transact-sql).</span></span>  
  
### <a name="using-sql-server-management-studio"></a><span data-ttu-id="da11d-117">SQL Server Management Studio 사용</span><span class="sxs-lookup"><span data-stu-id="da11d-117">Using SQL Server Management Studio</span></span>  
  
-   <span data-ttu-id="da11d-118">복원 태스크는 SQL Server Management Studio를 사용하여 데이터베이스를 복원하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-118">The restore task is used to restore a database using the SQL Server Management Studio.</span></span> <span data-ttu-id="da11d-119">이제 백업 미디어 페이지에 Azure Blob Storage 서비스에 저장된 백업 파일을 표시하는 **URL** 옵션이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-119">The backup media page now includes the **URL** option to show backup files stored in the Azure Blob storage service.</span></span> <span data-ttu-id="da11d-120">스토리지 계정 인증에 사용되는 SQL 자격 증명도 제공해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-120">You also must provide the SQL Credential that is used to authenticate to the storage account.</span></span> <span data-ttu-id="da11d-121">그러면 **복원할 백업 세트** 그리드가 Azure Blob Storage의 사용 가능한 백업으로 채워집니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-121">The **Backup sets to restore** grid is then populated with the available backups in the Azure Blob storage.</span></span> <span data-ttu-id="da11d-122">자세한 내용은 [SQL Server Management Studio를 사용하여 Azure Storage에서 복원](sql-server-backup-to-url.md#RestoreSSMS)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-122">For more information, see [Restoring from Azure storage Using SQL Server Management Studio](sql-server-backup-to-url.md#RestoreSSMS).</span></span>  
  
### <a name="optimizing-restores"></a><span data-ttu-id="da11d-123">복원 최적화</span><span class="sxs-lookup"><span data-stu-id="da11d-123">Optimizing Restores</span></span>  
 <span data-ttu-id="da11d-124">복원 쓰기 시간을 줄이려면 SQL Server 사용자 계정에 **볼륨 유지 관리 작업 수행** 사용자 권한을 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-124">To reduce restore write time, Add **perform volume maintenance tasks** user right to the SQL Server user account.</span></span> <span data-ttu-id="da11d-125">자세한 내용은 [데이터베이스 파일 초기화](https://go.microsoft.com/fwlink/?LinkId=271622)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-125">For more information, see [Database File Initialization](https://go.microsoft.com/fwlink/?LinkId=271622).</span></span> <span data-ttu-id="da11d-126">즉시 파일 초기화가 설정되었는데도 복원 속도가 느리면 데이터베이스가 백업된 인스턴스에서 로그 파일의 크기를 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-126">If restore is still slow with instant file initialization turned on, look at the size of the log file on the instance where the database was backed up.</span></span> <span data-ttu-id="da11d-127">로그 크기가 매우 큰 경우(여러 GB) 복원 속도가 느려질 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-127">If the log is very large in size (multiple GBs), it would be expected that restore would be slow.</span></span> <span data-ttu-id="da11d-128">복원 중에 로그 파일이 초기화되어야 하며 여기에는 상당한 시간이 걸립니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-128">During restore the log file must be zeroed which takes a significant amount of time.</span></span>  
  
 <span data-ttu-id="da11d-129">복원 시간을 단축하기 위해서는 압축된 백업을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-129">To reduce restore times it is recommended that you use compressed backups.</span></span>  <span data-ttu-id="da11d-130">25GB를 초과하는 백업 크기에 대해서는 [AzCopy 유틸리티](https://docs.microsoft.com/archive/blogs/windowsazurestorage/azcopy-uploadingdownloading-files-for-windows-azure-blobs) (영문)를 사용하여 로컬 드라이브로 다운로드한 후 복원을 수행하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-130">For backup sizes exceeding 25 GB, use [AzCopy utility](https://docs.microsoft.com/archive/blogs/windowsazurestorage/azcopy-uploadingdownloading-files-for-windows-azure-blobs) to download to the local drive and then perform the restore.</span></span> <span data-ttu-id="da11d-131">기타 백업 모범 사례 및 권장 사항에 대해서는 [SQL Server Backup to URL Best Practices and Troubleshooting](sql-server-backup-to-url-best-practices-and-troubleshooting.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="da11d-131">For other backup best practices and recommendations, see [SQL Server Backup to URL Best Practices and Troubleshooting](sql-server-backup-to-url-best-practices-and-troubleshooting.md).</span></span>  
  
 <span data-ttu-id="da11d-132">추적 플래그 3051을 설정하여 복원을 수행할 때 자세한 로그를 생성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-132">You can also turn on Trace Flag 3051 when doing the restore to generate a detailed log.</span></span> <span data-ttu-id="da11d-133">이 로그 파일은 로그 디렉터리에 배치되며 BackupToUrl-\<instancename>-\<dbname>-action-\<PID>.log.</span><span class="sxs-lookup"><span data-stu-id="da11d-133">This log file is placed in the log directory, and is named using the format: BackupToUrl-\<instancename>-\<dbname>-action-\<PID>.log.</span></span> <span data-ttu-id="da11d-134">로그 파일에는 문제 진단에 도움이 될 수 있는 시간을 비롯하여 각각의 Azure Storage 왕복에 대한 정보가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="da11d-134">The log file includes information about each round trip to Azure Storage including timing that can be helpful in diagnosing the issue.</span></span>  
  
### <a name="topics-on-performing-restore-operations"></a><span data-ttu-id="da11d-135">복원 작업 수행에 대한 항목</span><span class="sxs-lookup"><span data-stu-id="da11d-135">Topics on Performing Restore Operations</span></span>  
  
-   [<span data-ttu-id="da11d-136">전체 데이터베이스 복원&#40;단순 복구 모델&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-136">Complete Database Restores &#40;Simple Recovery Model&#41;</span></span>](complete-database-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="da11d-137">RESTORE&#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-137">RESTORE &#40;Transact-SQL&#41;</span></span>](/sql/t-sql/statements/restore-statements-transact-sql)  
  
-   [<span data-ttu-id="da11d-138">전체 데이터베이스 복원&#40;전체 복구 모델&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-138">Complete Database Restores &#40;Full Recovery Model&#41;</span></span>](complete-database-restores-full-recovery-model.md)  
  
-   [<span data-ttu-id="da11d-139">파일 복원&#40;단순 복구 모델&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-139">File Restores &#40;Simple Recovery Model&#41;</span></span>](file-restores-simple-recovery-model.md)  
  
-   [<span data-ttu-id="da11d-140">파일 복원&#40;전체 복구 모델&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-140">File Restores &#40;Full Recovery Model&#41;</span></span>](file-restores-full-recovery-model.md)  
  
-   [<span data-ttu-id="da11d-141">증분 복원&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="da11d-141">Piecemeal Restores &#40;SQL Server&#41;</span></span>](piecemeal-restores-sql-server.md)  
  
  
