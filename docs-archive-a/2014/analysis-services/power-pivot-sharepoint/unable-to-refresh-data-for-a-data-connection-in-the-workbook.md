---
title: 통합 문서에서 데이터 연결에 대한 데이터를 새로 고칠 수 없습니다. 다시 시도하거나 시스템 관리자에게 문의하십시오. PowerPivot 데이터 연결을 새로 고치지 못했습니다. Microsoft Docs
ms.custom: ''
ms.date: 03/07/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: analysis-services
ms.topic: conceptual
ms.assetid: 0f6fd52d-ac72-43e3-aa08-05a2d2bb873d
author: minewiskan
ms.author: owend
ms.openlocfilehash: 9c25c2597bbc7aa16fb8b66d4ffddbf0df14515e
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736934"
---
# <a name="unable-to-refresh-data-for-a-data-connection-in-the-workbook-try-again-or-contact-your-system-administrator-the-following-connections-failed-to-refresh-powerpivot-data"></a><span data-ttu-id="b8310-104">통합 문서에서 데이터 연결에 대한 데이터를 새로 고칠 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-104">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="b8310-105">다시 시도하거나 시스템 관리자에게 문의하십시오.</span><span class="sxs-lookup"><span data-stu-id="b8310-105">Try again or contact your system administrator.</span></span> <span data-ttu-id="b8310-106">PowerPivot 데이터 연결을: PowerPivot 데이터</span><span class="sxs-lookup"><span data-stu-id="b8310-106">The following connections failed to refresh: PowerPivot Data</span></span>
  <span data-ttu-id="b8310-107">Excel Services는 PowerPivot 서버에 연결 요청을 제출하고 이 요청이 실패하는 경우 PowerPivot 데이터를 포함하는 Excel 통합 문서에 대해 이 오류를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-107">For Excel workbooks that contain PowerPivot data, Excel Services returns this error if it submits a connection request to a PowerPivot server and the request fails.</span></span>  
  
## <a name="details"></a><span data-ttu-id="b8310-108">세부 정보</span><span class="sxs-lookup"><span data-stu-id="b8310-108">Details</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="b8310-109">적용 대상:</span><span class="sxs-lookup"><span data-stu-id="b8310-109">Applies to:</span></span>|<span data-ttu-id="b8310-110">SharePoint용 PowerPivot 설치</span><span class="sxs-lookup"><span data-stu-id="b8310-110">PowerPivot for SharePoint installation</span></span>|  
|<span data-ttu-id="b8310-111">제품 버전</span><span class="sxs-lookup"><span data-stu-id="b8310-111">Product Version</span></span>|[!INCLUDE[ssKilimanjaro](../../includes/sskilimanjaro-md.md)]<span data-ttu-id="b8310-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span><span class="sxs-lookup"><span data-stu-id="b8310-112">, [!INCLUDE[ssSQL11](../../includes/sssql11-md.md)], [!INCLUDE[ssSQL14](../../includes/sssql14-md.md)]</span></span>|  
|<span data-ttu-id="b8310-113">원인</span><span class="sxs-lookup"><span data-stu-id="b8310-113">Cause</span></span>|<span data-ttu-id="b8310-114">아래 내용을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b8310-114">See below.</span></span>|  
|<span data-ttu-id="b8310-115">메시지 텍스트</span><span class="sxs-lookup"><span data-stu-id="b8310-115">Message Text</span></span>|<span data-ttu-id="b8310-116">통합 문서에서 데이터 연결에 대한 데이터를 새로 고칠 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-116">Unable to refresh data for a data connection in the workbook.</span></span> <span data-ttu-id="b8310-117">다시 시도하거나 시스템 관리자에게 문의하십시오.</span><span class="sxs-lookup"><span data-stu-id="b8310-117">Try again or contact your system administrator.</span></span> <span data-ttu-id="b8310-118">PowerPivot 데이터 연결을: PowerPivot 데이터</span><span class="sxs-lookup"><span data-stu-id="b8310-118">The following connections failed to refresh: PowerPivot Data</span></span>|  
  
## <a name="explanation-and-resolution"></a><span data-ttu-id="b8310-119">설명 및 해결 방법</span><span class="sxs-lookup"><span data-stu-id="b8310-119">Explanation and Resolution</span></span>  
 <span data-ttu-id="b8310-120">Excel Services가 PowerPivot 데이터에 연결하거나 로드할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-120">Excel Services cannot connect to or load the PowerPivot data.</span></span> <span data-ttu-id="b8310-121">이 오류가 발생하는 조건은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-121">Conditions that cause this error to occur include the following:</span></span>  
  
 <span data-ttu-id="b8310-122">**시나리오 1: 서비스가 시작되지 않았습니다.**</span><span class="sxs-lookup"><span data-stu-id="b8310-122">**Scenario 1: Service is not started**</span></span>  
  
 <span data-ttu-id="b8310-123">SQL Server Analysis Services(PowerPivot) 인스턴스가 시작되지 않았습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-123">The SQL Server Analysis Services (PowerPivot) instance is not started.</span></span> <span data-ttu-id="b8310-124">만료된 암호로 인해 서비스 실행이 중지됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-124">An expired password will cause the service to stop running.</span></span> <span data-ttu-id="b8310-125">암호 변경에 대한 자세한 내용은 [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) 및 [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md)를 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="b8310-125">For more information about changing the password, see [Configure PowerPivot Service Accounts](configure-power-pivot-service-accounts.md) and [Start or Stop a PowerPivot for SharePoint Server](start-or-stop-a-power-pivot-for-sharepoint-server.md).</span></span>  
  
 <span data-ttu-id="b8310-126">**시나리오 2a: 서버에서 이전 버전의 통합 문서를 여는 경우**</span><span class="sxs-lookup"><span data-stu-id="b8310-126">**Scenario 2a: Opening an earlier version workbook n the server**</span></span>  
  
 <span data-ttu-id="b8310-127">열려는 통합 문서가 SQL Server 2008 R2 버전의 PowerPivot for Excel에서 작성되었을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-127">The workbook you are attempting to open might have been created in the SQL Server 2008 R2 version of PowerPivot for Excel.</span></span> <span data-ttu-id="b8310-128">이는 대개 데이터 연결 문자열에 지정된 Analysis Services 데이터 공급자가 요청을 처리할 컴퓨터에 없는 경우에 해당합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-128">Most likely, the Analysis Services data provider that is specified in the data connection string is not present on the computer that is handling the request.</span></span>  
  
 <span data-ttu-id="b8310-129">이 경우 ULS 로그에 "통합 문서 ' '의 ' PowerPivot 데이터 '를 새로 고치지 못했습니다." \<URL to workbook> 를 입력 하 고 "연결을 가져올 수 없습니다." 라는 메시지가 표시 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-129">If this is the case, you will find this message in the ULS log: "Refresh failed for 'PowerPivot Data' in the workbook '\<URL to workbook>'", followed by "Unable to get a connection".</span></span>  
  
 <span data-ttu-id="b8310-130">통합 문서의 버전을 확인하려면 Excel에서 해당 통합 문서를 열고 연결 문자열에 지정된 데이터 공급자를 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-130">To determine the version of the workbook, open it in Excel and check which data provider is specified in the connection string.</span></span> <span data-ttu-id="b8310-131">SQL Server 2008 R2 통합 문서는 MSOLAP.4를 데이터 공급자로 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-131">A SQL Server 2008 R2 workbook uses MSOLAP.4 as its data provider.</span></span>  
  
 <span data-ttu-id="b8310-132">통합 문서를 업그레이드하여 이 문제를 해결할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-132">To work around this issue, you can upgrade the workbook.</span></span> <span data-ttu-id="b8310-133">또는 SharePoint용 PowerPivot이나 Excel 서비스를 실행하는 물리적 컴퓨터에 Analysis Services SQL Server 2008 R2 버전의 클라이언트 라이브러리를 설치할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-133">Alternatively, you can install client libraries from the SQL Server 2008 R2 version of Analysis Services on the physical computers running PowerPivot for SharePoint or Excel Services:</span></span>  
  
 [<span data-ttu-id="b8310-134">SharePoint 서버에서 Analysis Services OLE DB Provider 설치</span><span class="sxs-lookup"><span data-stu-id="b8310-134">Install the Analysis Services OLE DB Provider on SharePoint Servers</span></span>](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)  
  
 <span data-ttu-id="b8310-135">**시나리오 2b: 클라이언트 라이브러리 버전이 잘못된 애플리케이션 서버에서 Excel Services를 실행 중인 경우**</span><span class="sxs-lookup"><span data-stu-id="b8310-135">**Scenario 2b: Excel Services is running on an application server that has the wrong version of the client libraries**</span></span>  
  
 <span data-ttu-id="b8310-136">기본적으로 SharePoint Server 2010은 Excel 서비스가 실행되는 애플리케이션 서버에 SQL Server 2008 버전의 Analysis Services OLE DB 공급자를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-136">By default, SharePoint Server 2010 installs the SQL Server 2008 version of the Analysis Services OLE DB provider on application servers that run Excel Services.</span></span> <span data-ttu-id="b8310-137">PowerPivot 데이터 액세스를 지원하는 팜에서 Excel 서비스 및 SharePoint용 PowerPivot과 같이 PowerPivot 데이터를 요청하는 애플리케이션을 실행하는 물리적인 서버는 모두 최신 버전의 데이터 공급자를 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-137">In a farm that supports PowerPivot data access, all physical servers running applications that request PowerPivot data, such as Excel Services and PowerPivot for SharePoint, must use a later version of the data provider.</span></span>  
  
 <span data-ttu-id="b8310-138">SharePoint용 PowerPivot을 실행하는 서버는 업데이트된 OLE DB 데이터 공급자를 자동으로 가져옵니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-138">Servers that run PowerPivot for SharePoint get the updated OLE DB data provider automatically.</span></span> <span data-ttu-id="b8310-139">동일한 컴퓨터에서 SharePoint용 PowerPivot 없이 독립 실행형 인스턴스인 Excel 서비스를 실행하는 서버와 같은 다른 서버는 최신 클라이언트 라이브러리를 사용하도록 패치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-139">Other servers, such as those running a standalone instance Excel Services without PowerPivot for SharePoint on the same computer, must be patched to use the newer client libraries.</span></span> <span data-ttu-id="b8310-140">자세한 내용은 [SharePoint 서버에서 Analysis Services OLE DB 공급자 설치](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b8310-140">For more information, see [Install the Analysis Services OLE DB Provider on SharePoint Servers](../../sql-server/install/install-the-analysis-services-ole-db-provider-on-sharepoint-servers.md).</span></span>  
  
 <span data-ttu-id="b8310-141">**시나리오 3b: 도메인 컨트롤러를 사용할 수 없는 경우**</span><span class="sxs-lookup"><span data-stu-id="b8310-141">**Scenario 3: Domain controller is unavailable**</span></span>  
  
 <span data-ttu-id="b8310-142">사용자 ID의 유효성을 검사하는 데 도메인 컨트롤러를 사용할 수 없기 때문일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-142">The cause might be that a domain controller is not available to validate the user identity.</span></span> <span data-ttu-id="b8310-143">각 연결에서 SharePoint 사용자를 인증하려면 Windows 토큰 서비스에 대한 클레임에 도메인 컨트롤러가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-143">A domain controller is required by the Claims to Windows Token Service to authenticate the SharePoint user on each connection.</span></span> <span data-ttu-id="b8310-144">Windows 토큰 서비스에 대한 클레임은 캐시된 자격 증명을 사용하지 않으며,</span><span class="sxs-lookup"><span data-stu-id="b8310-144">The Claims to Windows Token Service does not use cached credentials.</span></span> <span data-ttu-id="b8310-145">각 연결에 대해 사용자 ID 유효성을 검사합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-145">It validates the user identity for each connection.</span></span>  
  
 <span data-ttu-id="b8310-146">SharePoint 로그 파일을 통해 이 오류의 원인을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-146">You can confirm the cause of this error by viewing the SharePoint log file.</span></span> <span data-ttu-id="b8310-147">SharePoint 로그에 "IClaimsIdentity에서 WindowsIdentity을(를) 가져오지 못했습니다." 메시지가 포함되어 있으면 사용자 ID를 인증할 수 없는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-147">If the SharePoint logs include the message "Failed to get WindowsIdentity from IClaimsIdentity", the user identity could not be authenticated.</span></span>  
  
 <span data-ttu-id="b8310-148">이 문제를 해결하려면 컴퓨터를 PowerPivot 서버와 같은 도메인에 참가시키거나 로컬 컴퓨터에 도메인 컨트롤러를 설치합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-148">To work around this problem, join the computer to the same domain as the PowerPivot server, or install a domain controller on your local computer.</span></span> <span data-ttu-id="b8310-149">두 번째 해결 방법인 도메인 컨트롤러 설치를 수행하려면 모든 서비스 및 사용자에 대해 로컬 도메인 계정을 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-149">The second solution, installing the domain controller, will require you to create local domain accounts for all services and users.</span></span> <span data-ttu-id="b8310-150">정의한 계정에 대해 서비스 계정 및 SharePoint 권한을 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-150">You will need to configure service accounts and SharePoint permissions for the accounts you define.</span></span>  
  
 <span data-ttu-id="b8310-151">오프라인 상태로 SharePoint용 PowerPivot을 사용하는 것이 목적인 경우 컴퓨터에 도메인 컨트롤러를 설치하면 유용합니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-151">Installing a domain controller on your computer is useful if your objective is to use PowerPivot for SharePoint in an offline state.</span></span> <span data-ttu-id="b8310-152">PowerPivot 오프 라인을 사용 하는 방법에 대 한 자세한 내용은의 "네트워크에서 PowerPivot 서버 사용"에 대 한 블로그 항목을 참조 하세요 [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241) .</span><span class="sxs-lookup"><span data-stu-id="b8310-152">For detailed instructions on how to use PowerPivot offline, see the blog entry for "Taking your PowerPivot server off the network" on [http://www.powerpivotgeek.com](https://go.microsoft.com/fwlink/?LinkId=184241).</span></span>  
  
 <span data-ttu-id="b8310-153">**시나리오 4: 서버가 불안정한 경우**</span><span class="sxs-lookup"><span data-stu-id="b8310-153">**Scenario 4: Unstable server**</span></span>  
  
 <span data-ttu-id="b8310-154">하나 이상의 서비스가 일관성이 없는 상태일 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-154">One or more services might be in an inconsistent state.</span></span> <span data-ttu-id="b8310-155">IISRESET를 실행하면 문제가 해결되는 경우가 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b8310-155">In some cases, running IISRESET will resolve the problem.</span></span>  
  
  
