---
title: CDC 제어 태스크 | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
f1_keywords:
- sql12.ssis.designer.cdccontroltask.f1
ms.assetid: 6404dc7f-550c-47cc-b901-c072742f430a
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 36f98a02842353fd5196432738f4ebd8b2efb46c
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87650234"
---
# <a name="cdc-control-task"></a><span data-ttu-id="c6459-102">CDC 제어 태스크</span><span class="sxs-lookup"><span data-stu-id="c6459-102">CDC Control Task</span></span>
  <span data-ttu-id="c6459-103">CDC 제어 태스크는 CDC(변경 데이터 캡처) 패키지의 수명 주기를 제어하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-103">The CDC Control task is used to control the life cycle of change data capture (CDC) packages.</span></span> <span data-ttu-id="c6459-104">이 태스크를 사용하면 초기 로드 패키지와의 CDC 패키지 동기화, CDC 패키지 실행 시 처리되는 LSN(로그 시퀀스 번호) 범위의 관리가 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-104">It handles CDC package synchronization with the initial load package, the management of Log Sequence Number (LSN) ranges that are processed in a run of a CDC package.</span></span> <span data-ttu-id="c6459-105">또한 CDC 제어 태스크는 오류 시나리오 및 복구를 다룹니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-105">In addition, the CDC Control task deals with error scenarios and recovery.</span></span>  
  
 <span data-ttu-id="c6459-106">CDC 제어 태스크는 CDC 패키지의 상태를 SSIS 패키지 변수에 유지합니다. 그러나 이 태스크는 여러 패키지 활성화와 일반적인 CDC 프로세스(예를 들어 한 태스크는 초기 로드를 수행하고 다른 태스크는 trickle-feed 업데이트를 수행할 수 있음)를 함께 수행하는 여러 패키지 간에 상태가 유지되도록 데이터베이스 테이블에 상태를 유지할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-106">The CDC Control task maintains the state of the CDC package in an SSIS package variable and it can also persist it in a database table so that the state is maintained across package activations and between multiple packages that together perform a common CDC process (for example, one task may be responsible for the initial loading and the other for the trickle-feed updates).</span></span>  
  
 <span data-ttu-id="c6459-107">CDC 제어 태스크는 두 작업 그룹을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-107">The CDC Control task supports two groups of operations.</span></span> <span data-ttu-id="c6459-108">한 그룹은 초기 로드와 변경 처리의 동기화를 처리하며 다른 그룹은 CDC 패키지 실행에 대해 LSN의 변경 처리 범위를 관리하고 처리된 항목을 추적합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-108">One group handles the synchronization of initial load and change processing, and the other manages the change-processing range of LSNs for a run of a CDC package and keeps track of what was processed successfully.</span></span>  
  
 <span data-ttu-id="c6459-109">다음 작업은 초기 로드와 변경 처리의 동기화를 처리합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-109">The following operations handle the synchronization of initial load and change processing:</span></span>  
  
|<span data-ttu-id="c6459-110">작업(Operation)</span><span class="sxs-lookup"><span data-stu-id="c6459-110">Operation</span></span>|<span data-ttu-id="c6459-111">Description</span><span class="sxs-lookup"><span data-stu-id="c6459-111">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="c6459-112">ResetCdcState</span><span class="sxs-lookup"><span data-stu-id="c6459-112">ResetCdcState</span></span>|<span data-ttu-id="c6459-113">이 작업은 현재 CDC 컨텍스트에 연결된 영구 CDC 상태를 다시 설정하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-113">This operation is used to reset the persistent CDC state associated with the current CDC context.</span></span> <span data-ttu-id="c6459-114">이 작업을 실행하면 LSN 타임스탬프 `sys.fn_cdc_get_max_lsn` 테이블의 현재 최대 LSN이 다음 처리 범위의 시작 부분이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-114">After this operation is run, the current maximum LSN from the LSN-timestamp `sys.fn_cdc_get_max_lsn` table becomes the start of the range for the next processing range.</span></span> <span data-ttu-id="c6459-115">이 작업을 수행하려면 원본 데이터베이스에 대한 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-115">This operation requires a connection to the source database.</span></span>|  
|<span data-ttu-id="c6459-116">MarkInitialLoadStart</span><span class="sxs-lookup"><span data-stu-id="c6459-116">MarkInitialLoadStart</span></span>|<span data-ttu-id="c6459-117">이 작업은 초기 로드 패키지의 시작 부분에서 초기 로드 패키지가 원본 테이블을 읽기 시작하기 전에 현재 LSN을 원본 데이터베이스에 기록하기 위해 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-117">This operation is used at the beginning of an initial-load package to record the current LSN in the source database before the initial-load package starts reading the source tables.</span></span> <span data-ttu-id="c6459-118">이 작업을 수행하려면 `sys.fn_cdc_get_max_lsn`을 호출하기 위해 원본 데이터베이스에 대한 연결이 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-118">This requires a connection to the source database to call `sys.fn_cdc_get_max_lsn`.</span></span><br /><br /> <span data-ttu-id="c6459-119">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC(즉, Oracle이 아님)에서 작업할 때 MarkInitialLoadStart를 선택하는 경우 연결 관리자에 지정된 사용자는 db_owner 또는 sysadmin이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-119">If you select MarkInitialLoadStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is, not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="c6459-120">MarkInitialLoadEnd</span><span class="sxs-lookup"><span data-stu-id="c6459-120">MarkInitialLoadEnd</span></span>|<span data-ttu-id="c6459-121">이 작업은 초기 로드 패키지의 끝 부분에서 초기 로드 패키지가 원본 테이블 읽기를 완료한 후 현재 LSN을 원본 데이터베이스에 기록하기 위해 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-121">This operation is used at the end of an initial-load package to record the current LSN in the source database after the initial-load package finished reading the source tables.</span></span> <span data-ttu-id="c6459-122">이 LSN은 이 작업이 발생한 현재 시간을 기록한 후 CDC 데이터베이스에서 해당 시간 이후에 발생한 변경 내용을 조회하는 `cdc.lsn_time_`매핑 테이블을 쿼리하여 결정됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-122">This LSN is determined by recording the current time when this operation occurred and then querying the `cdc.lsn_time_`mapping table in the CDC database looking for a change that occurred after that time.</span></span><br /><br /> <span data-ttu-id="c6459-123">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC(즉, Oracle이 아님)에서 작업할 때 MarkInitialLoadEnd를 선택하는 경우 연결 관리자에 지정된 사용자는 db_owner 또는 sysadmin이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-123">If you select MarkInitialLoadEnd when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
|<span data-ttu-id="c6459-124">MarkCdcStart</span><span class="sxs-lookup"><span data-stu-id="c6459-124">MarkCdcStart</span></span>|<span data-ttu-id="c6459-125">이 작업은 스냅샷 데이터베이스에서 초기 로드가 생성될 때 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-125">This operation is used when then the initial load is made from a snapshot database.</span></span> <span data-ttu-id="c6459-126">이 경우 스냅샷 LSN 후에 변경 처리가 즉시 시작되어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-126">In this case, the change processing should start immediately after the snapshot LSN.</span></span> <span data-ttu-id="c6459-127">사용자가 사용할 스냅샷 데이터베이스의 이름을 지정하면 CDC 제어 태스크가 [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] 에 스냅샷 LSN을 쿼리합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-127">You can specify the name of the snapshot database to use and the CDC Control task queries [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] for the snapshot LSN.</span></span> <span data-ttu-id="c6459-128">사용자가 스냅샷 LSN을 직접 지정할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-128">You also have the option to directly specify the snapshot LSN.</span></span><br /><br /> <span data-ttu-id="c6459-129">[!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC(즉, Oracle이 아님)에서 작업할 때 MarkCdcStart를 선택하는 경우 연결 관리자에 지정된 사용자는 db_owner 또는 sysadmin이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-129">If you select MarkCdcStart when working on [!INCLUDE[ssCurrent](../../includes/sscurrent-md.md)] CDC (that is , not Oracle) the user specified in the connection manager must be either  db_owner or sysadmin.</span></span>|  
  
 <span data-ttu-id="c6459-130">처리 범위를 관리하는 데에는 다음과 같은 작업이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-130">The following operations are used to manage the processing range:</span></span>  
  
|<span data-ttu-id="c6459-131">작업(Operation)</span><span class="sxs-lookup"><span data-stu-id="c6459-131">Operation</span></span>|<span data-ttu-id="c6459-132">Description</span><span class="sxs-lookup"><span data-stu-id="c6459-132">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="c6459-133">GetProcessingRange</span><span class="sxs-lookup"><span data-stu-id="c6459-133">GetProcessingRange</span></span>|<span data-ttu-id="c6459-134">이 작업은 CDC 원본 데이터 흐름을 사용하는 데이터 흐름을 호출하기 전에 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-134">This operation is used before invoking the data flow that uses the CDC Source data flow.</span></span> <span data-ttu-id="c6459-135">이 작업은 호출될 때 CDC 원본 데이터 흐름에서 읽는 LSN의 범위를 설정합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-135">It establishes a range of LSNs that the CDC Source data flow reads when invoked.</span></span> <span data-ttu-id="c6459-136">범위는 데이터 흐름을 처리하는 동안 CDC 원본에서 사용되는 SSIS 패키지 변수에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-136">The range is stored in an SSIS package variable that is used by the CDC Source during data-flow processing.</span></span><br /><br /> <span data-ttu-id="c6459-137">저장된 상태에 대한 자세한 내용은 [상태 변수 정의](../data-flow/define-a-state-variable.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c6459-137">For more information about the states that are stored, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>|  
|<span data-ttu-id="c6459-138">MarkProcessedRange</span><span class="sxs-lookup"><span data-stu-id="c6459-138">MarkProcessedRange</span></span>|<span data-ttu-id="c6459-139">: 이 작업은 각 CDC 실행 후(CDC 데이터 흐름이 성공적으로 완료된 후) CDC 실행 중에 완전히 처리된 마지막 LSN을 기록하기 위해 실행됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-139">: This operation is executed after each CDC run (after the CDC data flow is completed successfully) to record the last LSN that was fully processed in the CDC run.</span></span> <span data-ttu-id="c6459-140">다음에 GetProcessingRange를 실행하면 이 위치가 처리 범위의 시작 부분이 됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-140">The next time GetProcessingRange is executed, this position is the start of the processing range.</span></span>|  
  
## <a name="handling-cdc-state-persistency"></a><span data-ttu-id="c6459-141">CDC 상태 지속성 처리</span><span class="sxs-lookup"><span data-stu-id="c6459-141">Handling CDC State Persistency</span></span>  
 <span data-ttu-id="c6459-142">CDC 제어 태스크는 활성화 간에 영구 상태를 유지합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-142">The CDC Control task maintains a persistent state between activations.</span></span> <span data-ttu-id="c6459-143">CDC 상태에 저장되는 정보는 CDC 패키지의 처리 범위를 결정 및 유지하고 오류 상태를 검색하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-143">The information stored in the CDC state is used to determine and maintain the processing range for the CDC package and for detecting error conditions.</span></span> <span data-ttu-id="c6459-144">영구 상태는 문자열로 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-144">The persistent state is stored as a string.</span></span> <span data-ttu-id="c6459-145">자세한 내용은 [상태 변수 정의](../data-flow/define-a-state-variable.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="c6459-145">For more information, see [Define a State Variable](../data-flow/define-a-state-variable.md).</span></span>  
  
 <span data-ttu-id="c6459-146">CDC 제어 태스크는 두 가지 유형의 상태 지속성을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-146">The CDC Control task supports two types of state persistency</span></span>  
  
-   <span data-ttu-id="c6459-147">수동 상태 지속성: 이 경우 CDC 제어 태스크가 패키지 변수에 저장된 상태를 관리하지만 패키지 개발자가 CDC 제어를 호출하기 전에 영구 저장소에서 변수를 읽은 다음 CDC 제어가 마지막으로 호출되고 CDC 실행이 완료된 후에 해당 영구 저장소에 변수를 다시 써야 합니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-147">Manual State Persistency: In this case, the CDC Control task manages the state stored in a package variable but the package developer must read the variable from a persistent store before calling the CDC Control and then write it back to that persistent store after the CDC Control is last called and the CDC run completes.</span></span>  
  
-   <span data-ttu-id="c6459-148">자동 상태 지속성: CDC 상태가 데이터베이스의 테이블에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-148">Automatic State Persistency: The CDC state is stored in a table in a database.</span></span> <span data-ttu-id="c6459-149">상태는 **상태를 저장하는 데 사용할 테이블** 속성(상태 저장을 위해 선택한 연결 관리자에 있음)으로 지정한 테이블의 **StateName** 속성에 제공된 이름으로 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-149">The state is stored under a name provided in the **StateName** property in a table named in the **Table to Use for Storing State** property, which is located in a selected connection manager for storing the state.</span></span> <span data-ttu-id="c6459-150">기본값은 원본 연결 관리자이지만 대상 연결 관리자를 사용하는 것이 일반적입니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-150">The default is the source connection manager but the common practice is for it to be the target connection manager.</span></span> <span data-ttu-id="c6459-151">CDC 제어 태스크는 상태 테이블에서 상태 값을 업데이트하며 이는 앰비언트 트랜잭션의 일환으로 커밋됩니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-151">The CDC Control task updates the state value in the state table and this is committed as part of the ambient transaction.</span></span>  
  
## <a name="error-handling"></a><span data-ttu-id="c6459-152">오류 처리</span><span class="sxs-lookup"><span data-stu-id="c6459-152">Error Handling</span></span>  
 <span data-ttu-id="c6459-153">CDC 제어 태스크는 다음과 같은 경우 오류를 보고할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-153">The CDC Control task may report an error when:</span></span>  
  
-   <span data-ttu-id="c6459-154">영구 CDC 상태를 읽지 못하거나 영구 상태를 업데이트하지 못할 경우</span><span class="sxs-lookup"><span data-stu-id="c6459-154">It fails to read the persistent CDC state or when updating the persistent state fails.</span></span>  
  
-   <span data-ttu-id="c6459-155">원본 데이터베이스에서 현재 LSN 정보를 읽지 못할 경우</span><span class="sxs-lookup"><span data-stu-id="c6459-155">It fails to read the current LSN information from the source database.</span></span>  
  
-   <span data-ttu-id="c6459-156">CDC 상태 읽기가 일관되지 않을 경우</span><span class="sxs-lookup"><span data-stu-id="c6459-156">The CDC state read is not consistent.</span></span>  
  
 <span data-ttu-id="c6459-157">이러한 모든 경우 CDC 제어 태스크는 오류를 보고합니다. 이러한 오류는 SSIS가 제어 흐름 오류를 처리하는 표준 방식으로 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-157">In all of these cases, the CDC Control task reports an error that can be handled in the standard way SSIS handles control-flow errors.</span></span>  
  
 <span data-ttu-id="c6459-158">CDC 제어 태스크는 처리된 범위 표시가 호출되지 않은 채 처리 범위 가져오기 작업 직후에 다른 처리 범위 가져오기 작업이 호출될 때도 경고를 보고할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-158">The CDC Control task may also report a warning when the Get Processing Range operation is invoked directly after another Get Processing Range operation without Mark Processed Range being called.</span></span> <span data-ttu-id="c6459-159">이는 이전 실행이 실패했거나 동일한 CDC 상태 이름을 사용하는 다른 CDC 패키지가 실행되고 있을 수 있음을 나타냅니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-159">This is an indication that the previous run failed or that another CDC package may be running using the same CDC state name.</span></span>  
  
## <a name="configuring-the-cdc-control-task"></a><span data-ttu-id="c6459-160">CDC 제어 태스크 구성</span><span class="sxs-lookup"><span data-stu-id="c6459-160">Configuring the CDC Control Task</span></span>  
 <span data-ttu-id="c6459-161">SSIS 디자이너를 사용하거나 프로그래밍 방식으로 속성을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="c6459-161">You can set properties through SSIS Designer or programmatically.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="c6459-162">섹션 내용</span><span class="sxs-lookup"><span data-stu-id="c6459-162">In This Section</span></span>  
  
-   [<span data-ttu-id="c6459-163">CDC 제어 태스크 편집기</span><span class="sxs-lookup"><span data-stu-id="c6459-163">CDC Control Task Editor</span></span>](../cdc-control-task-editor.md)  
  
-   [<span data-ttu-id="c6459-164">CDC 제어 태스크 사용자 지정 속성</span><span class="sxs-lookup"><span data-stu-id="c6459-164">CDC Control Task Custom Properties</span></span>](cdc-control-task-custom-properties.md)  
  
## <a name="related-tasks"></a><span data-ttu-id="c6459-165">관련 작업</span><span class="sxs-lookup"><span data-stu-id="c6459-165">Related Tasks</span></span>  
 [<span data-ttu-id="c6459-166">상태 변수 정의</span><span class="sxs-lookup"><span data-stu-id="c6459-166">Define a State Variable</span></span>](../data-flow/define-a-state-variable.md)  
  
## <a name="related-content"></a><span data-ttu-id="c6459-167">관련 내용</span><span class="sxs-lookup"><span data-stu-id="c6459-167">Related Content</span></span>  
  
-   <span data-ttu-id="c6459-168">social.technet.microsoft.com의 기술 문서, [Attunity Oracle을 위한 Microsoft SQL Server 2012 변경 데이터 캡처 설치](https://go.microsoft.com/fwlink/?LinkId=252958)</span><span class="sxs-lookup"><span data-stu-id="c6459-168">Technical article, [Installing Microsoft SQL Server 2012 Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252958), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="c6459-169">social.technet.microsoft.com의 기술 문서, [Attunity Oracle용 Microsoft 변경 데이터 캡처의 구성 문제 해결](https://go.microsoft.com/fwlink/?LinkId=252960)</span><span class="sxs-lookup"><span data-stu-id="c6459-169">Technical article, [Troubleshoot Configuration Issues in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252960), on social.technet.microsoft.com.</span></span>  
  
-   <span data-ttu-id="c6459-170">social.technet.microsoft.com의 기술 문서, [Attunity Oracle용 Microsoft 변경 데이터 캡처의 CDC 인스턴스 오류 문제 해결](https://go.microsoft.com/fwlink/?LinkId=252961)</span><span class="sxs-lookup"><span data-stu-id="c6459-170">Technical article, [Troubleshoot CDC Instance Errors in Microsoft Change Data Capture for Oracle by Attunity](https://go.microsoft.com/fwlink/?LinkId=252961), on social.technet.microsoft.com.</span></span>  
  
  
