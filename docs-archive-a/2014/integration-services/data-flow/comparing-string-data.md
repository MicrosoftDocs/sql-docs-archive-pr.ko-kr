---
title: 문자열 데이터 비교 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: integration-services
ms.topic: conceptual
helpviewer_keywords:
- comparing string data
- comparison options [Integration Services]
- locales [Integration Services]
- converting string data
- string comparisons
ms.assetid: 93aeb5bd-e208-46b7-8979-dea2dcd37d4c
author: chugugrace
ms.author: chugu
ms.openlocfilehash: 5670f434470d8fad0a8b593ccde0c01ae307e417
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87660081"
---
# <a name="comparing-string-data"></a><span data-ttu-id="9f254-102">문자열 데이터 비교</span><span class="sxs-lookup"><span data-stu-id="9f254-102">Comparing String Data</span></span>
  <span data-ttu-id="9f254-103">문자열 비교는 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)]에서 수행되는 여러 변환에서 중요한 부분이며, 변수의 식 및 속성 식 평가에도 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-103">String comparisons are an important part of many of the transformations performed by [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)], and string comparisons are also used in the evaluation of expressions in variables and property expressions.</span></span> <span data-ttu-id="9f254-104">예를 들어 정렬 변환에서는 데이터 세트의 값을 비교하여 데이터를 오름차순 또는 내림차순으로 정렬합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-104">For example, the Sort transformation compares values in a dataset to sort data in ascending or descending order.</span></span>  
  
## <a name="configuring-transformations-for-string-comparisons"></a><span data-ttu-id="9f254-105">문자열 비교를 위한 변환 구성</span><span class="sxs-lookup"><span data-stu-id="9f254-105">Configuring Transformations for String Comparisons</span></span>  
 <span data-ttu-id="9f254-106">정렬, 집계, 유사 항목 그룹화, 유사 항목 조회 변환을 사용자 지정하여 열 수준에서 문자열이 비교되는 방식을 변경할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-106">The Sort, Aggregate, Fuzzy Grouping, and Fuzzy Lookup transformations can be customized to change the way strings are compared at the column level.</span></span> <span data-ttu-id="9f254-107">예를 들어 비교 시 대/소문자를 무시하여 대문자와 소문자가 모두 동일한 문자로 취급되도록 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-107">For example, you can specify that a comparison ignores case, which means that uppercase and lowercase characters are treated as the same character.</span></span>  
  
 <span data-ttu-id="9f254-108">다음 변환에서는 문자열 비교를 포함할 수 있는 식이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-108">The following transformations use expressions that can include string comparisons.</span></span>  
  
-   <span data-ttu-id="9f254-109">조건부 분할 변환에서는 식에서 문자열 비교를 사용하여 데이터 행을 전송할 출력을 결정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-109">The Conditional Split transformation can use string comparisons in expressions to determine which output to send the data row to.</span></span> <span data-ttu-id="9f254-110">자세한 내용은 [Conditional Split Transformation](transformations/conditional-split-transformation.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9f254-110">For more information, see [Conditional Split Transformation](transformations/conditional-split-transformation.md).</span></span>  
  
-   <span data-ttu-id="9f254-111">파생 열 변환에서는 식에서 문자열 비교를 사용하여 새 열 값을 생성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-111">The Derived Column transformation can use string comparisons in expressions to generate new column values.</span></span> <span data-ttu-id="9f254-112">자세한 내용은 [파생 열 변환](transformations/derived-column-transformation.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9f254-112">For more information, see [Derived Column Transformation](transformations/derived-column-transformation.md).</span></span>  
  
 <span data-ttu-id="9f254-113">또한 변수, 변수 매핑 및 선행 제약 조건에서는 문자열 비교가 포함될 수 있는 식이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-113">Variables, variable mappings, and precedence constraints also use expressions, which can include string comparisons.</span></span> <span data-ttu-id="9f254-114">식에 대한 자세한 내용은 [Integration Services&#40;SSIS&#41; 식](../expressions/integration-services-ssis-expressions.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="9f254-114">For more information about expressions, see [Integration Services &#40;SSIS&#41; Expressions](../expressions/integration-services-ssis-expressions.md).</span></span>  
  
## <a name="processing-during-string-comparison"></a><span data-ttu-id="9f254-115">문자열 비교 시 수행되는 처리</span><span class="sxs-lookup"><span data-stu-id="9f254-115">Processing during String Comparison</span></span>  
 <span data-ttu-id="9f254-116">데이터 및 변환 구성에 따라 문자열 데이터 비교 중에 다음 처리 작업이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-116">Depending on the data and the configuration of the transformation, the following processing may occur during the comparison of string data:</span></span>  
  
-   <span data-ttu-id="9f254-117">데이터를 유니코드로 변환합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-117">Converting data to Unicode.</span></span> <span data-ttu-id="9f254-118">원본 데이터가 아직 유니코드가 아닌 경우 비교가 발생하기 전에 데이터가 자동으로 유니코드로 변환됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-118">If the source data is not already Unicode, the data is automatically converted to Unicode before the comparison occurs.</span></span>  
  
-   <span data-ttu-id="9f254-119">로캘을 사용하여 날짜, 시간, 숫자 데이터 및 정렬 순서를 해석하기 위한 로캘 특정 규칙을 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-119">Using locale to apply locale-specific rules for interpreting date, time, decimal data, and sort order.</span></span>  
  
-   <span data-ttu-id="9f254-120">열 수준에서 비교 옵션을 적용하여 비교 시 대/소문자 구분 여부를 변경합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-120">Applying comparison options at the column level to change the sensitivity of comparisons.</span></span>  
  
## <a name="converting-string-data-to-unicode"></a><span data-ttu-id="9f254-121">문자열 데이터를 유니코드로 변환</span><span class="sxs-lookup"><span data-stu-id="9f254-121">Converting String Data to Unicode</span></span>  
 <span data-ttu-id="9f254-122">변환에서 수행되는 작업 및 변환 구성에 따라 문자열 데이터를 문자열의 유니코드 표현인 DT_WSTR 데이터 형식으로 변환할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-122">Depending on the operations that the transformation performs and the configuration of the transformation, string data may be converted to the DT_WSTR data type, which is a Unicode representation of string characters.</span></span>  
  
 <span data-ttu-id="9f254-123">데이터 형식이 DT_STR인 문자열 데이터는 열의 코드 페이지를 사용하여 유니코드로 변환됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-123">String data that has the DT_STR data type is converted to Unicode using the code page of the column.</span></span> [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="9f254-124">에서는 열 수준의 코드 페이지가 지원되며 각 열은 다른 코드 페이지를 사용하여 변환될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-124">supports code pages at the column level, and each column can be converted by using a different code page.</span></span>  
  
 <span data-ttu-id="9f254-125">대부분의 경우 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 에서는 데이터 원본의 올바른 코드 페이지를 식별할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-125">In most cases, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] can identify the correct code page from the data source.</span></span> <span data-ttu-id="9f254-126">예를 들어 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 에서 데이터베이스 및 열 수준의 데이터 정렬을 설정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-126">For example, in [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] you can set a collation at the database and column levels.</span></span> <span data-ttu-id="9f254-127">코드 페이지는 Windows 또는 SQL 데이터 정렬 중 하나일 수 있는 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 데이터 정렬로부터 파생됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-127">The code page is derived from a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] collation, which can be either a Windows or an SQL collation.</span></span>  
  
 <span data-ttu-id="9f254-128">[!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 에서 예기치 않은 코드 페이지가 제공되는 경우 또는 패키지에서 올바른 코드 페이지를 확인하는 데 필요한 정보가 충분하지 않은 공급자를 사용하여 데이터 원본에 액세스하는 경우에는 OLE DB 원본과 OLE DB 대상의 기본 코드 페이지를 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-128">If [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides an unexpected code page, or if the package accesses a data source by using a provider that does not supply sufficient information to determine the correct code page, you can specify a default code page in the OLE DB source and the OLE DB destination.</span></span> <span data-ttu-id="9f254-129">기본 코드 페이지는 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 에서 제공되는 코드 페이지 대신 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-129">The default code pages are used instead of the code pages that [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] provides.</span></span>  
  
 <span data-ttu-id="9f254-130">파일에는 코드 페이지가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-130">Files do not have code pages.</span></span> <span data-ttu-id="9f254-131">대신 패키지에서 파일 데이터에 연결하기 위해 사용하는 플랫 파일과 다중 플랫 파일 연결 관리자에는 파일의 코드 페이지를 지정하기 위한 속성이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-131">Instead, the Flat File and the Multiple Flat Files connection managers that a package uses to connect to file data include a property for specifying the code page of the file.</span></span> <span data-ttu-id="9f254-132">코드 페이지는 열 수준이 아닌 파일 수준에서만 설정될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-132">The code page can be set at the file level only, not at the column level.</span></span>  
  
## <a name="setting-locale"></a><span data-ttu-id="9f254-133">로캘 설정</span><span class="sxs-lookup"><span data-stu-id="9f254-133">Setting Locale</span></span>  
 [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] <span data-ttu-id="9f254-134">에서는 코드 페이지를 사용하여 데이터 정렬 또는 날짜, 시간 및 숫자 데이터 해석을 위한 로캘 특정 규칙을 유추하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-134">does not use the code page to infer locale-specific rules for sorting data or interpreting date, time, and decimal data.</span></span> <span data-ttu-id="9f254-135">그 대신 변환이 데이터 흐름 구성 요소, 데이터 흐름 태스크, 컨테이너 또는 패키지의 LocaleId 속성으로 설정된 로캘을 읽습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-135">Instead, the transformation reads the locale that is set by the LocaleId property on the data flow component, Data Flow task, container, or package.</span></span> <span data-ttu-id="9f254-136">기본적으로 변환의 로캘은 해당 데이터 흐름 태스크로부터 상속되며, 이 작업은 패키지로부터 상속됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-136">By default, the locale of a transformation is inherited from its Data Flow task, which in turn inherits from the package.</span></span> <span data-ttu-id="9f254-137">데이터 흐름 태스크가 For 루프 컨테이너와 같은 컨테이너에 포함되는 경우 이 태스크는 컨테이너의 로캘을 상속합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-137">If the Data Flow task is in a container such as the For Loop container, it inherits its locale from the container.</span></span>  
  
 <span data-ttu-id="9f254-138">또한 플랫 파일 연결 관리자와 다중 플랫 파일 연결 관리자에 대한 로캘을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-138">You can also specify a locale for a Flat File connection manager and a Multiple Flat Files connection manager.</span></span>  
  
## <a name="setting-comparison-options"></a><span data-ttu-id="9f254-139">비교 옵션 설정</span><span class="sxs-lookup"><span data-stu-id="9f254-139">Setting Comparison Options</span></span>  
 <span data-ttu-id="9f254-140">로캘은 문자열 데이터 비교를 위한 기본 규칙을 제공합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-140">The locale provides the basic rules for comparing string data.</span></span> <span data-ttu-id="9f254-141">예를 들어 로캘은 영문자의 각 문자에 대한 정렬 위치를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-141">For example, the locale specifies the sort position of each letter in the alphabet.</span></span> <span data-ttu-id="9f254-142">하지만 이러한 규칙만으로는 일부 변환에서 수행되는 비교 시 충분하지 않을 수 있으며, [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] 에서는 로캘의 비교 규칙 이외에도 일련의 고급 비교 옵션이 지원됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-142">However, these rules may not be sufficient for the comparisons that some transformations perform, and [!INCLUDE[ssISnoversion](../../includes/ssisnoversion-md.md)] supports a set of advanced comparison options that go beyond the comparison rules of a locale.</span></span> <span data-ttu-id="9f254-143">이러한 비교 옵션은 열 수준에서 설정됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-143">These comparison options are set at the column level.</span></span> <span data-ttu-id="9f254-144">예를 들어 비교 옵션 중 하나를 사용하면 비공백 문자를 무시할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-144">For example, one of the comparison options lets you ignore nonspacing characters.</span></span> <span data-ttu-id="9f254-145">이 옵션은 비교 목적으로 "a"와 "있습니다"을 동일 하 게 하는 악센트 부호와 같은 분음 부호를 무시 하는 데 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-145">The effect of this option is to ignore diacritics such as the accent, which makes "a" and "å" identical for comparison purposes.</span></span>  
  
 <span data-ttu-id="9f254-146">다음 표에서는 비교 옵션과 정렬 스타일에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-146">The following table describes the comparison options and a sort style.</span></span>  
  
|<span data-ttu-id="9f254-147">비교 옵션</span><span class="sxs-lookup"><span data-stu-id="9f254-147">Comparison option</span></span>|<span data-ttu-id="9f254-148">Description</span><span class="sxs-lookup"><span data-stu-id="9f254-148">Description</span></span>|  
|-----------------------|-----------------|  
|<span data-ttu-id="9f254-149">대/소문자 무시</span><span class="sxs-lookup"><span data-stu-id="9f254-149">Ignore case</span></span>|<span data-ttu-id="9f254-150">비교 시 대문자와 소문자를 구분할지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-150">Specifies whether the comparison distinguishes between uppercase and lowercase letters.</span></span> <span data-ttu-id="9f254-151">이 옵션을 설정하면 문자열 비교 시 대/소문자가 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-151">If this option is set, the string comparison ignores case.</span></span> <span data-ttu-id="9f254-152">예를 들어 "ABC"는 "abc"와 동일하게 인식됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-152">For example, "ABC" becomes the same as "abc".</span></span>|  
|<span data-ttu-id="9f254-153">가나 형식 무시</span><span class="sxs-lookup"><span data-stu-id="9f254-153">Ignore kana type</span></span>|<span data-ttu-id="9f254-154">비교 시 두 가지 형식의 일본어 가나 문자인 히라가나와 가타가나를 구분합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-154">Specifies whether the comparison distinguishes between the two types of Japanese kana characters: hiragana and katakana.</span></span> <span data-ttu-id="9f254-155">이 옵션을 설정하면 문자열 비교 시 가나 형식이 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-155">If this option is set, the string comparison ignores kana type.</span></span>|  
|<span data-ttu-id="9f254-156">문자 너비 무시</span><span class="sxs-lookup"><span data-stu-id="9f254-156">Ignore character width</span></span>|<span data-ttu-id="9f254-157">비교 시 싱글바이트 문자와 동일 문자의 더블바이트 문자 표현을 구분할지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-157">Specifies whether the comparison distinguishes between a single-byte character and the same character when it is represented as a double-byte character.</span></span> <span data-ttu-id="9f254-158">이 옵션을 설정하면 문자열 비교 시 동일 문자에 대한 싱글바이트 표현과 더블바이트 표현이 동일하게 인식됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-158">If this option is set, the string comparison treats single-byte and double-byte representations of the same character as identical.</span></span>|  
|<span data-ttu-id="9f254-159">비공백 문자 무시</span><span class="sxs-lookup"><span data-stu-id="9f254-159">Ignore nonspacing characters</span></span>|<span data-ttu-id="9f254-160">비교 시 공백 문자와 분음 기호를 구분할지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-160">Specifies whether the comparison distinguishes between spacing characters and diacritics.</span></span> <span data-ttu-id="9f254-161">이 옵션을 설정하면 비교 시 분음 기호가 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-161">If this option is set, the comparison ignores diacritics.</span></span> <span data-ttu-id="9f254-162">예를 들어 "å"와 "a"는 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-162">For example, "å" is equal to "a".</span></span>|  
|<span data-ttu-id="9f254-163">기호 무시</span><span class="sxs-lookup"><span data-stu-id="9f254-163">Ignore symbols</span></span>|<span data-ttu-id="9f254-164">비교 시 글자 문자와 공백 문자, 문장 부호, 통화 기호 및 수학 기호와 같은 기호를 구분할지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-164">Specifies whether the comparison distinguishes between letter characters and symbols such as white-space characters, punctuation, currency symbols, and mathematical symbols.</span></span> <span data-ttu-id="9f254-165">이 옵션을 설정하면 문자열 비교 시 기호가 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-165">If this option is set, the string comparison ignores symbols.</span></span> <span data-ttu-id="9f254-166">예를 들어 " New York"은 "New York"과 동일하며 "\*ABC"는 "ABC"와 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-166">For example, " New York" becomes the same as "New York" and "\*ABC" is the same as "ABC"'.</span></span>|  
|<span data-ttu-id="9f254-167">문장 부호를 기호로 정렬</span><span class="sxs-lookup"><span data-stu-id="9f254-167">Sort punctuation as symbols</span></span>|<span data-ttu-id="9f254-168">비교 시 영숫자 문자 앞에서 하이픈과 아포스트로피를 제외한 모든 문장 부호를 정렬할지 여부를 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-168">Specifies whether the comparison sorts all punctuation symbols, except the hyphen and apostrophe, before the alphanumeric characters.</span></span> <span data-ttu-id="9f254-169">예를 들어 이 옵션을 설정하면 ".ABC"가 "ABC" 앞에 정렬됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-169">For example, if this option is set, ".ABC" sorts before "ABC".</span></span>|  
  
 <span data-ttu-id="9f254-170">정렬, 집계, 유사 항목 그룹화 및 유사 항목 조회 변환에는 데이터 비교를 위한 이러한 옵션이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-170">The Sort, Aggregate, Fuzzy Grouping and Fuzzy Lookup transformations include these options for comparing data.</span></span>  
  
 <span data-ttu-id="9f254-171">**FullySensitive** 비교 플래그는 유사 항목 그룹화 및 유사 항목 조회 변환을 위해 **고급 편집기** 대화 상자에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-171">The **FullySensitive** comparison flag displays in the **Advanced Editor** dialog box for the Fuzzy Grouping and Fuzzy Lookup transformations.</span></span> <span data-ttu-id="9f254-172">**FullySensitive** 비교 플래그를 선택하면 모든 비교 옵션이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="9f254-172">Selecting the **FullySensitive** comparison flag means that all the comparison options apply.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f254-173">참고 항목</span><span class="sxs-lookup"><span data-stu-id="9f254-173">See Also</span></span>  
 <span data-ttu-id="9f254-174">[Integration Services 데이터 형식](integration-services-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="9f254-174">[Integration Services Data Types](integration-services-data-types.md) </span></span>  
 <span data-ttu-id="9f254-175">[빠른 구문 분석](../fast-parse.md) </span><span class="sxs-lookup"><span data-stu-id="9f254-175">[Fast Parse](../fast-parse.md) </span></span>  
 [<span data-ttu-id="9f254-176">표준 구문 분석</span><span class="sxs-lookup"><span data-stu-id="9f254-176">Standard Parse</span></span>](../standard-parse.md)  
  
  
