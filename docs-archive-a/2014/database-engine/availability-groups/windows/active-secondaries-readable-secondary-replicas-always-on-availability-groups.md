---
title: '활성 보조: 읽기 가능한 보조 복제본 (Always On 가용성 그룹) | Microsoft Docs'
ms.custom: ''
ms.date: 10/27/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- connection access to availability replicas
- Availability Groups [SQL Server], availability replicas
- Availability Groups [SQL Server], readable secondary replicas
- active secondary replicas [SQL Server], read-only access to
- readable secondary replicas
- Availability Groups [SQL Server], active secondary replicas
ms.assetid: 78f3f81a-066a-4fff-b023-7725ff874fdf
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: 8b85704b8110eb84ea6f4c33dfa79694112c2328
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87661368"
---
# <a name="active-secondaries-readable-secondary-replicas-always-on-availability-groups"></a><span data-ttu-id="b4d2b-102">활성 보조: 읽기 가능한 보조 복제본(Always On 가용성 그룹)</span><span class="sxs-lookup"><span data-stu-id="b4d2b-102">Active Secondaries: Readable Secondary Replicas (Always On Availability Groups)</span></span>
  <span data-ttu-id="b4d2b-103">[!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] 활성 보조 기능에는 하나 이상의 보조 복제본(*읽기 가능한 보조 복제본*)에 대한 읽기 전용 액세스 지원이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-103">The [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] active secondary capabilities include support for read-only access to one or more secondary replicas (*readable secondary replicas*).</span></span> <span data-ttu-id="b4d2b-104">읽기 가능한 보조 복제본은 해당 보조 데이터베이스 모두에 대한 읽기 전용 액세스를 허용합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-104">A readable secondary replica allows read-only access to all its secondary databases.</span></span> <span data-ttu-id="b4d2b-105">하지만 읽기 가능한 보조 데이터베이스는 읽기 전용으로 설정되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-105">However, readable secondary databases are not set to read-only.</span></span> <span data-ttu-id="b4d2b-106">이러한 데이터베이스는 동적입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-106">They are dynamic.</span></span> <span data-ttu-id="b4d2b-107">해당 주 데이터베이스에서 변경 내용이 발생하면 보조 데이터베이스도 변경됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-107">A given secondary database changes as changes on the corresponding primary database are applied to the secondary database.</span></span> <span data-ttu-id="b4d2b-108">일반적인 보조 복제본의 경우 보조 데이터베이스의 내구성이 있는 메모리 액세스에 최적화된 테이블을 포함한 데이터는 거의 실시간 데이터입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-108">For a typical secondary replica, the data, including durable memory optimized tables, in the secondary databases is in near real time.</span></span> <span data-ttu-id="b4d2b-109">또한 전체 텍스트 인덱스는 보조 데이터베이스와 동기화됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-109">Furthermore, full-text indexes are synchronized with the secondary databases.</span></span> <span data-ttu-id="b4d2b-110">대부분의 경우 주 데이터베이스와 해당하는 보조 데이터베이스 간의 데이터 대기 시간은 몇 초 이내입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-110">In many circumstances, data latency between a primary database and the corresponding secondary database is only a few seconds.</span></span>  
  
 <span data-ttu-id="b4d2b-111">주 데이터베이스에서 적용되는 보안 설정은 보조 데이터베이스에서도 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-111">Security settings that occur in the primary databases are persisted to the secondary databases.</span></span> <span data-ttu-id="b4d2b-112">여기에는 사용자, 데이터베이스 역할 및 애플리케이션 역할과 함께 각각의 사용 권한이 포함되며 주 데이터베이스에 TDE(투명한 데이터 암호화)가 설정되어 있는 경우 TDE도 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-112">This includes users, database roles, and applications roles together with their respective permissions and transparent data encryption (TDE), if enabled on the primary database.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b4d2b-113">보조 데이터베이스에 데이터를 쓸 수는 없지만 **tempdb**와 같은 시스템 데이터베이스, 사용자 데이터베이스를 비롯하여 보조 복제본을 호스트하는 서버 인스턴스의 읽기/쓰기 데이터베이스에는 데이터를 쓸 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-113">Though you cannot write data to secondary databases, you can write to read-write databases on the server instance that hosts the secondary replica, including user databases and system databases such as **tempdb**.</span></span>  
  
 [!INCLUDE[ssHADR](../../../includes/sshadr-md.md)] <span data-ttu-id="b4d2b-114">은 읽기 전용 연결 요청을 읽기 가능한 보조 복제본으로 다시 라우팅하는 기능(*읽기 전용 라우팅*)도 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-114">also supports the re-routing of read-intent connection requests to a readable secondary replica (*read-only routing*).</span></span> <span data-ttu-id="b4d2b-115">읽기 전용 라우팅에 대한 자세한 내용은 [수신기를 사용하여 읽기 전용 보조 복제본(읽기 전용 라우팅)에 연결](../../listeners-client-connectivity-application-failover.md#ConnectToSecondary)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-115">For information about read-only routing, see [Using a Listener to Connect to a Read-Only Secondary Replica (Read-Only Routing)](../../listeners-client-connectivity-application-failover.md#ConnectToSecondary).</span></span>  
  
 
  
##  <a name="benefits"></a><a name="bkmk_Benefits"></a> <span data-ttu-id="b4d2b-116">이점</span><span class="sxs-lookup"><span data-stu-id="b4d2b-116">Benefits</span></span>  
 <span data-ttu-id="b4d2b-117">읽기 가능한 보조 복제본에 대한 읽기 전용 연결을 허용하면 다음과 같은 이점이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-117">Directing read-only connections to readable secondary replicas provides the following benefits:</span></span>  
  
-   <span data-ttu-id="b4d2b-118">주 복제본에서 보조 읽기 전용 작업을 줄여 주므로 중요한 작업을 위해 주 복제본의 리소스를 절약할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-118">Offloads your secondary read-only workloads from your primary replica, which conserves its resources for your mission critical workloads.</span></span> <span data-ttu-id="b4d2b-119">매우 중요한 읽기 작업이 있거나 대기 시간을 허용할 수 없는 작업이 있으면 주 복제본에서 실행해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-119">If you have mission critical read-workload or the workload that cannot tolerate latency, you should run it on the primary.</span></span>  
  
-   <span data-ttu-id="b4d2b-120">읽기 가능한 보조 복제본을 호스팅하는 시스템에 대한 투자 수익을 향상시킵니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-120">Improves your return on investment for the systems that host readable secondary replicas.</span></span>  
  
 <span data-ttu-id="b4d2b-121">또한 읽기 가능한 보조 복제본은 다음과 같이 읽기 전용 작업을 지원합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-121">In addition, readable secondaries provide robust support for read-only operations, as follows:</span></span>  
  
-   <span data-ttu-id="b4d2b-122">읽기 가능한 보조 데이터베이스에 대한 자동 임시 통계를 통해 디스크 기반 테이블의 읽기 전용 쿼리를 최적화할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-122">Automatic temporary statistics on readable secondary database optimize read-only queries on disk-based tables.</span></span> <span data-ttu-id="b4d2b-123">메모리 액세스에 최적화된 테이블의 경우 누락 통계가 자동으로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-123">For memory-optimized tables, the missing statistics are created automatically.</span></span> <span data-ttu-id="b4d2b-124">하지만 부실 통계의 자동 업데이트는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-124">However, there is no auto-update of stale statistics.</span></span> <span data-ttu-id="b4d2b-125">주 복제본에서 통계를 수동으로 업데이트해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-125">You will need to manually update the statistics on the primary replica.</span></span> <span data-ttu-id="b4d2b-126">자세한 내용은 이 항목 뒷부분에 있는 [읽기 전용 액세스 데이터베이스에 대한 통계](#Read-OnlyStats)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-126">For more information, see [Statistics for Read-Only Access Databases](#Read-OnlyStats), later in this topic.</span></span>  
  
-   <span data-ttu-id="b4d2b-127">디스크 기반 테이블에 대한 읽기 전용 작업에서는 행 버전 관리를 사용하여 보조 데이터베이스에 대한 차단 경합을 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-127">Read-only workloads for disk-based tables use row versioning to remove blocking contention on the secondary databases.</span></span> <span data-ttu-id="b4d2b-128">보조 데이터베이스에 대해 실행되는 모든 쿼리는 스냅샷 격리 트랜잭션 수준에 자동으로 매핑되며, 이는 다른 트랜잭션 격리 수준이 명시적으로 설정되어 있는 경우에도 해당됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-128">All queries that run against the secondary databases are automatically mapped to snapshot isolation transaction level, even when other transaction isolation levels are explicitly set.</span></span> <span data-ttu-id="b4d2b-129">또한 모든 잠금 힌트가 무시됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-129">Also, all locking hints are ignored.</span></span> <span data-ttu-id="b4d2b-130">따라서 읽기/쓰기 경합이 없어집니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-130">This eliminates reader/writer contention.</span></span>  
  
-   <span data-ttu-id="b4d2b-131">메모리 최적화 지속성 테이블에 대한 읽기 전용 작업은 동일한 트랜잭션 격리 수준 제한과 함께 네이티브 저장 프로시저 또는 SQL 상호 운용성을 사용하여 주 데이터베이스에서 액세스하는 것과 정확히 동일한 방법으로 데이터에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-131">Read-only workloads for memory-optimized durable tables access the data in exactly the same way it is accessed on the primary database, using native stored procedures or SQL Interoperability with the same transaction isolation level limitations.</span></span> <span data-ttu-id="b4d2b-132">주 복제본에서 실행하는 보고 작업이나 읽기 전용 쿼리는 변경할 필요 없이 보조 복제본에서 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-132">Reporting workload or read-only queries running on the primary replica can be run on the secondary replica without requiring any changes.</span></span> <span data-ttu-id="b4d2b-133">마찬가지로, 보조 복제본에서 실행하는 보고 작업이나 읽기 전용 쿼리는 변경할 필요 없이 주 복제본에서 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-133">Similarly, a reporting workload or read-only queries running on a secondary replica can be run on the primary replica without requiring any changes.</span></span>  <span data-ttu-id="b4d2b-134">디스크 기반 테이블과 유사하게 보조 데이터베이스에 대해 실행되는 모든 쿼리는 스냅샷 격리 트랜잭션 수준에 자동으로 매핑되며, 이는 다른 트랜잭션 격리 수준이 명시적으로 설정되어 있는 경우에도 해당됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-134">Similar to disk-based tables, all queries that run against the secondary databases are automatically mapped to snapshot isolation transaction level, even when other transaction isolation levels are explicitly set.</span></span>  
  
-   <span data-ttu-id="b4d2b-135">보조 복제본에서는 디스크 기반 및 메모리 최적화 테이블 유형 모두에 대해 테이블 변수에서 DML 작업이 허용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-135">DML operations are allowed on table variables both for disk-based and memory-optimized table types on the secondary replica.</span></span>  
  
##  <a name="prerequisites-for-the-availability-group"></a><a name="bkmk_Prerequisites"></a> <span data-ttu-id="b4d2b-136">가용성 그룹에 대한 필수 구성 요소</span><span class="sxs-lookup"><span data-stu-id="b4d2b-136">Prerequisites for the Availability Group</span></span>  
  
-   <span data-ttu-id="b4d2b-137">**읽기 가능한 보조 복제본(필수)**</span><span class="sxs-lookup"><span data-stu-id="b4d2b-137">**Readable secondary replicas (required)**</span></span>  
  
     <span data-ttu-id="b4d2b-138">데이터베이스 관리자는 하나 이상의 복제본을 보조 역할로 실행할 때 모든 연결을 허용하거나(읽기 전용 액세스의 경우에만) 읽기 전용 연결만 허용하도록 구성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-138">The database administrator needs to configure one or more replicas so that, when running under the secondary role, they allow either all connections (just for read-only access) or only read-intent connections.</span></span>  
  
    > [!NOTE]  
    >  <span data-ttu-id="b4d2b-139">필요한 경우 데이터베이스 관리자는 임의의 가용성 복제본을 주 역할로 실행할 때 읽기 전용 연결을 제외하도록 구성할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-139">Optionally, the database administrator can configure any of the availability replicas to exclude read-only connections when running under the primary role.</span></span>  
  
     <span data-ttu-id="b4d2b-140">자세한 내용은 이 항목 뒷부분에 있는 [가용성 복제본에 대한 클라이언트 연결 액세스 정보&#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md)와 같은 시스템 데이터베이스, 사용자 데이터베이스를 비롯하여 보조 복제본을 호스트하는 서버 인스턴스의 읽기/쓰기 데이터베이스에는 데이터를 쓸 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-140">For more information, see [About Client Connection Access to Availability Replicas &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md).</span></span>  
  
-   <span data-ttu-id="b4d2b-141">**가용성 그룹 수신기**</span><span class="sxs-lookup"><span data-stu-id="b4d2b-141">**Availability group listener**</span></span>  
  
     <span data-ttu-id="b4d2b-142">읽기 전용 라우팅을 지원하려면 가용성 그룹에 [가용성 그룹 수신기](../../listeners-client-connectivity-application-failover.md)가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-142">To support read-only routing, an availability group must possess an [availability group listener](../../listeners-client-connectivity-application-failover.md).</span></span> <span data-ttu-id="b4d2b-143">읽기 전용 클라이언트는 해당 연결 요청을 이 수신기에 전달해야 하며, 클라이언트의 연결 문자열에서는 애플리케이션 의도를 "읽기 전용"으로 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-143">The read-only client must direct its connection requests to this listener, and the client's connection string must specify the application intent as "read-only."</span></span> <span data-ttu-id="b4d2b-144">즉, 해당 연결 요청은 *읽기 전용 연결 요청*이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-144">That is, they must be *read-intent connection requests*.</span></span>  
  
-   <span data-ttu-id="b4d2b-145">**읽기 전용 라우팅**</span><span class="sxs-lookup"><span data-stu-id="b4d2b-145">**Read only routing**</span></span>  
  
     <span data-ttu-id="b4d2b-146">*읽기 전용 라우팅* 이란 가용성 그룹 수신기에 전달된 들어오는 읽기 전용 연결 요청을 사용 가능하고 읽기 가능한 보조 복제본으로 라우팅하는 SQL Server 기능을 말합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-146">*Read-only routing* refers to the ability of SQL Server to route incoming read-intent connection requests, that are directed to an availability group listener, to an available readable secondary replica.</span></span> <span data-ttu-id="b4d2b-147">읽기 전용 라우팅을 위한 필수 구성 요소은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-147">The prerequisites for read-only routing are as follows:</span></span>  
  
    -   <span data-ttu-id="b4d2b-148">읽기 전용 라우팅을 지원하려면 읽기 가능한 보조 복제본에 읽기 전용 라우팅 URL이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-148">To support read-only routing, a readable secondary replica requires a read-only routing URL.</span></span> <span data-ttu-id="b4d2b-149">이 URL은 로컬 복제본이 보조 역할로 실행되는 경우에만 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-149">This URL takes effect only when the local replica is running under the secondary role.</span></span> <span data-ttu-id="b4d2b-150">필요에 따라 복제본별로 읽기 전용 라우팅 URL을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-150">The read-only routing URL must be specified on a replica-by-replica basis, as needed.</span></span> <span data-ttu-id="b4d2b-151">각 읽기 전용 라우팅 URL은 읽기 전용 연결 요청을 지정된 읽기 가능한 보조 복제본으로 라우팅하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-151">Each read-only routing URL is used for routing read-intent connection requests to a specific readable secondary replica.</span></span> <span data-ttu-id="b4d2b-152">일반적으로 모든 읽기 가능한 보조 복제본에는 읽기 전용 라우팅 URL이 할당됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-152">Typically, every readable secondary replica is assigned a read-only routing URL.</span></span>  
  
    -   <span data-ttu-id="b4d2b-153">주 복제본으로 사용될 때 읽기 전용 라우팅을 지원하도록 할 각 가용성 복제본에 읽기 전용 라우팅 목록이 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-153">Each availability replica that is to support read-only routing when it is the primary replica requires a read-only routing list.</span></span> <span data-ttu-id="b4d2b-154">지정된 읽기 전용 라우팅 목록은 로컬 복제본이 주 역할로 실행되는 경우에만 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-154">A given read-only routing list takes effect only when the local replica is running under the primary role.</span></span> <span data-ttu-id="b4d2b-155">필요에 따라 복제본별로 이 목록을 지정해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-155">This list must be specified on a replica-by-replica basis, as needed.</span></span> <span data-ttu-id="b4d2b-156">일반적으로 각 읽기 전용 라우팅 목록의 끝에는 로컬 복제본의 URL과 함께 모든 읽기 전용 라우팅 URL이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-156">Typically, each read-only routing list would contain every read-only routing URL, with the URL of the local replica at the end of the list.</span></span>  
  
        > [!NOTE]  
        >  <span data-ttu-id="b4d2b-157">읽기 전용 연결 요청은 현재 주 복제본의 읽기 전용 라우팅 목록에 있는 사용 가능하고 읽기 가능한 첫 번째 보조 복제본으로 라우팅됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-157">Read-intent connection requests are routed to the first available readable secondary on the read-only routing list of the current primary replica.</span></span> <span data-ttu-id="b4d2b-158">부하 분산은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-158">There is no load balancing.</span></span>  
  
     <span data-ttu-id="b4d2b-159">자세한 내용은 이 항목 뒷부분에 있는 [가용성 그룹에 대한 읽기 전용 라우팅 구성&#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md)와 같은 시스템 데이터베이스, 사용자 데이터베이스를 비롯하여 보조 복제본을 호스트하는 서버 인스턴스의 읽기/쓰기 데이터베이스에는 데이터를 쓸 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-159">For more information, see [Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;](configure-read-only-routing-for-an-availability-group-sql-server.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b4d2b-160">가용성 그룹 수신기 및 읽기 전용 라우팅에 대한 자세한 내용은 [가용성 그룹 수신기, 클라이언트 연결 및 애플리케이션 장애 조치(failover)&#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md)가 있어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-160">For information about availability group listeners and more information about read-only routing, see [Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md).</span></span>  
  
##  <a name="limitations-and-restrictions"></a><a name="bkmk_LimitationsRestrictions"></a> <span data-ttu-id="b4d2b-161">제한 사항</span><span class="sxs-lookup"><span data-stu-id="b4d2b-161">Limitations and Restrictions</span></span>  
 <span data-ttu-id="b4d2b-162">일부 작업은 다음과 같이 완전히 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-162">Some operations are not fully supported, as follows:</span></span>  
  
-   <span data-ttu-id="b4d2b-163">읽기 가능한 복제본이 읽기에 대해 활성화되는 즉시 보조 데이터베이스에 대한 연결 수락을 시작할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-163">As soon as a readable replica is enabled for read, it can start accepting connections to its secondary databases.</span></span> <span data-ttu-id="b4d2b-164">하지만 주 데이터베이스에 활성 트랜잭션이 있는 경우 해당 보조 데이터베이스에서 행 버전을 완전히 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-164">However, if any active transactions exist on a primary database, the row versions will not be fully available on the corresponding secondary database.</span></span> <span data-ttu-id="b4d2b-165">보조 복제본을 구성할 때 주 복제본에 있던 활성 트랜잭션은 커밋하거나 롤백해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-165">Any active transactions that existed on the primary replica when the secondary replica was configured must commit or roll back.</span></span> <span data-ttu-id="b4d2b-166">이 프로세스가 완료될 때까지 보조 데이터베이스의 트랜잭션 격리 수준 매핑은 완전하지 않으며 쿼리가 일시적으로 차단됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-166">Until this process completes, the transaction isolation level mapping on the secondary database is incomplete and queries are temporarily blocked.</span></span>  
  
    > [!WARNING]  
    >  <span data-ttu-id="b4d2b-167">디스크 기반 테이블과 메모리 최적화 테이블 모두, 경우 장기 트랜잭션을 실행하면 유지되는 버전 관리 행 수에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-167">Running long transactions impacts the number of versioned rows kept, both for disk-based and memory-optimized tables.</span></span>  
  
-   <span data-ttu-id="b4d2b-168">메모리 최적화 테이블이 있는 보조 데이터베이스에서는 메모리 최적화 테이블에 대해 행 버전이 항상 생성되더라도 보조 복제본이 활성화될 때 주 복제본에 있던 모든 활성 트랜잭션이 완료될 때까지 쿼리가 차단됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-168">On a secondary database with memory-optimized tables, even though row versions are always generated for memory-optimzied tables, queries are blocked until all active transactions that existed in the primary replica when the secondary replica was enabled for read complete.</span></span> <span data-ttu-id="b4d2b-169">그러면 디스크 기반 테이블과 메모리 최적화 테이블을 보고 작업과 읽기 전용 쿼리에 모두 동시에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-169">This ensures that both disk-based and memory-optimized tables are available to the reporting workload and read-only queries at the same time.</span></span>  
  
-   <span data-ttu-id="b4d2b-170">읽기 가능한 보조 복제본에 속하는 보조 데이터베이스에서는 변경 내용 추적 및 변경 데이터 캡처가 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-170">Change tracking and change data capture are not supported on secondary databases that belong to a readable secondary replica:</span></span>  
  
    -   <span data-ttu-id="b4d2b-171">변경 내용 추적은 보조 데이터베이스에서 명시적으로 해제되고</span><span class="sxs-lookup"><span data-stu-id="b4d2b-171">Change tracking is explicitly disabled on secondary databases.</span></span>  
  
    -   <span data-ttu-id="b4d2b-172">변경 데이터 캡처는 보조 데이터베이스에서 설정될 수 있지만 지원되지는 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-172">Change data capture can be enabled on a secondary database, but this is not supported.</span></span>  
  
-   <span data-ttu-id="b4d2b-173">읽기 작업은 스냅샷 격리 트랜잭션 수준으로 매핑되므로 주 복제본에서 삭제할 레코드의 삭제 작업이 하나 이상의 보조 복제본의 트랜잭션에 의해 차단될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-173">Because read operations are mapped to snapshot isolation transaction level, the cleanup of ghost records on the primary replica can be blocked by transactions on one or more secondary replicas.</span></span> <span data-ttu-id="b4d2b-174">삭제할 레코드 정리 태스크는 주 복제본에 있는 디스크 기반 테이블에 대한 삭제할 레코드가 보조 복제본에 더 이상 필요하지 않을 때 해당 레코드를 자동으로 정리합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-174">The ghost record cleanup task will automatically clean up the ghost records for disk-based tables on the primary replica when they are no longer needed by any secondary replica.</span></span>  <span data-ttu-id="b4d2b-175">이러한 동작은 주 복제본에서 트랜잭션을 실행할 때 수행되는 동작과 유사합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-175">This is similar to what is done when you run transaction(s) on the primary replica.</span></span> <span data-ttu-id="b4d2b-176">극단적인 경우에는 보조 데이터베이스에서 삭제할 레코드 정리를 차단하는 장기 실행 읽기 쿼리를 중지해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-176">In the extreme case on the secondary database, you will need to kill a long running read-query that is blocking the ghost cleanup.</span></span> <span data-ttu-id="b4d2b-177">삭제할 레코드 정리는 보조 복제본의 연결이 끊어지거나 보조 데이터베이스에서 데이터 이동이 일시 중지되는 경우 차단될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-177">Note, the ghost clean can be blocked if the secondary replica gets disconnected or when data movement is suspended on the secondary database.</span></span> <span data-ttu-id="b4d2b-178">이 상태에서는 로그 잘림이 방지되므로 이 상태가 지속될 경우 가용성 그룹에서 이 보조 데이터베이스를 제거하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-178">This state also prevents log truncation, so if this state persists, we recommend that you remove this secondary database from the availability group.</span></span> <span data-ttu-id="b4d2b-179">행 버전이 메모리 내에 유지되고 주 복제본의 행 버전과 독립적이기 때문에 메모리 액세스에 최적화된 테이블에는 삭제할 레코드 정리 문제가 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-179">There is no ghost record cleanup issue with memory-optimized tables because the row versions are kept in memory and are independent of the row versions on the primary replica.</span></span>  
  
-   <span data-ttu-id="b4d2b-180">주 복제본에서 디스크 기반 테이블이 포함된 파일에 대해 DBCC SHRINKFILE 작업을 수행할 경우 해당 파일에 삭제할 레코드가 포함되어 있고 이 레코드가 보조 복제본에서 여전히 필요하면 작업이 실패할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-180">The DBCC SHRINKFILE operation on files containing disk-based tables might fail on the primary replica if the file contains ghost records that are still needed on a secondary replica.</span></span>  
  
-   <span data-ttu-id="b4d2b-181">[!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)]부터 사용자 동작 또는 실패로 인해 주 복제본이 오프라인인 경우에도 읽기 가능한 보조 복제본은 온라인 상태를 유지할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-181">Beginning in [!INCLUDE[ssSQL14](../../../includes/sssql14-md.md)], readable secondary replicas can remain online even when the primary replica is offline due to user action or a failure.</span></span> <span data-ttu-id="b4d2b-182">하지만 이 상황에서는 가용성 그룹 수신기도 오프라인 상태가 되므로 읽기 전용 라우팅이 작동하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-182">However, read-only routing does not work in this situation because the availability group listener is offline as well.</span></span> <span data-ttu-id="b4d2b-183">클라이언트는 읽기 전용 작업을 위해 읽기 전용 보조 복제본에 직접 연결해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-183">Clients must connect directly to the read-only secondary replicas for read-only workloads.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b4d2b-184">읽기 가능한 보조 복제본을 호스트하는 서버 인스턴스에서 [sys.dm_db_index_physical_stats](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql) 동적 관리 뷰를 쿼리할 경우 REDO 차단 문제가 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-184">If you query the [sys.dm_db_index_physical_stats](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-physical-stats-transact-sql) dynamic management view on a server instance that is hosting a readable secondary replica, you might encounter a REDO blocking issue.</span></span> <span data-ttu-id="b4d2b-185">이는 이 동적 관리 뷰가 지정된 사용자 테이블 또는 뷰에 대한 IS 잠금을 획득하여 REDO 스레드에서의 해당 사용자 테이블 또는 뷰에 대한 X 잠금 요청이 차단되기 때문입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-185">This is because this dynamic management view acquires an IS lock on the specified user table or view that can block requests by a REDO thread for an X lock on that user table or view.</span></span>  
  
##  <a name="performance-considerations"></a><a name="bkmk_Performance"></a> <span data-ttu-id="b4d2b-186">성능 고려 사항</span><span class="sxs-lookup"><span data-stu-id="b4d2b-186">Performance Considerations</span></span>  
 <span data-ttu-id="b4d2b-187">이 섹션에서는 읽기 가능한 보조 데이터베이스에 대한 몇 가지 성능 고려 사항에 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-187">This section discusses several performance considerations for readable secondary databases</span></span>  
  
 
  
###  <a name="data-latency"></a><a name="DataLatency"></a> <span data-ttu-id="b4d2b-188">데이터 대기 시간</span><span class="sxs-lookup"><span data-stu-id="b4d2b-188">Data Latency</span></span>  
 <span data-ttu-id="b4d2b-189">읽기 전용 작업에 약간의 데이터 대기 시간을 허용할 수 있는 경우 보조 복제본에 대한 읽기 전용 액세스를 구현하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-189">Implementing read-only access to secondary replicas is useful if your read-only workloads can tolerate some data latency.</span></span> <span data-ttu-id="b4d2b-190">데이터 대기 시간이 허용 가능하지 않은 경우에는 주 복제본에 대해 읽기 전용 작업을 실행하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-190">In situations where data latency is unacceptable, consider running read-only workloads against the primary replica.</span></span>  
  
 <span data-ttu-id="b4d2b-191">주 복제본은 주 데이터베이스의 변경 내용에 대한 로그 레코드를 보조 복제본으로 보냅니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-191">The primary replica sends log records of changes on primary database to the secondary replicas.</span></span> <span data-ttu-id="b4d2b-192">각 보조 데이터베이스에서 전용 다시 실행 스레드가 이 로그 레코드를 적용합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-192">On each secondary database, a dedicated redo thread applies the log records.</span></span> <span data-ttu-id="b4d2b-193">읽기 액세스 보조 데이터베이스에서는 변경 내용이 포함된 로그 레코드가 보조 데이터베이스에 적용되고 트랜잭션이 주 데이터베이스에서 커밋될 때까지는 쿼리 결과에 지정된 데이터 변경 내용이 나타나지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-193">On a read-access secondary database, a given data change does not appear in query results until the log record that contains the change has been applied to the secondary database and the transaction has been committed on primary database.</span></span>  
  
 <span data-ttu-id="b4d2b-194">이로 인해 주 복제본과 보조 복제본 사이에는 대개 몇 초 내외의 대기 시간이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-194">This means that there is some latency, usually only a matter of seconds, between the primary and secondary replicas.</span></span> <span data-ttu-id="b4d2b-195">하지만 네트워크 문제로 인해 처리량이 줄어드는 경우와 같은 특수한 경우에는 대기 시간이 중요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-195">In unusual cases, however, for example if network issues reduce throughput, latency can become significant.</span></span> <span data-ttu-id="b4d2b-196">I/O 병목이 발생하고 데이터 이동이 일시 중지되면 대기 시간이 증가합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-196">Latency increases when I/O bottlenecks occur and when data movement is suspended.</span></span> <span data-ttu-id="b4d2b-197">일시 중지된 데이터 이동을 모니터링하려면 [AlwaysOn 대시보드](use-the-always-on-dashboard-sql-server-management-studio.md) 또는 [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) 동적 관리 뷰를 사용하면 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-197">To monitor suspended data movement, you can use the [AlwaysOn Dashboard](use-the-always-on-dashboard-sql-server-management-studio.md) or the [sys.dm_hadr_database_replica_states](/sql/relational-databases/system-dynamic-management-views/sys-dm-hadr-database-replica-states-transact-sql) dynamic management view.</span></span>  
  
####  <a name="data-latency-on-databases-with-memory-optimized-tables"></a><a name="bkmk_LatencyWithInMemOLTP"></a> <span data-ttu-id="b4d2b-198">메모리 최적화 테이블이 포함된 데이터베이스의 데이터 대기 시간</span><span class="sxs-lookup"><span data-stu-id="b4d2b-198">Data Latency on databases with memory-optimized tables</span></span>  
 <span data-ttu-id="b4d2b-199">읽기 작업에 보조 복제본의 메모리 최적화 테이블을 액세스하는 경우 *safe-timestamp* 는 *safe-timestamp*이전에 커밋된 트랜잭션에서 행을 반환하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-199">When accessing memory-optimized tables on secondary replica for read workload, a *safe-timestamp* is used to return rows from transactions that have committed earlier than *safe-timestamp*.</span></span> <span data-ttu-id="b4d2b-200">safe-timestamp는 주 복제본에서 행의 가비지 수집을 수행하기 위해 가비지 수집 스레드에서 사용하는 가장 오래된 타임스탬프 힌트입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-200">The safe-timestamp is the oldest timestamp hint used by the garbage collection thread to garbage collect the rows on the primary replica.</span></span> <span data-ttu-id="b4d2b-201">이 타임스탬프는 마지막 업데이트 이후 메모리 최적화 테이블의 DML 트랜잭션 수가 내부 임계값을 초과할 때 업데이트됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-201">This timestamp is updated when the number of DML transactions on memory-optimized tables exceed an internal threshold since the last update.</span></span> <span data-ttu-id="b4d2b-202">주 복제본에서 가장 오래된 트랜잭션 타임스탬프가 업데이트될 때마다 내구성 있는 메모리 최적화 테이블의 다음 DML 트랜잭션은 특별한 로그 기록의 일부로 보조 복제본에 전송되도록 이 타임스탬프를 전송합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-202">Whenever the oldest transaction timestamp is updated on the primary replica, the next DML transaction on a durable memory-optimized table will send this timestamp to be sent to secondary replica as part of a special log record.</span></span> <span data-ttu-id="b4d2b-203">보조 복제본의 REDO 스레드는 이 로그 기록 처리의 일부로 safe-timestamp를 업데이트합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-203">REDO thread on the secondary replica, updates the safe-timestamp as part of processing this log record.</span></span>  
  
#### <a name="the-impact-of-safe-timestamp-on-latency"></a><span data-ttu-id="b4d2b-204">safe-timestamp가 대기 시간에 미치는 영향</span><span class="sxs-lookup"><span data-stu-id="b4d2b-204">The impact of safe-timestamp on Latency</span></span>  
  
-   <span data-ttu-id="b4d2b-205">트랜잭션 처리량이 높은 OLTP 작업의 경우 대기 시간이 디스크 기반 테이블과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-205">For OLTP workloads with high transaction throughput, the latency should be comparable to disk-based tables.</span></span> <span data-ttu-id="b4d2b-206">이것이 일반적인 경우라고 생각됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-206">We expect this to be the common case.</span></span>  
  
-   <span data-ttu-id="b4d2b-207">장기 실행 트랜잭션으로 인해 safe-timestamp가 임의로 지연될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-207">A long running transaction can cause the safe-timestamp to be delayed arbitrarily.</span></span>  <span data-ttu-id="b4d2b-208">스냅샷 격리의 타임스탬프로 디스크 기반 테이블 액세스가 가장 오래된 트랜잭션 커밋에 의해 결정되는 경우에도 마찬가지입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-208">This is no different when accessing disk-based tables as the timestamp of snapshot isolation is determined by the commit of oldest transaction.</span></span>  
  
-   <span data-ttu-id="b4d2b-209">마지막 safe-timestamp 업데이트 이후 주 복제본에서 트랜잭션에 변경한 내용은 다음 전송 및 safe-timestamp 업데이트까지 보조 복제본에 표시되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-209">Changes made by transactions on the primary replica since the last safe-timestamp update are not visible on the secondary replica till the next transmission and update of the safe-timestamp.</span></span> <span data-ttu-id="b4d2b-210">safe-timestamp 업데이트의 내부 임계값이 교차하기 전에 주 복제본의 트랜잭션 활동이 중단되는 경우 safe-timestamp에 대한 마지막 업데이트 이후 변경된 내용이 보조 복제본에 표시되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-210">If transactional activity on the primary replica stops before the internal threshold for safe-timestamp update is crossed, the changes made since the last update to safe-timestamp will not be visible on the secondary replica.</span></span> <span data-ttu-id="b4d2b-211">이 문제를 완화하려면 주 복제본에서 내구성 있는 메모리 최적화 더미 테이블에 몇몇 DML 트랜잭션을 실행해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-211">To alleviate this issue, you may need to run a few DML transactions on a dummy durable memory-optimized table on the primary replica.</span></span> <span data-ttu-id="b4d2b-212">또는 권장 사항은 아니지만 수동 검사점을 실행하여 safe-timestamp 전달을 강제로 수행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-212">Alternatively, though not recommended, you can force shipping of safe-timestamp by running a manual checkpoint.</span></span>  
  
#### <a name="monitoring-and-troubleshooting-data-latency-in-memory-optimized-tables"></a><span data-ttu-id="b4d2b-213">메모리 최적화 테이블에서 데이터 지연 모니터링 및 문제 해결</span><span class="sxs-lookup"><span data-stu-id="b4d2b-213">Monitoring and Troubleshooting data latency in memory-optimized tables</span></span>  
 <span data-ttu-id="b4d2b-214">주 복제본에서 다음 쿼리를 실행하여 safe-timestamp를 찾을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-214">You can find out the safe-timestamp by running the following query on the primary replica</span></span>  
  
```  
  
SELECT MAX(base_generation)   
   AS max_base_generation  
   FROM sys.dm_db_xtp_gc_cycle_stats  
GO  
  
```  
  
 <span data-ttu-id="b4d2b-215">활성 읽기 작업과 동시에 다음 쿼리를 실행하여 보조 복제본에서 사용되는 safe-timestamp를 확인할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-215">You can also identify the safe-timestamp used on the secondary replica by running the following query concurrently with the active read-workload.</span></span>  
  
```  
  
SELECT begin_tsn   
   FROM sys.dm_db_xtp_transactions  
GO  
  
```  
  
###  <a name="read-only-workload-impact"></a><a name="ReadOnlyWorkloadImpact"></a> <span data-ttu-id="b4d2b-216">읽기 전용 작업의 영향</span><span class="sxs-lookup"><span data-stu-id="b4d2b-216">Read-Only Workload Impact</span></span>  
 <span data-ttu-id="b4d2b-217">읽기 전용 액세스를 사용하도록 보조 복제본을 구성하면 특히 디스크 기반 테이블의 읽기 전용 작업이 I/O를 매우 많이 사용하는 경우 보조 데이터베이스의 읽기 전용 작업은 다시 실행 스레드의 CPU 및 I/O(디스크 기반 테이블의 경우)와 같은 시스템 리소스를 소비합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-217">When you configure a secondary replica for read-only access, your read-only workloads on the secondary databases consume system resources, such as CPU and I/O (for disk-based tables) from redo threads, especially if the read-only workloads on disk-based tables are highly I/O-intensive.</span></span> <span data-ttu-id="b4d2b-218">모든 행이 메모리 내에 상주하기 때문에 메모리 액세스에 최적화된 테이블에 액세스할 때 IO의 영향이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-218">There is no IO impact when accessing memory-optimized tables because all the rows reside in memory.</span></span>  
  
 <span data-ttu-id="b4d2b-219">또한 보조 복제본에 대한 읽기 전용 작업은 로그 레코드를 통해 적용되는 DDL(데이터 정의 언어) 변경을 차단할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-219">Also, read-only workloads on the secondary replicas can block data definition language (DDL) changes that are applied through log records.</span></span>  
  
-   <span data-ttu-id="b4d2b-220">행 버전 관리로 인해 읽기 작업에서는 공유 잠금을 사용하지는 않지만, DDL 변경을 적용하는 다시 실행 작업을 차단할 수 있는 스키마 안정성(Sch-S) 잠금을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-220">Even though the read operations do not take shared locks because of row versioning, these operations take schema stability (Sch-S) locks, which can block redo operations that are applying DDL changes.</span></span> <span data-ttu-id="b4d2b-221">DDL 작업에는 ALTER/DROP 테이블과 뷰가 포함되지만 저장 프로시저의 DROP 또는 ALTER는 포함되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-221">DDL operations include ALTER/DROP tables and Views but not DROP or ALTER of stored procedures.</span></span> <span data-ttu-id="b4d2b-222">따라서 예를 들어 주 에서 디스크 기반 또는 메모리 액세스에 최적화된 테이블을 삭제할 경우,</span><span class="sxs-lookup"><span data-stu-id="b4d2b-222">So for example, if you drop a table disk-based or memory-optimized, on primary.</span></span> <span data-ttu-id="b4d2b-223">REDO 스레드가 테이블을 삭제하기 위한 로그 레코드를 처리할 때는 테이블에서 SCH_M 잠금을 획득해야 하며 테이블에 액세스하는 실행 중인 쿼리를 통해 차단될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-223">When REDO thread processes the log record to drop the table, it must acquire a SCH_M lock on the table and can get blocked by a running query accessing table.</span></span>  <span data-ttu-id="b4d2b-224">테이블의 삭제가 사용자 세션의 일부로 수행되고 RODO 스레드가 아닌 경우를 제외하고 이 동작은 주 복제본에서도 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-224">This is the same behavior on primary replica except that the drop of the table is done as part of a user session and not REDO thread.</span></span>  
  
-   <span data-ttu-id="b4d2b-225">추가로 차단하는 메모리 액세스에 최적화된 테이블이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-225">There is additional blocking Memory-Optimized Tables.</span></span> <span data-ttu-id="b4d2b-226">보조 복제본에 네이티브 저장 프로시저의 동시 실행이 있는 경우 네이티브 저장 프로시저를 삭제하면 REDO 스레드가 차단될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-226">A drop of native stored procedure can cause REDO thread to block if there is a concurrent execution of the native stored procedure on the secondary replica.</span></span> <span data-ttu-id="b4d2b-227">저장 프로시저의 삭제가 사용자 세션의 일부로 수행되고 RODO 스레드가 아닌 경우를 제외하고 이 동작은 주 복제본에서도 동일합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-227">This is the same behavior on the primary replica except that the drop of the stored procedure is done as part of a user session and not REDO thread.</span></span>  
  
 <span data-ttu-id="b4d2b-228">쿼리 작성에 대한 최선의 방법을 알고 보조 데이터베이스에서 이러한 최선의 방법을 따라야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-228">Be aware of best practices around building queries, and exercise those best practices in the secondary databases.</span></span> <span data-ttu-id="b4d2b-229">예를 들어 데이터 집계와 같은 장기 실행 쿼리는 작업량이 적은 시간에 예약합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-229">For example, schedule long-running queries such as aggregations of data during times of low activity.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="b4d2b-230">다시 실행 스레드가 보조 복제본에 대한 쿼리에 의해 차단되면 **sqlserver.lock_redo_blocked** XEvent가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-230">If a redo thread is blocked by queries on a secondary replica, the **sqlserver.lock_redo_blocked** XEvent is raised.</span></span>  
  
###  <a name="indexing"></a><a name="bkmk_Indexing"></a> <span data-ttu-id="b4d2b-231">인덱싱</span><span class="sxs-lookup"><span data-stu-id="b4d2b-231">Indexing</span></span>  
 <span data-ttu-id="b4d2b-232">읽기 가능한 보조 복제본에서 읽기 전용 작업을 최적화하기 위해 보조 데이터베이스의 테이블에 인덱스를 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-232">To optimize read-only workloads on the readable secondary replicas, you may want to create indexes on the tables in the secondary databases.</span></span> <span data-ttu-id="b4d2b-233">보조 데이터베이스의 스키마나 데이터는 변경할 수 없으므로 주 데이터베이스에 인덱스를 만들고 다시 실행 프로세스를 통해 변경 내용이 보조 데이터베이스에 전송될 수 있도록 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-233">Because you cannot make schema or data changes on the secondary databases, create indexes in the primary databases and allow the changes to transfer to the secondary database through the redo process.</span></span>  
  
 <span data-ttu-id="b4d2b-234">보조 복제본의 인덱스 사용 동작을 모니터링하려면 **sys.dm_db_index_usage_stats**동적 관리 뷰의 **user_seeks**, **user_scans** 및 [user_lookups](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-usage-stats-transact-sql) 열을 쿼리합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-234">To monitor index usage activity on a secondary replica, query the **user_seeks**, **user_scans**, and **user_lookups** columns of the [sys.dm_db_index_usage_stats](/sql/relational-databases/system-dynamic-management-views/sys-dm-db-index-usage-stats-transact-sql) dynamic management view.</span></span>  
  
###  <a name="statistics-for-read-only-access-databases"></a><a name="Read-OnlyStats"></a> <span data-ttu-id="b4d2b-235">읽기 전용 액세스 데이터베이스에 대한 통계</span><span class="sxs-lookup"><span data-stu-id="b4d2b-235">Statistics for Read-Only Access Databases</span></span>  
 <span data-ttu-id="b4d2b-236">테이블 및 인덱싱된 뷰의 열에 대한 통계는 쿼리 계획을 최적화하는 데 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-236">Statistics on columns of tables and indexed views are used to optimize query plans.</span></span> <span data-ttu-id="b4d2b-237">가용성 그룹의 경우 주 데이터베이스에 만들어져 유지 관리되는 통계는 트랜잭션 로그 레코드가 적용되는 도중 보조 데이터베이스에 자동 보존됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-237">For availability groups, statistics that are created and maintained on the primary databases are automatically persisted on the secondary databases as part of applying the transaction log records.</span></span> <span data-ttu-id="b4d2b-238">그러나 보조 데이터베이스에 대한 읽기 전용 작업에는 주 데이터베이스에 만들어지는 통계와 다른 통계가 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-238">However, the read-only workload on the secondary databases may need different statistics than those that are created on the primary databases.</span></span> <span data-ttu-id="b4d2b-239">하지만 보조 데이터베이스는 읽기 전용 액세스로 제한되므로 보조 데이터베이스에는 통계를 만들 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-239">However, because secondary databases are restricted to read-only access, statistics cannot be created on the secondary databases.</span></span>  
  
 <span data-ttu-id="b4d2b-240">이 문제를 해결하기 위해 보조 복제본은 **tempdb**에 보조 데이터베이스에 대한 임시 통계를 만들어 유지 관리합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-240">To address this problem, the secondary replica creates and maintains temporary statistics for secondary databases in **tempdb**.</span></span> <span data-ttu-id="b4d2b-241">주 데이터베이스에 보존되는 영구적 통계와 구별하기 위해 임시 통계의 이름에는 _readonly_database_statistic라는 접미사가 추가됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-241">The suffix _readonly_database_statistic is appended to the name of temporary statistics to differentiate them from the permanent statistics that are persisted from the primary database.</span></span>  
  
 <span data-ttu-id="b4d2b-242">[!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 에서만 임시 통계를 만들고 업데이트할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-242">Only [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] can create and update temporary statistics.</span></span> <span data-ttu-id="b4d2b-243">하지만 영구적 통계에 사용하는 것과 동일한 도구를 사용하여 임시 통계를 삭제하고 해당 속성을 모니터링할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-243">However, you can delete temporary statistics and monitor their properties using the same tools that you use for permanent statistics:</span></span>  
  
-   <span data-ttu-id="b4d2b-244">[DROP STATISTICS](/sql/t-sql/statements/drop-statistics-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] 문을 사용하여 임시 통계를 삭제합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-244">Delete temporary statistics using the [DROP STATISTICS](/sql/t-sql/statements/drop-statistics-transact-sql)[!INCLUDE[tsql](../../../includes/tsql-md.md)] statement.</span></span>  
  
-   <span data-ttu-id="b4d2b-245">**sys.stats** 및 **sys.stats_columns** 카탈로그 뷰를 사용하여 통계를 모니터링합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-245">Monitor statistics using the **sys.stats** and **sys.stats_columns** catalog views.</span></span> <span data-ttu-id="b4d2b-246">**sys_stats** 에는 영구적 통계와 임시 통계를 나타내는 **is_temporary**열이 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-246">**sys_stats** includes a column, **is_temporary**, to indicate which statistics are permanent and which are temporary.</span></span>  
  
 <span data-ttu-id="b4d2b-247">주 복제본이나 보조 복제본에는 메모리 액세스에 최적화된 테이블의 자동 통계 업데이트에 대한 지원이 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-247">There is no support for auto-statistics update for memory-optimized tables on the primary or secondary replica.</span></span> <span data-ttu-id="b4d2b-248">보조 복제본에서 쿼리 성능과 계획을 모니터링하고 필요한 경우 주 복제본에서 통계를 수동으로 업데이트해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-248">You must monitor query performance and plans on the secondary replica and manually update the statistics on the primary replica when needed.</span></span> <span data-ttu-id="b4d2b-249">하지만 주 복제본 및 보조 복제본 모두에서 누락 통계는 자동으로 생성됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-249">However, the missing statistics are automatically created both on primary and secondary replica.</span></span>  
  
 <span data-ttu-id="b4d2b-250">SQL Server 통계에 대한 자세한 내용은 [통계](../../../relational-databases/statistics/statistics.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-250">For more information about SQL Server statistics, see [Statistics](../../../relational-databases/statistics/statistics.md).</span></span>  
  

  
####  <a name="stale-permanent-statistics-on-secondary-databases"></a><a name="StalePermStats"></a> <span data-ttu-id="b4d2b-251">보조 데이터베이스의 유효하지 않은 영구적 통계</span><span class="sxs-lookup"><span data-stu-id="b4d2b-251">Stale Permanent Statistics on Secondary Databases</span></span>  
 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] <span data-ttu-id="b4d2b-252">에서는 보조 데이터베이스에 대한 영구적 통계가 유효하지 않은 경우 이를 감지합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-252">detects when permanent statistics on a secondary database are stale.</span></span> <span data-ttu-id="b4d2b-253">그러나 주 데이터베이스의 변경을 통하지 않고는 영구적 통계를 변경할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-253">But changes cannot be made to the permanent statistics except through changes on the primary database.</span></span> <span data-ttu-id="b4d2b-254">쿼리 최적화를 위해 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 에서는 보조 데이터베이스에 디스크 기반 테이블에 대한 임시 통계를 만들고 이 통계를 유효하지 않은 영구적 통계 대신 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-254">For query optimization, [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] creates temporary statistics for disk-based tables on the secondary database and uses these statistics instead of the stale permanent statistics.</span></span>  
  
 <span data-ttu-id="b4d2b-255">주 데이터베이스에서 영구적 통계가 업데이트되면 이 통계는 자동으로 보조 데이터베이스에 저장됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-255">When the permanent statistics are updated on the primary database, they are automatically persisted to the secondary database.</span></span> <span data-ttu-id="b4d2b-256">그런 다음 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 는 임시 통계보다 최신 상태인 업데이트된 영구적 통계를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-256">Then [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] uses the updated permanent statistics, which are more current than the temporary statistics.</span></span>  
  
 <span data-ttu-id="b4d2b-257">가용성 그룹에서 장애 조치(failover)가 수행되면 모든 보조 복제본에서 임시 통계가 삭제 됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-257">If the availability group fails over, temporary statistics are deleted on all of the secondary replicas.</span></span>  
  
####  <a name="limitations-and-restrictions"></a><a name="StatsLimitationsRestrictions"></a> <span data-ttu-id="b4d2b-258">제한 사항</span><span class="sxs-lookup"><span data-stu-id="b4d2b-258">Limitations and Restrictions</span></span>  
  
-   <span data-ttu-id="b4d2b-259">임시 통계는 **tempdb**에 저장되므로 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] 서비스를 다시 시작하면 모든 임시 통계가 사라집니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-259">Because temporary statistics are stored in **tempdb**, a restart of the [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)] service causes all temporary statistics to disappear.</span></span>  
  
-   <span data-ttu-id="b4d2b-260">접미사 _readonly_database_statistic은 [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)]에서 생성하는 통계용으로 예약되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-260">The suffix _readonly_database_statistic is reserved for statistics generated by [!INCLUDE[ssNoVersion](../../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="b4d2b-261">따라서 주 데이터베이스에서 통계를 만들 때 이 접미사를 사용할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-261">You cannot use this suffix when creating statistics on a primary database.</span></span> <span data-ttu-id="b4d2b-262">자세한 내용은 [통계](../../../relational-databases/statistics/statistics.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-262">For more information, see [Statistics](../../../relational-databases/statistics/statistics.md).</span></span>  
  
##  <a name="accessing-memory-optimized-tables-on-a-secondary-replica"></a><a name="bkmk_AccessInMemTables"></a> <span data-ttu-id="b4d2b-263">보조 복제본에서 메모리 최적화 테이블 액세스</span><span class="sxs-lookup"><span data-stu-id="b4d2b-263">Accessing memory-optimized tables on a Secondary Replica</span></span>  
 <span data-ttu-id="b4d2b-264">보조 복제본의 읽기 작업 격리 수준은 주 복제본에서 허용되는 유일한 수준입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-264">The read workload isolation levels on secondary replica are only those allowed on the primary replica.</span></span> <span data-ttu-id="b4d2b-265">보조 복제본에서 수행되는 격리 수준의 매핑은 없습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-265">There is no mapping of isolations levels done on the secondary replica.</span></span> <span data-ttu-id="b4d2b-266">따라서 주 복제본에서 실행할 수 있는 모든 보고 작업은 변경하지 않고도 보조 복제본에서 실행할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-266">This ensure that any reporting workload that can be run on primary replica is able to run on the secondary replica without requiring any changes.</span></span> <span data-ttu-id="b4d2b-267">따라서 보조 복제본을 사용할 수 없는 경우 주 복제본에서 보조 복제본으로 또는 반대로 보고 작업을 쉽게 마이그레이션할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-267">This makes it easy for you to migrate a reporting workload from the primary replica to a secondary or vice versa when the secondary replica is not available.</span></span>  
  
 <span data-ttu-id="b4d2b-268">다음 쿼리는 주 복제본에서 실패하는 것과 비슷한 방식으로 보조 복제본에서 실행에 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-268">The following queries fail to run on the secondary replica similarly to the way they fail on the primary replica.</span></span>  
  
-   <span data-ttu-id="b4d2b-269">메모리 최적화 테이블에서만 실행하는 쿼리의 경우 유일하게 지원되는 격리 수준은 스냅샷, 반복 읽기 및 직렬화 가능입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-269">For queries running only on memory-optimized tables, the only supported isolation levels are snapshot, repeatable read, and serializable.</span></span> <span data-ttu-id="b4d2b-270">데이터베이스 수준에서 MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT 옵션을 활성화하지 않은 경우 커밋되지 않은 읽기 또는 커밋된 읽기 격리 수준의 쿼리는 오류를 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-270">Any queries with read-uncommitted or read committed isolation level returns an error unless you have enabled the option MEMORY_OPTIMIZED_ELEVATE_TO_SNAPSHOT at the database level.</span></span>  
  
    ```sql  
    SET TRANSACTION ISOLATION LEVEL READ_COMMITTED  
    -- This is not allowed  
    BEGIN TRAN  
    SELECT * FROM t_hk  
    COMMIT  
  
    ```  
  
     <span data-ttu-id="b4d2b-271">오류 메시지:</span><span class="sxs-lookup"><span data-stu-id="b4d2b-271">Error message:</span></span>  
  
    ```  
    Msg 41368, Level 16, State 0, Line 2  
    Accessing memory optimized tables using the CREAD_COMMITTED isolation level is supported only for autocommit transactions. It is not supported for explicit or implicit transactions. Provide a supported isolation level for the memory optimized table using a table hing, such as WITH (SNAPSHOT).  
    ```  
  
-   <span data-ttu-id="b4d2b-272">잠금 힌트는 메모리 최적화 테이블에서 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-272">No locking hints are supported on memory-optimized tables.</span></span> <span data-ttu-id="b4d2b-273">예를 들어, 다음 쿼리는 모두 오류가 발생하면서 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-273">For example, all of the following queries fail with an error.</span></span> <span data-ttu-id="b4d2b-274">NOLOCK 힌트만 허용되며 메모리 최적화 테이블과 함께 사용할 때 이 힌트는 NOOP입니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-274">Only NOLOCK hint is allowed and it is NOOP when used with memory-optimized tables.</span></span>  
  
    ```sql  
    SELECT * FROM t_hk WITH (PAGLOCK)  
    SELECT * FROM t_hk WITH (READPAST)  
    SELECT * FROM t_hk WITH (ROWLOCK)  
    SELECT * FROM t_hk WITH (READPAST)  
    SELECT * FROM t_hk WITH (TABLOCK)  
    SELECT * FROM t_hk WITH (XLOCK)  
    SELECT * FROM t_hk WITH (UPDLOCK)  
    ```  
  
-   <span data-ttu-id="b4d2b-275">크로스 컨테이너 트랜잭션의 경우 메모리 최적화 테이블에 액세스 하는 세션 격리 수준 "스냅숏"의 트랜잭션은 지원 되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-275">For cross-container transactions, transactions with session isolation level "snapshot" that access memory-optimized tables is not supported.</span></span> <span data-ttu-id="b4d2b-276">예를 들면 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-276">For example,</span></span>  
  
    ```sql  
    SET TRANSACTION ISOLATION LEVEL SNAPSHOT  
    -- This is not allowed  
    BEGIN TRAN  
       SELECT * FROM t_hk  
    COMMIT  
    ```  
  
     <span data-ttu-id="b4d2b-277">오류 메시지:</span><span class="sxs-lookup"><span data-stu-id="b4d2b-277">Error message:</span></span>  
  
    ```  
    Msg 41332, Level 16, State 0, Line 5  
    Memory optimized tables and natively compiled stored procedures cannot be accessed or created when the session TRANSACTION ISOLATION LEVEL is set to SNAPSHOT.  
    ```  
  
##  <a name="capacity-planning-considerations"></a><a name="bkmk_CapacityPlanning"></a> <span data-ttu-id="b4d2b-278">용량 계획 고려 사항</span><span class="sxs-lookup"><span data-stu-id="b4d2b-278">Capacity Planning Considerations</span></span>  
  
-   <span data-ttu-id="b4d2b-279">디스크 기반 테이블의 경우 다음 두 가지 이유로 읽기 가능한 보조 복제본에는 **tempdb** 에 공간이 필요할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-279">In the case of disk-based tables, readable secondary replicas can require space in **tempdb** for two reasons:</span></span>  
  
    -   <span data-ttu-id="b4d2b-280">스냅샷 격리 수준은 행 버전을 **tempdb**로 복사합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-280">Snapshot isolation level copies row versions into **tempdb**.</span></span>  
  
    -   <span data-ttu-id="b4d2b-281">보조 데이터베이스의 임시 통계는 **tempdb**에 생성되고 유지 관리됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-281">Temporary statistics for secondary databases are created and maintained in **tempdb**.</span></span> <span data-ttu-id="b4d2b-282">임시 통계로 인해 **tempdb**의 크기가 약간 증가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-282">The temporary statistics can cause a slight increase in the size of **tempdb**.</span></span> <span data-ttu-id="b4d2b-283">자세한 내용은 이 섹션 뒷부분에 있는 [읽기 전용 액세스 데이터베이스에 대한 통계](#Read-OnlyStats)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-283">For more information, see [Statistics for Read-Only Access Databases](#Read-OnlyStats), later in this section.</span></span>  
  
-   <span data-ttu-id="b4d2b-284">디스크 기반 테이블의 경우 하나 이상의 보조 복제본에 대해 읽기 액세스를 구성하면 주 데이터베이스에서는 삭제, 수정 또는 삽입된 데이터 행에 14바이트의 오버헤드를 추가하여 보조 데이터베이스의 행 버전에 대한 포인터를 저장합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-284">When you configure read-access for one or more secondary replicas, the primary databases add 14 bytes of overhead on deleted, modified, or inserted data rows to store pointers to row versions on the secondary databases for disk-based tables.</span></span> <span data-ttu-id="b4d2b-285">이 14바이트 오버헤드는 보조 데이터베이스에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-285">This 14-byte overhead is carried over to the secondary databases.</span></span> <span data-ttu-id="b4d2b-286">14바이트의 오버헤드가 데이터 행에 추가되므로 페이지 분할이 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-286">As the 14-byte overhead is added to data rows, page splits might occur.</span></span>  
  
     <span data-ttu-id="b4d2b-287">행 버전 데이터는 주 데이터베이스에 의해 생성되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-287">The row version data is not generated by the primary databases.</span></span> <span data-ttu-id="b4d2b-288">대신 보조 데이터베이스는 행 버전을 생성합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-288">Instead, the secondary databases generate the row versions.</span></span> <span data-ttu-id="b4d2b-289">하지만 행 버전 관리는 주 데이터베이스와 보조 데이터베이스 모두의 데이터 스토리지를 늘립니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-289">However, row versioning increases data storage in both the primary and secondary databases.</span></span>  
  
     <span data-ttu-id="b4d2b-290">행 버전 데이터 추가는 주 데이터베이스의 스냅샷 격리 또는 RCSI(읽기 커밋된 스냅샷 격리) 수준에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-290">The addition of the row version data depends on the snapshot isolation or read-committed snapshot isolation (RCSI) level setting on the primary database.</span></span> <span data-ttu-id="b4d2b-291">다음 표에서는 디스크 기반 테이블에서 여러 설정에 따른 읽기 가능한 보조 데이터베이스의 버전 관리 동작에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="b4d2b-291">The table below describes the behavior of versioning on a readable secondary database under different settings for disk based tables.</span></span>  
  
    |<span data-ttu-id="b4d2b-292">읽기 가능한 보조 복제본인지 여부</span><span class="sxs-lookup"><span data-stu-id="b4d2b-292">Readable secondary replica?</span></span>|<span data-ttu-id="b4d2b-293">스냅샷 격리 또는 RCSI 수준이 설정되었는지 여부</span><span class="sxs-lookup"><span data-stu-id="b4d2b-293">Snapshot isolation or RCSI level enabled?</span></span>|<span data-ttu-id="b4d2b-294">주 데이터베이스</span><span class="sxs-lookup"><span data-stu-id="b4d2b-294">Primary Database</span></span>|<span data-ttu-id="b4d2b-295">보조 데이터베이스</span><span class="sxs-lookup"><span data-stu-id="b4d2b-295">Secondary Database</span></span>|  
    |---------------------------------|-----------------------------------------------|----------------------|------------------------|  
    |<span data-ttu-id="b4d2b-296">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-296">No</span></span>|<span data-ttu-id="b4d2b-297">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-297">No</span></span>|<span data-ttu-id="b4d2b-298">행 버전이 없거나 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-298">No row versions or 14-byte overhead</span></span>|<span data-ttu-id="b4d2b-299">행 버전이 없거나 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-299">No row versions or 14-byte overhead</span></span>|  
    |<span data-ttu-id="b4d2b-300">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-300">No</span></span>|<span data-ttu-id="b4d2b-301">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-301">Yes</span></span>|<span data-ttu-id="b4d2b-302">행 버전이 있고 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-302">Row versions and 14-byte overhead</span></span>|<span data-ttu-id="b4d2b-303">행 버전이 없지만 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-303">No row versions, but 14-byte overhead</span></span>|  
    |<span data-ttu-id="b4d2b-304">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-304">Yes</span></span>|<span data-ttu-id="b4d2b-305">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-305">No</span></span>|<span data-ttu-id="b4d2b-306">행 버전이 없지만 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-306">No row versions, but 14-byte overhead</span></span>|<span data-ttu-id="b4d2b-307">행 버전이 있고 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-307">Row versions and 14-byte overhead</span></span>|  
    |<span data-ttu-id="b4d2b-308">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-308">Yes</span></span>|<span data-ttu-id="b4d2b-309">예</span><span class="sxs-lookup"><span data-stu-id="b4d2b-309">Yes</span></span>|<span data-ttu-id="b4d2b-310">행 버전이 있고 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-310">Row versions and 14-byte overhead</span></span>|<span data-ttu-id="b4d2b-311">행 버전이 있고 14바이트 오버헤드임</span><span class="sxs-lookup"><span data-stu-id="b4d2b-311">Row versions and 14-byte overhead</span></span>|  
  
##  <a name="related-tasks"></a><a name="bkmk_RelatedTasks"></a> <span data-ttu-id="b4d2b-312">관련 작업</span><span class="sxs-lookup"><span data-stu-id="b4d2b-312">Related Tasks</span></span>  
  
-   [<span data-ttu-id="b4d2b-313">가용성 복제본에 대한 읽기 전용 액세스 구성&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-313">Configure Read-Only Access on an Availability Replica &#40;SQL Server&#41;</span></span>](configure-read-only-access-on-an-availability-replica-sql-server.md)  
  
-   [<span data-ttu-id="b4d2b-314">가용성 그룹에 대한 읽기 전용 라우팅 구성&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-314">Configure Read-Only Routing for an Availability Group &#40;SQL Server&#41;</span></span>](configure-read-only-routing-for-an-availability-group-sql-server.md)  
  
-   [<span data-ttu-id="b4d2b-315">가용성 그룹 수신기 만들기 또는 구성&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-315">Create or Configure an Availability Group Listener &#40;SQL Server&#41;</span></span>](create-or-configure-an-availability-group-listener-sql-server.md)  
  
-   [<span data-ttu-id="b4d2b-316">가용성 그룹 모니터링&#40;Transact-SQL&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-316">Monitor Availability Groups &#40;Transact-SQL&#41;</span></span>](monitor-availability-groups-transact-sql.md)  
  
-   [<span data-ttu-id="b4d2b-317">가용성 복제본 속성 보기&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-317">View Availability Replica Properties &#40;SQL Server&#41;</span></span>](view-availability-replica-properties-sql-server.md)  
  
-   [<span data-ttu-id="b4d2b-318">새 가용성 그룹 대화 상자 사용&#40;SQL Server Management Studio&#41;</span><span class="sxs-lookup"><span data-stu-id="b4d2b-318">Use the New Availability Group Dialog Box &#40;SQL Server Management Studio&#41;</span></span>](use-the-new-availability-group-dialog-box-sql-server-management-studio.md)  
  
##  <a name="related-content"></a><a name="RelatedContent"></a> <span data-ttu-id="b4d2b-319">관련 내용</span><span class="sxs-lookup"><span data-stu-id="b4d2b-319">Related Content</span></span>  
  
-   [<span data-ttu-id="b4d2b-320">SQL Server AlwaysOn 팀 블로그: 공식 SQL Server AlwaysOn 팀 블로그</span><span class="sxs-lookup"><span data-stu-id="b4d2b-320">SQL Server AlwaysOn Team Blog: The official SQL Server AlwaysOn Team Blog</span></span>](https://blogs.msdn.com/b/sqlalwayson/)  
  
## <a name="see-also"></a><span data-ttu-id="b4d2b-321">참고 항목</span><span class="sxs-lookup"><span data-stu-id="b4d2b-321">See Also</span></span>  
 <span data-ttu-id="b4d2b-322">[AlwaysOn 가용성 그룹 &#40;SQL Server 개요&#41;](overview-of-always-on-availability-groups-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="b4d2b-322">[Overview of AlwaysOn Availability Groups &#40;SQL Server&#41;](overview-of-always-on-availability-groups-sql-server.md) </span></span>  
 <span data-ttu-id="b4d2b-323">[가용성 복제본에 대한 클라이언트 연결 액세스 정보&#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="b4d2b-323">[About Client Connection Access to Availability Replicas &#40;SQL Server&#41;](about-client-connection-access-to-availability-replicas-sql-server.md) </span></span>  
 <span data-ttu-id="b4d2b-324">[가용성 그룹 수신기, 클라이언트 연결 및 애플리케이션 장애 조치(failover)&#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span><span class="sxs-lookup"><span data-stu-id="b4d2b-324">[Availability Group Listeners, Client Connectivity, and Application Failover &#40;SQL Server&#41;](../../listeners-client-connectivity-application-failover.md) </span></span>  
 [<span data-ttu-id="b4d2b-325">통계</span><span class="sxs-lookup"><span data-stu-id="b4d2b-325">Statistics</span></span>](../../../relational-databases/statistics/statistics.md)  
  
  
