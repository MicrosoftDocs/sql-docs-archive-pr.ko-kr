---
title: 로그 전달 및 복제(SQL Server) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- replication [SQL Server], log shipping and
- log shipping [SQL Server], replication and
ms.assetid: 132bebfd-0206-4d23-829a-b38e5ed17bc9
author: MashaMSFT
ms.author: mathoma
ms.openlocfilehash: e3b1a0e08c5850b9e31202965909dfcfe1273e47
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87652328"
---
# <a name="log-shipping-and-replication-sql-server"></a><span data-ttu-id="2a26f-102">로그 전달 및 복제(SQL Server)</span><span class="sxs-lookup"><span data-stu-id="2a26f-102">Log Shipping and Replication (SQL Server)</span></span>
  <span data-ttu-id="2a26f-103">로그 전달에는 일반적으로 서로 다른 컴퓨터에 있는 두 개의 단일 데이터베이스 복사본이 사용됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-103">Log shipping involves two copies of a single database that typically reside on different computers.</span></span> <span data-ttu-id="2a26f-104">클라이언트는 항상 하나의 데이터베이스 복사본만 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-104">At any given time, only one copy of the database is currently available to clients.</span></span> <span data-ttu-id="2a26f-105">이 복사본을 주 데이터베이스라고 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-105">This copy is known as the primary database.</span></span> <span data-ttu-id="2a26f-106">클라이언트가 주 데이터베이스에 업데이트한 내용은 로그 전달을 사용하여 보조 데이터베이스라고 부르는 다른 데이터베이스 복사본에 전달됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-106">Updates made by clients to the primary database are propagated by means of log shipping to the other copy of the database, known as the secondary database.</span></span> <span data-ttu-id="2a26f-107">로그 전달에는 주 데이터베이스에 대해 수행된 모든 삽입, 업데이트 또는 삭제 작업의 트랜잭션 로그를 보조 데이터베이스에 적용하는 작업이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-107">Log shipping involves applying the transaction log from every insertion, update, or deletion made on the primary database onto the secondary database.</span></span>  
  
 <span data-ttu-id="2a26f-108">로그 전달은 다음과 같은 동작의 경우 복제와 함께 사용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-108">Log shipping can be used in conjunction with replication, with the following behavior:</span></span>  
  
-   <span data-ttu-id="2a26f-109">로그 전달 장애 조치(Failover) 이후에는 복제가 계속되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-109">Replication does not continue after a log shipping failover.</span></span> <span data-ttu-id="2a26f-110">장애 조치가 발생하면 복제 에이전트가 보조 데이터베이스에 연결하지 않기 때문에 트랜잭션이 구독자에 복제되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-110">If a failover occurs, replication agents do not connect to the secondary, so transactions are not replicated to Subscribers.</span></span> <span data-ttu-id="2a26f-111">주 서버에 대한 장애 복구(Failback)가 발생하면 복제가 다시 시작됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-111">If a failback to the primary occurs, replication resumes.</span></span> <span data-ttu-id="2a26f-112">로그 전달이 보조 서버에서 주 서버로 복사하는 모든 트랜잭션이 구독자에 복제됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-112">All transactions that log shipping copies from the secondary back to the primary are replicated to Subscribers.</span></span>  
  
-   <span data-ttu-id="2a26f-113">주 서버가 영구적으로 손실되면 보조 서버 이름을 바꿔서 복제를 계속할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-113">If the primary is permanently lost, the secondary can be renamed so that replication can continue.</span></span> <span data-ttu-id="2a26f-114">이 항목의 남은 부분에서는 이러한 경우를 처리하기 위한 요구 사항과 절차에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-114">The remainder of this topic describes the requirements and procedures for handling this case.</span></span> <span data-ttu-id="2a26f-115">제공된 예는 로그 전달에서 가장 일반적인 게시 데이터베이스이지만 구독 및 배포 데이터베이스에 더 간단한 프로세스를 적용할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-115">The example given is the publication database, which is the most common database to log ship, but a similar process can also be applied to subscription and distribution databases.</span></span>  
  
 <span data-ttu-id="2a26f-116">복제를 다시 구성할 필요 없이 복제에 관련된 데이터베이스를 복구하는 방법은 [복제된 데이터베이스 백업 및 복원](../../relational-databases/replication/administration/back-up-and-restore-replicated-databases.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-116">For information about recovering databases involved in replication without any need to reconfigure replication, see [Back Up and Restore Replicated Databases](../../relational-databases/replication/administration/back-up-and-restore-replicated-databases.md).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="2a26f-117">게시 데이터베이스의 가용성을 높이기 위해서는 로그 전달 대신 데이터베이스 미러링을 사용하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-117">We recommend using database mirroring, rather than log shipping, to provide availability for the publication database.</span></span> <span data-ttu-id="2a26f-118">자세한 내용은 [데이터베이스 미러링 및 복제&#40;SQL Server&#41;](../database-mirroring/database-mirroring-and-replication-sql-server.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-118">For more information, see [Database Mirroring and Replication &#40;SQL Server&#41;](../database-mirroring/database-mirroring-and-replication-sql-server.md).</span></span>  
  
## <a name="requirements-and-procedures-for-replicating-from-the-secondary-if-the-primary-is-lost"></a><span data-ttu-id="2a26f-119">주 서버가 손실된 경우 보조 서버로부터 복제하기 위한 요구 사항 및 절차</span><span class="sxs-lookup"><span data-stu-id="2a26f-119">Requirements and Procedures for Replicating from the Secondary If the Primary Is Lost</span></span>  
 <span data-ttu-id="2a26f-120">다음 요구 사항과 고려 사항에 주의하십시오.</span><span class="sxs-lookup"><span data-stu-id="2a26f-120">Be aware of the following requirements and considerations:</span></span>  
  
-   <span data-ttu-id="2a26f-121">주 서버에 하나 이상의 게시 데이터베이스가 포함된 경우 모든 게시 데이터베이스의 로그를 동일한 보조 서버로 전달합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-121">If a primary contains more than one publication database, log ship all of the publication databases to the same secondary.</span></span>  
  
-   <span data-ttu-id="2a26f-122">보조 서버 인스턴스의 설치 경로는 주 서버와 동일해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-122">The installation path for the secondary server instance must be the same as the primary.</span></span> <span data-ttu-id="2a26f-123">보조 서버의 사용자 데이터베이스 위치는 주 서버와 동일해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-123">User database locations on the secondary server must be the same as on the primary.</span></span>  
  
-   <span data-ttu-id="2a26f-124">주 서버에서 서비스 마스터 키를 백업합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-124">Back up the service master key at the primary.</span></span> <span data-ttu-id="2a26f-125">이 키는 보조 서버에서 복원됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-125">This key will be restored at the secondary.</span></span> <span data-ttu-id="2a26f-126">자세한 내용은 [BACKUP SERVICE MASTER KEY&#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-service-master-key-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-126">For more information, see [BACKUP SERVICE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/backup-service-master-key-transact-sql).</span></span>  
  
-   <span data-ttu-id="2a26f-127">로그 전달은 데이터 손실 방지를 보장하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-127">Log shipping does not guarantee against data loss.</span></span> <span data-ttu-id="2a26f-128">보조 데이터베이스에 오류가 발생하면 아직 백업되지 않은 데이터가 손실되거나 오류 중에 손실된 백업의 데이터가 손실될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-128">A failure on the primary database can result in the loss of data that has not yet been backed up or for backups that are lost during the failure.</span></span>  
  
### <a name="log-shipping-with-transactional-replication"></a><span data-ttu-id="2a26f-129">트랜잭션 복제의 로그 전달</span><span class="sxs-lookup"><span data-stu-id="2a26f-129">Log Shipping with Transactional Replication</span></span>  
 <span data-ttu-id="2a26f-130">트랜잭션 복제의 경우 로그 전달의 동작은 **sync with backup** 옵션에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-130">For transactional replication, the behavior of log shipping depends on the **sync with backup** option.</span></span> <span data-ttu-id="2a26f-131">이 옵션은 게시 데이터베이스 및 배포 데이터베이스에 설정될 수 있으며, 게시자의 로드 전달의 경우에는 게시 데이터베이스의 설정만 관련이 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-131">This option can be set on the publication database and distribution database; in log shipping for the Publisher, only the setting on the publication database is relevant.</span></span>  
  
 <span data-ttu-id="2a26f-132">게시 데이터베이스에 이 옵션을 설정하면 트랜잭션은 게시 데이터베이스에서 백업될 때까지 배포 데이터베이스로 배달되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-132">Setting this option on the publication database ensures that transactions are not delivered to the distribution database until they are backed up at the publication database.</span></span> <span data-ttu-id="2a26f-133">그러면 복원된 게시 데이터베이스에 없는 트랜잭션이 배포 데이터베이스에 있을 수 없으므로 보조 서버에서 마지막 게시 데이터베이스 백업을 복원할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-133">The last publication database backup can then be restored at the secondary server without any possibility of the distribution database having transactions that the restored publication database does not have.</span></span> <span data-ttu-id="2a26f-134">이 옵션은 게시자가 보조 서버로 장애 조치되는 경우 게시자, 배포자 및 구독자 간의 일관성이 유지되도록 보장합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-134">This option guarantees that if the Publisher fails over to a secondary server, consistency is maintained between the Publisher, Distributor, and Subscribers.</span></span> <span data-ttu-id="2a26f-135">트랜잭션이 게시자에서 백업되기 전까지는 배포 데이터베이스로 트랜잭션을 전달할 수 없으므로 지연이 발생하거나 처리량이 줄어들 수 있습니다. 애플리케이션에서 이러한 지연이 허용되는 경우 게시 데이터베이스에 이 옵션을 설정하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-135">Latency and throughput are affected because transactions cannot be delivered to the distribution database until they have been backed up at the Publisher; if your application can tolerate this latency, we recommend that you set this option on the publication database.</span></span> <span data-ttu-id="2a26f-136">**sync with backup** 옵션을 설정하지 않으면 보조 서버에서 복구된 데이터베이스에는 포함되지 않는 변경 내용을 구독자가 받을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-136">If the **sync with backup** option is not set, Subscribers might receive changes that are no longer included in the recovered database at the secondary server.</span></span> <span data-ttu-id="2a26f-137">자세한 내용은 [스냅샷 및 트랜잭션 복제의 백업 및 복원을 위한 전략](../../relational-databases/replication/transactional/transactional-replication.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-137">For more information, see [Strategies for Backing Up and Restoring Snapshot and Transactional Replication](../../relational-databases/replication/transactional/transactional-replication.md).</span></span>  
  
 <span data-ttu-id="2a26f-138">**sync with backup 옵션으로 트랜잭션 게시 및 로그 전달을 구성하려면**</span><span class="sxs-lookup"><span data-stu-id="2a26f-138">**To configure transactional replication and log shipping with the sync with backup option**</span></span>  
  
1.  <span data-ttu-id="2a26f-139">게시 데이터베이스에 sync with backup 옵션이 설정되어 있지 않으면 `sp_replicationdboption '<publicationdatabasename>', 'sync with backup', 'true'`를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-139">If the sync with backup option is not set on the publication database, execute `sp_replicationdboption '<publicationdatabasename>', 'sync with backup', 'true'`.</span></span> <span data-ttu-id="2a26f-140">자세한 내용은 [sp_replicationdboption&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-140">For more information, see [sp_replicationdboption &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replicationdboption-transact-sql).</span></span>  
  
2.  <span data-ttu-id="2a26f-141">게시 데이터베이스에 대한 로그 전달을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-141">Configure log shipping for the publication database.</span></span> <span data-ttu-id="2a26f-142">자세한 내용은 [로그 전달 구성&#40;SQL Server&#41;](configure-log-shipping-sql-server.md)에서 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-142">For more information, see [Configure Log Shipping &#40;SQL Server&#41;](configure-log-shipping-sql-server.md).</span></span>  
  
3.  <span data-ttu-id="2a26f-143">게시자에서 오류가 발생하면 RESTORE LOG의 KEEP_REPLICATION 옵션을 사용하여 데이터베이스의 마지막 로그를 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-143">If the Publisher fails, restore the last log of the database to the secondary server, using the KEEP_REPLICATION option of RESTORE LOG.</span></span> <span data-ttu-id="2a26f-144">이렇게 하면 데이터베이스에 대한 모든 복제 설정이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-144">This retains all replication settings for the database.</span></span> <span data-ttu-id="2a26f-145">자세한 내용은 [로그 전달 보조 데이터베이스로 장애 조치(Failover)&#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) 및 [RESTORE&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-145">For more information, see [Fail Over to a Log Shipping Secondary &#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) and [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
4.  <span data-ttu-id="2a26f-146">주 서버에서 보조 서버로 **msdb** 데이터베이스와 **master** 데이터베이스를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-146">Restore the **msdb** database and **master** databases from the primary to the secondary.</span></span> <span data-ttu-id="2a26f-147">자세한 내용은 [시스템 데이터베이스 백업 및 복원&#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-147">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span> <span data-ttu-id="2a26f-148">주 서버가 배포자이기도 한 경우 배포 데이터베이스를 주 서버에서 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-148">If the primary was also a Distributor, restore the distribution database from the primary to the secondary.</span></span>  
  
     <span data-ttu-id="2a26f-149">이러한 데이터베이스의 복제 구성 및 설정은 주 서버의 게시 데이터베이스와 일치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-149">These databases must be consistent with the publication database at the primary in terms of replication configuration and settings.</span></span>  
  
5.  <span data-ttu-id="2a26f-150">보조 서버에서 컴퓨터의 이름을 바꾼 후 주 서버 이름과 일치하도록 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스의 이름을 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-150">At the secondary server, rename the computer and then rename the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance to match the primary server name.</span></span> <span data-ttu-id="2a26f-151">컴퓨터의 이름을 바꾸는 방법은 Windows 설명서를 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="2a26f-151">For information about renaming the computer, see the Windows documentation.</span></span> <span data-ttu-id="2a26f-152">서버 이름을 바꾸는 방법은 [SQL Server의 독립 실행형 인스턴스를 호스팅하는 컴퓨터 이름 바꾸기](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) 및 [SQL Server 장애 조치(Failover) 클러스터 인스턴스 이름 변경](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-152">For information about renaming the server, see [Rename a Computer that Hosts a Stand-Alone Instance of SQL Server](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) and [Rename a SQL Server Failover Cluster Instance](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md).</span></span>  
  
6.  <span data-ttu-id="2a26f-153">보조 서버에서 주 서버로부터 백업한 서비스 마스터 키를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-153">At the secondary server, restore the service master key that was backed up from the primary.</span></span> <span data-ttu-id="2a26f-154">자세한 내용은 [RESTORE SERVICE MASTER KEY&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-154">For more information, see [RESTORE SERVICE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql).</span></span>  
  
 <span data-ttu-id="2a26f-155">**sync with backup 옵션을 사용하지 않고 트랜잭션 게시 및 로그 전달을 구성하려면**</span><span class="sxs-lookup"><span data-stu-id="2a26f-155">**To configure transactional replication and log shipping without the sync with backup option**</span></span>  
  
1.  <span data-ttu-id="2a26f-156">게시 데이터베이스에 대한 로그 전달을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-156">Configure log shipping for the publication database.</span></span> <span data-ttu-id="2a26f-157">자세한 내용은 [로그 전달 구성&#40;SQL Server&#41;](configure-log-shipping-sql-server.md)에서 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-157">For more information, see [Configure Log Shipping &#40;SQL Server&#41;](configure-log-shipping-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="2a26f-158">게시자에서 오류가 발생하면 RESTORE LOG의 KEEP_REPLICATION 옵션을 사용하여 데이터베이스의 마지막 로그를 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-158">If the Publisher fails, restore the last log of the database to the secondary server, using the KEEP_REPLICATION option of RESTORE LOG.</span></span> <span data-ttu-id="2a26f-159">이렇게 하면 데이터베이스에 대한 모든 복제 설정이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-159">This retains all replication settings for the database.</span></span> <span data-ttu-id="2a26f-160">자세한 내용은 [로그 전달 보조 데이터베이스로 장애 조치(Failover)&#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) 및 [RESTORE&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-160">For more information, see [Fail Over to a Log Shipping Secondary &#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) and [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
3.  <span data-ttu-id="2a26f-161">주 서버에서 보조 서버로 **msdb** 데이터베이스와 **master** 데이터베이스를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-161">Restore the **msdb** database and **master** databases from the primary to the secondary.</span></span> <span data-ttu-id="2a26f-162">자세한 내용은 [시스템 데이터베이스 백업 및 복원&#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-162">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span> <span data-ttu-id="2a26f-163">주 서버가 배포자이기도 한 경우 배포 데이터베이스를 주 서버에서 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-163">If the primary was also a Distributor, restore the distribution database from the primary to the secondary.</span></span>  
  
     <span data-ttu-id="2a26f-164">이러한 데이터베이스의 복제 구성 및 설정은 주 서버의 게시 데이터베이스와 일치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-164">These databases must be consistent with the publication database at the primary in terms of replication configuration and settings.</span></span>  
  
4.  <span data-ttu-id="2a26f-165">보조 서버에서 컴퓨터의 이름을 바꾼 후 주 서버 이름과 일치하도록 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스의 이름을 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-165">At the secondary server, rename the computer and then rename the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance to match the primary server name.</span></span> <span data-ttu-id="2a26f-166">컴퓨터의 이름을 바꾸는 방법은 Windows 설명서를 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="2a26f-166">For information about renaming the computer, see the Windows documentation.</span></span> <span data-ttu-id="2a26f-167">서버 이름을 바꾸는 방법은 [SQL Server의 독립 실행형 인스턴스를 호스팅하는 컴퓨터 이름 바꾸기](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) 및 [SQL Server 장애 조치(Failover) 클러스터 인스턴스 이름 변경](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-167">For information about renaming the server, see [Rename a Computer that Hosts a Stand-Alone Instance of SQL Server](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) and [Rename a SQL Server Failover Cluster Instance](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md).</span></span>  
  
     <span data-ttu-id="2a26f-168">게시 데이터베이스 및 배포 데이터베이스가 동기화되지 않았다는 오류 메시지가 로그 판독기 에이전트에서 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-168">You might receive an error message from the Log Reader Agent that the publication database and the distribution database are not synchronized.</span></span>  
  
5.  <span data-ttu-id="2a26f-169">보조 서버에서 주 서버로부터 백업한 서비스 마스터 키를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-169">At the secondary server, restore the service master key that was backed up from the primary.</span></span> <span data-ttu-id="2a26f-170">자세한 내용은 [RESTORE SERVICE MASTER KEY&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-170">For more information, see [RESTORE SERVICE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql).</span></span>  
  
6.  <span data-ttu-id="2a26f-171">**sp_replrestart**를 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-171">Execute **sp_replrestart**.</span></span> <span data-ttu-id="2a26f-172">이 저장 프로시저를 사용하면 로그 판독기 에이전트가 게시 데이터베이스 로그에서 이전에 복제된 모든 트랜잭션을 강제로 무시하도록 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-172">This stored procedure can be used to force the Log Reader Agent to ignore all the previous replicated transactions in the publication database log.</span></span> <span data-ttu-id="2a26f-173">저장 프로시저가 완료된 후에 적용된 트랜잭션은 로그 판독기 에이전트에 의해 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-173">Transactions applied after the completion of the stored procedure are processed by the Log Reader Agent.</span></span> <span data-ttu-id="2a26f-174">자세한 내용은 [sp_replrestart&#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-174">For more information, see [sp_replrestart &#40;Transact-SQL&#41;](/sql/relational-databases/system-stored-procedures/sp-replrestart-transact-sql).</span></span>  
  
7.  <span data-ttu-id="2a26f-175">저장 프로시저가 성공적으로 실행된 후에 로그 판독기 에이전트를 다시 시작합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-175">Restart the Log Reader Agent after the stored procedure executes successfully.</span></span> <span data-ttu-id="2a26f-176">자세한 내용은 [복제 에이전트 시작 및 중지&#40;SQL Server Management Studio&#41;](../../relational-databases/replication/agents/start-and-stop-a-replication-agent-sql-server-management-studio.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-176">For more information, see [Start and Stop a Replication Agent &#40;SQL Server Management Studio&#41;](../../relational-databases/replication/agents/start-and-stop-a-replication-agent-sql-server-management-studio.md).</span></span>  
  
8.  <span data-ttu-id="2a26f-177">구독자에 이미 배포된 트랜잭션은 게시자에 적용될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-177">Transactions that have already been distributed to Subscriber might be applied at the Publisher.</span></span> <span data-ttu-id="2a26f-178">배포 에이전트에서 이러한 트랜잭션을 구독자에서 다시 적용할 때 오류가 발생하지 않도록 하려면 **데이터 일관성 오류가 발생했지만 계속됩니다**라는 에이전트 프로필을 지정합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-178">To ensure that the Distribution Agent does not fail with an error when attempting to reapply these transactions at a Subscriber, specify the agent profile titled **Continue On Data Consistency Errors**.</span></span>  
  
### <a name="log-shipping-with-merge-replication"></a><span data-ttu-id="2a26f-179">병합 복제의 로그 전달</span><span class="sxs-lookup"><span data-stu-id="2a26f-179">Log Shipping with Merge Replication</span></span>  
 <span data-ttu-id="2a26f-180">병합 복제와 로그 전달을 구성하려면 아래 절차의 단계를 따르십시오.</span><span class="sxs-lookup"><span data-stu-id="2a26f-180">Follow the steps in the procedure below to configure merge replication and log shipping.</span></span>  
  
 <span data-ttu-id="2a26f-181">**병합 복제 및 로그 전달을 구성하려면**</span><span class="sxs-lookup"><span data-stu-id="2a26f-181">**To configure merge replication and log shipping**</span></span>  
  
1.  <span data-ttu-id="2a26f-182">게시 데이터베이스에 대한 로그 전달을 구성합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-182">Configure log shipping for the publication database.</span></span> <span data-ttu-id="2a26f-183">자세한 내용은 [로그 전달 구성&#40;SQL Server&#41;](configure-log-shipping-sql-server.md)에서 도입되었습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-183">For more information, see [Configure Log Shipping &#40;SQL Server&#41;](configure-log-shipping-sql-server.md).</span></span>  
  
2.  <span data-ttu-id="2a26f-184">게시자가 실패하면 보조 서버에서 컴퓨터의 이름을 바꾼 후 주 서버 이름과 일치하도록 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스의 이름을 바꿉니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-184">If the Publisher fails, at the secondary server, rename the computer and then rename the [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] instance to match the primary server name.</span></span> <span data-ttu-id="2a26f-185">컴퓨터의 이름을 바꾸는 방법은 Windows 설명서를 참조하십시오.</span><span class="sxs-lookup"><span data-stu-id="2a26f-185">For information about renaming the computer, see the Windows documentation.</span></span> <span data-ttu-id="2a26f-186">서버 이름을 바꾸는 방법은 [SQL Server의 독립 실행형 인스턴스를 호스팅하는 컴퓨터 이름 바꾸기](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) 및 [SQL Server 장애 조치(Failover) 클러스터 인스턴스 이름 변경](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-186">For information about renaming the server, see [Rename a Computer that Hosts a Stand-Alone Instance of SQL Server](../install-windows/rename-a-computer-that-hosts-a-stand-alone-instance-of-sql-server.md) and [Rename a SQL Server Failover Cluster Instance](../../sql-server/failover-clusters/install/rename-a-sql-server-failover-cluster-instance.md).</span></span>  
  
3.  <span data-ttu-id="2a26f-187">RESTORE LOG의 KEEP_REPLICATION 옵션을 사용하여 데이터베이스의 마지막 로그를 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-187">Restore the last log of the database to the secondary server, using the KEEP_REPLICATION option of RESTORE LOG.</span></span> <span data-ttu-id="2a26f-188">이렇게 하면 데이터베이스에 대한 모든 복제 설정이 유지됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-188">This retains all replication settings for the database.</span></span> <span data-ttu-id="2a26f-189">자세한 내용은 [로그 전달 보조 데이터베이스로 장애 조치(Failover)&#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) 및 [RESTORE&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-189">For more information, see [Fail Over to a Log Shipping Secondary &#40;SQL Server&#41;](fail-over-to-a-log-shipping-secondary-sql-server.md) and [RESTORE &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-statements-transact-sql).</span></span>  
  
4.  <span data-ttu-id="2a26f-190">주 서버에서 보조 서버로 **msdb** 데이터베이스와 **master** 데이터베이스를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-190">Restore the **msdb** database and **master** databases from the primary to the secondary.</span></span> <span data-ttu-id="2a26f-191">자세한 내용은 [시스템 데이터베이스 백업 및 복원&#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-191">For more information, see [Back Up and Restore of System Databases &#40;SQL Server&#41;](../../relational-databases/backup-restore/back-up-and-restore-of-system-databases-sql-server.md).</span></span> <span data-ttu-id="2a26f-192">주 서버가 배포자이기도 한 경우 배포 데이터베이스를 주 서버에서 보조 서버로 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-192">If the primary was also a Distributor, restore the distribution database from the primary to the secondary.</span></span>  
  
     <span data-ttu-id="2a26f-193">이러한 데이터베이스의 복제 구성 및 설정은 주 서버의 게시 데이터베이스와 일치해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-193">These databases must be consistent with the publication database at the primary in terms of replication configuration and settings.</span></span>  
  
5.  <span data-ttu-id="2a26f-194">보조 서버에서 주 서버로부터 백업한 서비스 마스터 키를 복원합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-194">At the secondary server, restore the service master key that was backed up from the primary.</span></span> <span data-ttu-id="2a26f-195">자세한 내용은 [RESTORE SERVICE MASTER KEY&#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-195">For more information, see [RESTORE SERVICE MASTER KEY &#40;Transact-SQL&#41;](/sql/t-sql/statements/restore-service-master-key-transact-sql).</span></span>  
  
6.  <span data-ttu-id="2a26f-196">하나 이상의 구독 데이터베이스와 게시 데이터베이스를 동기화합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-196">Synchronize the publication database with one or more subscription databases.</span></span> <span data-ttu-id="2a26f-197">이렇게 하면 이전 게시 데이터베이스에서 변경되었지만 복원된 백업에 표시되지 않은 변경 내용을 업로드할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-197">This allows you to upload those changes made previously in the publication database, but not represented in the restored backup.</span></span> <span data-ttu-id="2a26f-198">업로드할 수 있는 데이터는 게시가 필터링되는 방식에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-198">The data that can be uploaded depends on the way in which a publication is filtered:</span></span>  
  
    -   <span data-ttu-id="2a26f-199">게시가 필터링되지 않은 경우 최신 구독자와 동기화하여 게시 데이터베이스를 최신 상태로 만들 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-199">If the publication is not filtered, you should be able to bring the publication database up-to-date by synchronizing with the most up-to-date Subscriber.</span></span>  
  
    -   <span data-ttu-id="2a26f-200">게시가 필터링된 경우 게시 데이터베이스를 최신 상태로 만들 수 없을 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-200">If the publication is filtered, you might not be able to bring the publication database up-to-date.</span></span> <span data-ttu-id="2a26f-201">각 구독이 동부, 서부, 남부 및 북부 중 한 지역에 대한 고객 데이터만 수신하도록 분할된 테이블을 고려해 봅니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-201">Consider a table that is partitioned such that each subscription receives customer data only for a single region: North, East, South, and West.</span></span> <span data-ttu-id="2a26f-202">각 데이터 파티션에 대해 최소 하나의 구독자가 있는 경우 각 파티션에 대해 구독자와 동기화하면 게시 데이터베이스가 최신 상태가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-202">If there is at least one Subscriber for each partition of data, synchronizing with a Subscriber for each partition should bring the publication database up-to-date.</span></span> <span data-ttu-id="2a26f-203">그러나 예를 들어 서부 파티션의 데이터가 구독자에 복제되지 않은 경우에는 게시자에서 이 데이터를 최신 상태로 만들 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-203">However, if data in the West partition, for example, was not replicated to any Subscribers, this data at the Publisher cannot be brought up-to-date.</span></span> <span data-ttu-id="2a26f-204">이 경우에는 게시자 및 구독자의 데이터가 일치하도록 모든 구독을 다시 초기화하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-204">In this case, we recommend reinitializing all subscriptions so that the data at the Publisher and Subscribers converges.</span></span> <span data-ttu-id="2a26f-205">자세한 내용은 [구독 다시 초기화](../../relational-databases/replication/reinitialize-subscriptions.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-205">For more information, see [Reinitialize Subscriptions](../../relational-databases/replication/reinitialize-subscriptions.md).</span></span>  
  
     <span data-ttu-id="2a26f-206">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 이전 버전의 [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)]를 실행하는 구독자와 동기화할 경우에 해당 구독은 익명일 수 없습니다. 구독은 클라이언트 구독 또는 서버 구독(이전 버전에서는 로컬 구독 및 전역 구독)이어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="2a26f-206">If you synchronize with a Subscriber that is running a version of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] prior to [!INCLUDE[ssVersion2005](../../includes/ssversion2005-md.md)], the subscription cannot be anonymous; it must be a client subscription or server subscription (referred to as local subscriptions and global subscriptions in previous releases).</span></span> <span data-ttu-id="2a26f-207">자세한 내용은 [데이터 동기화](../../relational-databases/replication/synchronize-data.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="2a26f-207">For more information, see [Synchronize Data](../../relational-databases/replication/synchronize-data.md).</span></span>   
  
## <a name="see-also"></a><span data-ttu-id="2a26f-208">참고 항목</span><span class="sxs-lookup"><span data-stu-id="2a26f-208">See Also</span></span>  
 <span data-ttu-id="2a26f-209">[SQL Server 복제](../../relational-databases/replication/sql-server-replication.md) </span><span class="sxs-lookup"><span data-stu-id="2a26f-209">[SQL Server Replication](../../relational-databases/replication/sql-server-replication.md) </span></span>  
 <span data-ttu-id="2a26f-210">[로그 전달 정보&#40;SQL Server&#41;](about-log-shipping-sql-server.md) </span><span class="sxs-lookup"><span data-stu-id="2a26f-210">[About Log Shipping &#40;SQL Server&#41;](about-log-shipping-sql-server.md) </span></span>  
 [<span data-ttu-id="2a26f-211">데이터베이스 미러링 및 복제&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="2a26f-211">Database Mirroring and Replication &#40;SQL Server&#41;</span></span>](../database-mirroring/database-mirroring-and-replication-sql-server.md)  
  
  
