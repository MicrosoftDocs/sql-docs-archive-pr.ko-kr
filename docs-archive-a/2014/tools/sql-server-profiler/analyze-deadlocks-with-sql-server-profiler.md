---
title: SQL Server Profiler를 사용 하 여 교착 상태 분석 | Microsoft Docs
ms.custom: ''
ms.date: 03/06/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: profiler
ms.topic: conceptual
helpviewer_keywords:
- process nodes [SQL Server Profiler]
- Profiler [SQL Server Profiler], deadlocks
- deadlocks [SQL Server], identifying cause
- resource nodes [SQL Server Profiler]
- graphs [SQL Server Profiler]
- SQL Server Profiler, deadlocks
- events [SQL Server], deadlocks
- edges [SQL Server Profiler]
ms.assetid: 72d6718f-501b-4ea6-b344-c0e653f19561
author: stevestein
ms.author: sstein
ms.openlocfilehash: 3414cda74d75dbacf10ed98b6fc6d50da2feaa18
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87727615"
---
# <a name="analyze-deadlocks-with-sql-server-profiler"></a><span data-ttu-id="cefee-102">SQL Server Profiler를 사용하여 교착 상태 분석</span><span class="sxs-lookup"><span data-stu-id="cefee-102">Analyze Deadlocks with SQL Server Profiler</span></span>
  <span data-ttu-id="cefee-103">[!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] 를 사용하여 교착 상태의 원인을 확인할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-103">Use [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to identify the cause of a deadlock.</span></span> <span data-ttu-id="cefee-104">둘 이상의 스레드 또는 프로세스 간에 SQL Server 내의 일부 리소스에 대한 순환 종속성이 있는 경우 교착 상태가 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-104">A deadlock occurs when there is a cyclic dependency between two or more threads, or processes, for some set of resources within SQL Server.</span></span> <span data-ttu-id="cefee-105">[!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)]를 사용하여 교착 상태 이벤트를 기록하고 재생하고 표시하는 추적을 만들어 분석할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-105">Using [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)], you can create a trace that records, replays, and displays deadlock events for analysis.</span></span>  
  
 <span data-ttu-id="cefee-106">교착 상태 이벤트를 추적하려면 **Deadlock graph** 이벤트 클래스를 추적에 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-106">To trace deadlock events, add the **Deadlock graph** event class to a trace.</span></span> <span data-ttu-id="cefee-107">이 이벤트 클래스는 교착 상태와 관련된 프로세스 및 개체에 대한 XML 데이터로 추적 시 **TextData** 데이터 열을 채웁니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-107">This event class populates the **TextData** data column in the trace with XML data about the process and objects that are involved in the deadlock.</span></span> [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="cefee-108">는 XML 문서를 교착 상태 XML(.xdl) 파일로 추출할 수 있습니다. 이 XML 파일은 나중에 SQL Server Management Studio에서 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-108">can extract the XML document to a deadlock XML (.xdl) file which you can view later in SQL Server Management Studio.</span></span> <span data-ttu-id="cefee-109">[!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] 를 구성하여 모든 **Deadlock graph** 이벤트가 포함되어 있는 단일 파일로 **Deadlock graph** 이벤트를 추출하거나 개별 파일로 추출할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-109">You can configure [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] to extract **Deadlock graph** events to a single file that contains all **Deadlock graph** events, or to separate files.</span></span> <span data-ttu-id="cefee-110">다음과 같은 방법으로 추출할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-110">This extraction can be done in any of the following ways:</span></span>  
  
-   <span data-ttu-id="cefee-111">추적 구성 시 **이벤트 추출 설정** 탭을 사용합니다. **이벤트 선택** 탭에서 **Deadlock graph** 이벤트를 선택해야만 이 탭이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-111">At trace configuration time, using the **Events Extraction Settings** tab. Note that this tab does not appear until you select the **Deadlock graph** event on the **Events Selection** tab.</span></span>  
  
-   <span data-ttu-id="cefee-112">**파일** 메뉴에서 **SQL Server 이벤트 추출** 옵션을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-112">Using the **Extract SQL Server Events** option on the **File** menu.</span></span>  
  
-   <span data-ttu-id="cefee-113">개별 이벤트는 특정 이벤트를 마우스 오른쪽 단추로 클릭하고 **이벤트 데이터 추출**을 선택하여 추출 및 저장할 수도 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-113">Individual events can also be extracted and saved by right-clicking a specific event and choosing **Extract Event Data**.</span></span>  
  
## <a name="deadlock-graphs"></a><span data-ttu-id="cefee-114">교착 상태 그래프</span><span class="sxs-lookup"><span data-stu-id="cefee-114">Deadlock Graphs</span></span>  
 [!INCLUDE[ssSqlProfiler](../../includes/sssqlprofiler-md.md)] <span data-ttu-id="cefee-115">와 [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] 는 교착 상태 WAITFOR 그래프를 사용하여 교착 상태를 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-115">and [!INCLUDE[ssManStudioFull](../../includes/ssmanstudiofull-md.md)] use a deadlock wait-for graph to describe a deadlock.</span></span> <span data-ttu-id="cefee-116">교착 상태 WAITFOR 그래프에는 프로세스 노드, 리소스 노드 및 프로세스와 리소스 간의 관계를 나타내는 가장자리가 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-116">The deadlock wait-for graph contains process nodes, resource nodes, and edges representing the relationships between the processes and the resources.</span></span> <span data-ttu-id="cefee-117">WAITFOR 그래프의 구성 요소는 다음 표에 정의되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-117">The components of wait-for graphs are defined in the following table:</span></span>  
  
 <span data-ttu-id="cefee-118">프로세스 노드</span><span class="sxs-lookup"><span data-stu-id="cefee-118">Process node</span></span>  
 <span data-ttu-id="cefee-119">태스크를 수행하는 스레드입니다. 예를 들어 INSERT, UPDATE 또는 DELETE입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-119">A thread that performs a task; for example, INSERT, UPDATE, or DELETE.</span></span>  
  
 <span data-ttu-id="cefee-120">리소스 노드</span><span class="sxs-lookup"><span data-stu-id="cefee-120">Resource node</span></span>  
 <span data-ttu-id="cefee-121">데이터베이스 개체입니다. 예를 들어 테이블, 인덱스 또는 행입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-121">A database object; for example, a table, index, or row.</span></span>  
  
 <span data-ttu-id="cefee-122">Microsoft Edge</span><span class="sxs-lookup"><span data-stu-id="cefee-122">Edge</span></span>  
 <span data-ttu-id="cefee-123">프로세스와 리소스 간의 관계입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-123">A relationship between a process and a resource.</span></span> <span data-ttu-id="cefee-124">`request` 가장자리는 프로세스가 리소스를 대기할 때 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-124">A `request` edge occurs when a process waits for a resource.</span></span> <span data-ttu-id="cefee-125">`owner` 가장자리는 리소스가 프로세스를 대기할 때 발생합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-125">An `owner` edge occurs when a resource waits for a process.</span></span> <span data-ttu-id="cefee-126">잠금 모드는 가장자리 설명에 포함되어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-126">The lock mode is included in the edge description.</span></span> <span data-ttu-id="cefee-127">예: **모드: X**.</span><span class="sxs-lookup"><span data-stu-id="cefee-127">For example, **Mode: X**.</span></span>  
  
## <a name="deadlock-process-node"></a><span data-ttu-id="cefee-128">교착 상태 프로세스 모드</span><span class="sxs-lookup"><span data-stu-id="cefee-128">Deadlock Process Node</span></span>  
 <span data-ttu-id="cefee-129">WAITFOR 그래프에서 프로세스 노드는 프로세스에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-129">In a wait-for graph, the process node contains information about the process.</span></span> <span data-ttu-id="cefee-130">다음 표에서는 프로세스의 구성 요소에 대해 설명합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-130">The following table explains the components of a process.</span></span>  
  
|<span data-ttu-id="cefee-131">구성 요소</span><span class="sxs-lookup"><span data-stu-id="cefee-131">Component</span></span>|<span data-ttu-id="cefee-132">정의</span><span class="sxs-lookup"><span data-stu-id="cefee-132">Definition</span></span>|  
|---------------|----------------|  
|<span data-ttu-id="cefee-133">서버 프로세스 ID</span><span class="sxs-lookup"><span data-stu-id="cefee-133">Server process Id</span></span>|<span data-ttu-id="cefee-134">SPID(서버 프로세스 식별자)는 서버가 잠금을 소유하고 있는 프로세스에 할당한 식별자입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-134">Server process identifier (SPID), a server assigned identifier for the process owning the lock.</span></span>|  
|<span data-ttu-id="cefee-135">서버 일괄 처리 ID</span><span class="sxs-lookup"><span data-stu-id="cefee-135">Server batch Id</span></span>|<span data-ttu-id="cefee-136">SBID(서버 일괄 처리 식별자)입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-136">Server batch identifier (SBID).</span></span>|  
|<span data-ttu-id="cefee-137">실행 컨텍스트 ID</span><span class="sxs-lookup"><span data-stu-id="cefee-137">Execution context Id</span></span>|<span data-ttu-id="cefee-138">ECID(실행 컨텍스트 식별자)입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-138">Execution context identifier (ECID).</span></span> <span data-ttu-id="cefee-139">특정 SPID와 관련된 주어진 스레드의 실행 컨텍스트 ID입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-139">The execution context ID of a given thread associated with a specific SPID.</span></span><br /><br /> <span data-ttu-id="cefee-140">ECID = {0,1,2,3, *...n*}이며 여기서 0은 항상 주 또는 부모 스레드를 의미하고 {1,2,3, *...n*}은 하위 스레드를 의미합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-140">ECID = {0,1,2,3, *...n*}, where 0 always represents the main or parent thread, and {1,2,3, *...n*} represent the subthreads.</span></span>|  
|<span data-ttu-id="cefee-141">교착 상태 우선 순위</span><span class="sxs-lookup"><span data-stu-id="cefee-141">Deadlock priority</span></span>|<span data-ttu-id="cefee-142">프로세스의 교착 상태 우선 순위입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-142">Deadlock priority for the process.</span></span> <span data-ttu-id="cefee-143">가능한 값에 대한 자세한 내용은 [SET DEADLOCK_PRIORITY&#40;Transact-SQL&#41;](/sql/t-sql/statements/set-deadlock-priority-transact-sql)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="cefee-143">For more information about possible values, see [SET DEADLOCK_PRIORITY &#40;Transact-SQL&#41;](/sql/t-sql/statements/set-deadlock-priority-transact-sql).</span></span>|  
|<span data-ttu-id="cefee-144">사용된 로그</span><span class="sxs-lookup"><span data-stu-id="cefee-144">Log Used</span></span>|<span data-ttu-id="cefee-145">프로세스가 사용한 로그 공간입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-145">Amount of log space used by the process.</span></span>|  
|<span data-ttu-id="cefee-146">소유자 ID</span><span class="sxs-lookup"><span data-stu-id="cefee-146">Owner Id</span></span>|<span data-ttu-id="cefee-147">트랜잭션을 사용 중이고 잠금에 대해 현재 대기 중인 프로세스의 트랜잭션 ID입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-147">Transaction ID for the processes which are using transactions and currently waiting on a lock.</span></span>|  
|<span data-ttu-id="cefee-148">트랜잭션 설명자</span><span class="sxs-lookup"><span data-stu-id="cefee-148">Transaction descriptor</span></span>|<span data-ttu-id="cefee-149">트랜잭션 상태를 설명하는 트랜잭션 설명자에 대한 포인터입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-149">Pointer to the transaction descriptor that describes the state of the transaction.</span></span>|  
|<span data-ttu-id="cefee-150">입력 버퍼</span><span class="sxs-lookup"><span data-stu-id="cefee-150">Input buffer</span></span>|<span data-ttu-id="cefee-151">현재 프로세스의 입력 버퍼. 이벤트의 유형과 실행 중인 문을 정의합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-151">Input buffer of the current process, defines the type of event and the statement being executed.</span></span> <span data-ttu-id="cefee-152">가능한 값은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-152">Possible values include:</span></span><br /><br /> <span data-ttu-id="cefee-153">**언어**</span><span class="sxs-lookup"><span data-stu-id="cefee-153">**Language**</span></span><br /><br /> <span data-ttu-id="cefee-154">**RPC**</span><span class="sxs-lookup"><span data-stu-id="cefee-154">**RPC**</span></span><br /><br /> <span data-ttu-id="cefee-155">**없음**</span><span class="sxs-lookup"><span data-stu-id="cefee-155">**None**</span></span>|  
|<span data-ttu-id="cefee-156">인수를 제거합니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-156">Statement</span></span>|<span data-ttu-id="cefee-157">문 유형.</span><span class="sxs-lookup"><span data-stu-id="cefee-157">Type of statement.</span></span> <span data-ttu-id="cefee-158">가능한 값은 다음과 같습니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-158">Possible values are:</span></span><br /><br /> <span data-ttu-id="cefee-159">**NOP**</span><span class="sxs-lookup"><span data-stu-id="cefee-159">**NOP**</span></span><br /><br /> <span data-ttu-id="cefee-160">**SELECT**</span><span class="sxs-lookup"><span data-stu-id="cefee-160">**SELECT**</span></span><br /><br /> <span data-ttu-id="cefee-161">**UPDATE**</span><span class="sxs-lookup"><span data-stu-id="cefee-161">**UPDATE**</span></span><br /><br /> <span data-ttu-id="cefee-162">**INSERT**</span><span class="sxs-lookup"><span data-stu-id="cefee-162">**INSERT**</span></span><br /><br /> <span data-ttu-id="cefee-163">**DELETE**</span><span class="sxs-lookup"><span data-stu-id="cefee-163">**DELETE**</span></span><br /><br /> <span data-ttu-id="cefee-164">**알 수 없음**</span><span class="sxs-lookup"><span data-stu-id="cefee-164">**Unknown**</span></span>|  
  
## <a name="deadlock-resource-node"></a><span data-ttu-id="cefee-165">교착 상태 리소스 노드</span><span class="sxs-lookup"><span data-stu-id="cefee-165">Deadlock Resource Node</span></span>  
 <span data-ttu-id="cefee-166">두 프로세스가 각각 다른 프로세스에서 소유하고 있는 리소스를 대기하고 있는 상태가 교착 상태입니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-166">In a deadlock, two processes are each waiting for a resource held by the other process.</span></span> <span data-ttu-id="cefee-167">교착 상태 그래프에서 리소스는 리소스 노드로 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="cefee-167">In a deadlock graph, the resources are displayed as resource nodes.</span></span>  
  
  
