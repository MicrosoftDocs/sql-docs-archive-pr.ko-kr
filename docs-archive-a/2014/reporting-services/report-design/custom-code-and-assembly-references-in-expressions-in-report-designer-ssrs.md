---
title: 보고서 디자이너의 식에 포함된 사용자 지정 코드 및 어셈블리 참조(SSRS) | Microsoft Docs
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: reporting-services-native
ms.topic: conceptual
helpviewer_keywords:
- items [Reporting Services], expressions
- data [Reporting Services], expressions
- expressions [Reporting Services], about expressions
- expressions [Reporting Services]
- SSRS, expressions
- formulas [Reporting Services]
- data manipulation [Reporting Services]
- SQL Server Reporting Services, expressions
ms.assetid: ae8a0166-2ccc-45f4-8d28-c150da7b73de
author: maggiesMSFT
ms.author: maggies
manager: kfile
ms.openlocfilehash: 0f895d1ecc569092dfbae22b514d3470e020b94d
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87736120"
---
# <a name="custom-code-and-assembly-references-in-expressions-in-report-designer-ssrs"></a><span data-ttu-id="f7690-102">보고서 디자이너의 식에 포함된 사용자 지정 코드 및 어셈블리 참조(SSRS)</span><span class="sxs-lookup"><span data-stu-id="f7690-102">Custom Code and Assembly References in Expressions in Report Designer (SSRS)</span></span>
  <span data-ttu-id="f7690-103">보고서에 포함된 사용자 지정 코드 또는 직접 작성한 사용자 지정 어셈블리에 대한 참조를 추가한 다음 컴퓨터에 저장하고 보고서 서버로 배포할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-103">You can add references to custom code embedded in a report or to custom assemblies that you build and save to your computer and deploy to the report server.</span></span> <span data-ttu-id="f7690-104">단일 보고서에서 여러 번 사용된 함수, 사용자 지정 상수 또는 복잡한 함수에는 포함 코드를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-104">Use embedded code for custom constants, complex functions or functions that are used multiple times in a single report.</span></span> <span data-ttu-id="f7690-105">코드를 한 위치에서 관리하면서 여러 보고서에서 사용할 수 있도록 공유하려면 사용자 지정 코드 어셈블리를 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-105">Use custom code assemblies to maintain code in a single place and share it for use by multiple reports.</span></span> <span data-ttu-id="f7690-106">사용자 지정 코드에는 새로운 사용자 지정 상수, 변수, 함수 또는 서브루틴이 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-106">Custom code can include new custom constants, variables, functions, or subroutines.</span></span> <span data-ttu-id="f7690-107">Parameters 컬렉션과 같은 기본 제공 컬렉션에 대한 읽기 전용 참조를 포함할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-107">You can include read-only references to built-in collections such as the Parameters collection.</span></span> <span data-ttu-id="f7690-108">그러나 사용자 지정 함수에 보고서 데이터 값 집합을 전달할 수 없으며 특히 사용자 지정 집계는 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-108">However, you cannot pass sets of report data values to custom functions; specifically, custom aggregates are not supported.</span></span>  
  
> [!IMPORTANT]  
>  <span data-ttu-id="f7690-109">런타임에 한 번 계산되고 보고서 처리 과정에서 같은 값을 유지해야 하는 시간적 제한을 받는 계산의 경우 보고서 변수 또는 그룹 변수 사용을 고려하십시오.</span><span class="sxs-lookup"><span data-stu-id="f7690-109">For time-sensitive calculations that are evaluated once at run-time and that you want to remain the same value throughout report processing, consider whether to use a report variable or group variable.</span></span> <span data-ttu-id="f7690-110">자세한 내용은 [보고서 및 그룹 변수 컬렉션 참조&#40;보고서 작성기 및 SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-110">For more information, see [Report and Group Variables Collections References &#40;Report Builder and SSRS&#41;](built-in-collections-report-and-group-variables-references-report-builder.md).</span></span>  
  
 <span data-ttu-id="f7690-111">기본적으로는 보고서 디자이너를 제작 환경으로 사용하여 보고서에 사용자 지정 코드를 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-111">Report Designer is the preferred authoring environment to use to add custom code to a report.</span></span> <span data-ttu-id="f7690-112">보고서 작성기에서는 유효한 식을 포함하거나 보고서 서버에 있는 사용자 지정 어셈블리에 대한 참조를 포함하는 보고서를 처리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-112">Report Builder supports processing reports that have valid expressions, or that include references to custom assemblies on a report server.</span></span> <span data-ttu-id="f7690-113">그러나 보고서 작성기에서 사용자 지정 어셈블리에 대한 참조를 추가할 수는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-113">Report Builder does not provide a way to add a reference to a custom assembly.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="f7690-114">보고서 서버를 업그레이드하는 동안 사용자 지정 어셈블리를 사용하는 보고서의 경우에는 업그레이드를 완료하려면 추가 단계를 수행해야 할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-114">Be aware that during an upgrade of a report server, reports that depend on custom assemblies might require additional steps to complete the upgrade.</span></span> <span data-ttu-id="f7690-115">자세한 내용은 [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-115">For more information, see [Use Upgrade Advisor to Prepare for Upgrades](../../sql-server/install/use-upgrade-advisor-to-prepare-for-upgrades.md).</span></span>  
  
> [!NOTE]  
>  [!INCLUDE[ssRBRDDup](../../includes/ssrbrddup-md.md)]  
  
##  <a name="working-with-custom-code-in-report-builder"></a><a name="RB3"></a> <span data-ttu-id="f7690-116">보고서 작성기에서 사용자 지정 코드 작업</span><span class="sxs-lookup"><span data-stu-id="f7690-116">Working with Custom Code in Report Builder</span></span>  
 <span data-ttu-id="f7690-117">보고서 작성기에서는 사용자 지정 어셈블리에 대한 참조를 포함하는 보고서 서버의 보고서를 열 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-117">In Report Builder, you can open a report from a report server that includes references to custom assemblies.</span></span> <span data-ttu-id="f7690-118">예를 들어 보고서 디자이너를 사용하여 만들고 배포한 보고서를 [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)]에서 편집할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-118">For example, you can edit reports that are created and deployed by using Report Designer in [!INCLUDE[ssBIDevStudioFull](../../includes/ssbidevstudiofull-md.md)].</span></span> <span data-ttu-id="f7690-119">사용자 지정 어셈블리는 보고서 서버에 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-119">The custom assemblies must be deployed to the report server.</span></span>  
  
 <span data-ttu-id="f7690-120">다음 작업은 수행할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-120">You cannot do the following:</span></span>  
  
1.  <span data-ttu-id="f7690-121">보고서에 대한 참조 또는 클래스 멤버 인스턴스 추가</span><span class="sxs-lookup"><span data-stu-id="f7690-121">Add references or class member instances to a report.</span></span>  
  
2.  <span data-ttu-id="f7690-122">로컬 모드에서 사용자 지정 어셈블리에 대한 참조가 포함된 보고서 미리 보기</span><span class="sxs-lookup"><span data-stu-id="f7690-122">Preview a report with references to custom assemblies in local mode.</span></span>  
  
##  <a name="including-references-to-commonly-used-functions"></a><a name="Common"></a><span data-ttu-id="f7690-123">자주 사용 하는 함수에 대 한 참조 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-123">Including References to Commonly Used Functions</span></span>  
 <span data-ttu-id="f7690-124">**식** 대화 상자를 사용하여 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]에 기본 제공되는 일반적으로 사용되는 함수 목록을 범주별로 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-124">Use the **Expression** dialog box to view a categorized list of common functions built-in to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)].</span></span> <span data-ttu-id="f7690-125">**일반 함수** 를 확장하고 범주를 클릭하면 식에 포함할 수 있는 함수 목록이 **항목** 창에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-125">When you expand **Common Functions** and click a category, the **Item** pane displays the list of functions that you include in an expression.</span></span> <span data-ttu-id="f7690-126">일반 함수에는 [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> 및 <xref:System.Convert> 네임 스페이스의 클래스와 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 런타임 라이브러리 함수가 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-126">The common functions include classes from the [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] <xref:System.Math> and <xref:System.Convert> namespaces and [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] run-time library functions.</span></span> <span data-ttu-id="f7690-127">편의상 **식** 대화 상자에서 범주별로 나열된 가장 일반적으로 사용되는 함수 목록을 볼 수 있습니다. 범주는 텍스트, 날짜 및 시간, 수치 연산, 검사, 프로그램 흐름, 집계, 재무, 변환 및 기타입니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-127">For convenience, you can view the most commonly used functions in the **Expression** dialog box, where they are listed by category: Text, Date and Time, Math, Inspection, Program Flow, Aggregate, Financial, Conversion, and Miscellaneous.</span></span> <span data-ttu-id="f7690-128">자주 사용되지 않는 함수는 목록에 표시되지 않지만 식에 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-128">Less commonly used functions do not appear in the list but can still be used in an expression.</span></span>  
  
 <span data-ttu-id="f7690-129">기본 제공 함수를 사용하려면 항목 창에서 함수 이름을 두 번 클릭합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-129">To use a built-in function, double-click the function name in the Item pane.</span></span> <span data-ttu-id="f7690-130">함수 설명이 설명 창에 표시되고 함수 호출 예가 예제 창에 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-130">A description of the function appears in the Description pane and an example of the function call appears in the Example pane.</span></span> <span data-ttu-id="f7690-131">코드 창에서 함수 이름을 입력하고 왼쪽 괄호 **(** 를 입력하면 IntelliSense 도움말을 통해 해당 함수 호출에 적합한 각 구문이 표시됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-131">In the code pane, when you type the function name followed by a left parenthesis **(**, the IntelliSense help displays each valid syntax for the function call.</span></span> <span data-ttu-id="f7690-132">예를 들어 테이블의 `Quantity` 라는 필드에 대한 최대값을 계산하려면 코드 창에 `=Max(` 라는 간단한 식을 입력하고 스마트 태그를 사용하여 해당 함수 호출에 대해 유효한 모든 구문 목록을 확인합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-132">For example, to calculate the maximum value for a field named `Quantity` in a table, add the simple expression `=Max(` to the Code pane, and then use the smart tags to view all possible valid syntaxes for the function call.</span></span> <span data-ttu-id="f7690-133">이 예를 완료하려면 `=Max(Fields!Quantity.Value)`를 입력합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-133">To complete this example, type `=Max(Fields!Quantity.Value)`.</span></span>  
  
 <span data-ttu-id="f7690-134">각 함수에 대한 자세한 내용은 <xref:System.Math>, <xref:System.Convert>및 MSDN의 [Visual Basic 런타임 라이브러리 멤버](https://go.microsoft.com/fwlink/?LinkId=198941) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-134">For more information about each function, see <xref:System.Math>, <xref:System.Convert>, and [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-less-commonly-used-functions"></a><a name="NotCommon"></a> <span data-ttu-id="f7690-135">일반적으로 사용되지 않는 함수에 대한 참조 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-135">Including References to Less Commonly Used Functions</span></span>  
 <span data-ttu-id="f7690-136">일반적으로 사용되지 않는 다른 CLR 네임스페이스에 대한 참조를 포함하려면 <xref:System.Text.StringBuilder>를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-136">To include a reference to other less commonly used CLR namespaces, you must use a fully qualified reference, for example, <xref:System.Text.StringBuilder>.</span></span> <span data-ttu-id="f7690-137">일반적으로 사용되지 않는 이러한 함수의 경우 **식** 대화 상자의 코드 창에서 IntelliSense가 지원되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-137">IntelliSense is not supported in the code pane of the **Expression** dialog box for these less commonly used functions.</span></span>  
  
 <span data-ttu-id="f7690-138">자세한 내용은 MSDN의 [Visual Basic 런타임 라이브러리 멤버](https://go.microsoft.com/fwlink/?LinkId=198941) 를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-138">For more information, see [Visual Basic Runtime Library Members](https://go.microsoft.com/fwlink/?LinkId=198941) on MSDN.</span></span>  
  
##  <a name="including-references-to-external-assemblies"></a><a name="External"></a> <span data-ttu-id="f7690-139">외부 어셈블리에 대한 참조 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-139">Including References to External Assemblies</span></span>  
 <span data-ttu-id="f7690-140">외부 어셈블리의 클래스에 대한 참조를 포함하려면 보고서 처리기에 대한 어셈블리를 확인해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-140">To include a reference to a class in an external assembly, you must identify the assembly for the report processor.</span></span> <span data-ttu-id="f7690-141">**보고서 속성** 대화 상자의 **참조** 페이지를 사용하여 보고서에 추가할 어셈블리의 정규화된 이름을 지정할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-141">Use the **References** page of the **Report Properties** dialog box to specify the fully qualified name of the assembly to add to the report.</span></span> <span data-ttu-id="f7690-142">식에서 어셈블리의 클래스에 대한 정규화된 이름을 사용해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-142">In your expression, you must use the fully qualified name for the class in the assembly.</span></span> <span data-ttu-id="f7690-143">외부 어셈블리의 클래스는 **식** 대화 상자에 표시되지 않으므로 정확한 클래스 이름을 입력해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-143">Classes in an external assembly do not appear in the **Expression** dialog box; you must provide the correct name for the class.</span></span> <span data-ttu-id="f7690-144">정규화된 이름에는 네임스페이스, 클래스 이름 및 멤버 이름이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-144">A fully qualified name includes the namespace, the class name, and the member name.</span></span>  
  
##  <a name="including-embedded-code"></a><a name="Embedded"></a> <span data-ttu-id="f7690-145">포함 코드 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-145">Including Embedded Code</span></span>  
 <span data-ttu-id="f7690-146">보고서에 포함 코드를 추가하려면 **보고서 속성** 대화 상자의 코드 탭을 사용합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-146">To add embedded code to a report, use the Code tab of the **Report Properties** dialog box.</span></span> <span data-ttu-id="f7690-147">만드는 코드 블록에는 여러 메서드가 포함될 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-147">The code block you create can contain multiple methods.</span></span> <span data-ttu-id="f7690-148">포함 코드의 메서드는으로 작성 되 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] 고 인스턴스를 기반으로 해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-148">Methods in embedded code must be written in [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] and must be instance-based.</span></span> <span data-ttu-id="f7690-149">보고서 처리기는 System.Convert 및 System.Math 네임스페이스에 대한 참조를 자동으로 추가합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-149">The report processor automatically adds references for the System.Convert and System.Math namespaces.</span></span> <span data-ttu-id="f7690-150">**보고서 속성** 대화 상자의 **참조** 페이지를 사용하여 다른 어셈블리 참조를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-150">Use the **References** page of the **Report Properties** dialog box to add additional assembly references.</span></span> <span data-ttu-id="f7690-151">자세한 내용은 [보고서에 어셈블리 참조 추가&#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-151">For more information, see [Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md).</span></span>  
  
 <span data-ttu-id="f7690-152">포함 코드의 메서드는 전역적으로 정의된 `Code` 멤버를 통해 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-152">Methods in embedded code are available through a globally defined `Code` member.</span></span> <span data-ttu-id="f7690-153">`Code` 멤버와 메서드 이름을 참조하여 이러한 메서드에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-153">You access these by referring to the `Code` member and the method name.</span></span> <span data-ttu-id="f7690-154">다음 예에서는 `StandardCost` 필드 값을 달러 값으로 변환하는 `ToUSD` 메서드를 호출합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-154">The following example calls the method `ToUSD`, which converts the value in the `StandardCost` field to a dollar value:</span></span>  
  
```  
=Code.ToUSD(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="f7690-155">사용자 지정 코드에서 기본 제공 컬렉션을 참조하려면 기본 제공 `Report` 개체에 대한 참조를 포함합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-155">To reference built-in collections in your custom code, include a reference to the built-in `Report` object:</span></span>  
  
```  
=Report.Parameters!Param1.Value  
```  
  
 <span data-ttu-id="f7690-156">다음 예에서는 몇 가지 사용자 지정 상수 및 변수를 정의하는 방법을 보여 줍니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-156">The following examples show how to define some custom constants and variables.</span></span>  
  
```  
Public Const MyNote = "Authored by Bob"  
Public Const NCopies As Int32 = 2  
Public Dim  MyVersion As String = "123.456"  
Public Dim MyDoubleVersion As Double = 123.456  
```  
  
 <span data-ttu-id="f7690-157">**식** 대화 상자의 **상수** 범주에서는 기본 제공 상수만 표시되고 사용자 지정 상수는 표시되지 않지만 아래 예와 같이 식에서 사용자 지정 상수에 대한 참조를 추가할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-157">Although custom constants do not appear in the **Constants** category in the **Expression** dialog box (which only displays built-in constants), you can add references to them from any expression, as shown in the following examples.</span></span> <span data-ttu-id="f7690-158">식에서 사용자 지정 상수는 `Variant`로 처리됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-158">In an expression, a custom constant is treated as a `Variant`.</span></span>  
  
```  
=Code.MyNote  
=Code.NCopies  
=Code.MyVersion  
=Code.MyDoubleVersion  
```  
  
 <span data-ttu-id="f7690-159">다음 예에는 `"Bicycle"` 필드에 있는 모든 "Bike" 텍스트를 `SubCategory` 텍스트로 대체하는 `FixSpelling` 함수의 코드 참조와 코드 구현이 모두 들어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-159">The following example includes both the code reference and the code implementation of the function `FixSpelling`, which substitutes the text `"Bicycle"` for all occurrences of the text "Bike" in the `SubCategory` field.</span></span>  
  
 `=Code.FixSpelling(Fields!SubCategory.Value)`  
  
 <span data-ttu-id="f7690-160">다음 코드를 보고서 정의 코드 블록에 포함하면 `FixSpelling` 메서드의 구현을 볼 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-160">The following code, when embedded in a report definition code block, shows an implementation of the `FixSpelling` method.</span></span> <span data-ttu-id="f7690-161">이 예제에서는 클래스에 대 한 정규화 된 참조를 사용 하는 방법을 보여 줍니다 [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` .</span><span class="sxs-lookup"><span data-stu-id="f7690-161">This example shows you how to use a fully qualified reference to the [!INCLUDE[msCoName](../../includes/msconame-md.md)] [!INCLUDE[dnprdnshort](../../includes/dnprdnshort-md.md)] `StringBuilder` class.</span></span>  
  
```vb  
Public Function FixSpelling(ByVal s As String) As String  
   Dim strBuilder As New System.Text.StringBuilder(s)  
   If s.Contains("Bike") Then  
      strBuilder.Replace("Bike", "Bicycle")  
      Return strBuilder.ToString()  
      Else : Return s  
   End If  
End Function  
```  
  
 <span data-ttu-id="f7690-162">기본 제공 개체 컬렉션 및 초기화에 대한 자세한 내용은 [기본 제공 Globals 및 Users 참조&#40;보고서 작성기 및 SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) 및 [사용자 지정 어셈블리 개체 초기화](../custom-assemblies/initializing-custom-assembly-objects.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-162">For more information about built-in object collections and initialization, see [Built-in Globals and Users References &#40;Report Builder and SSRS&#41;](built-in-collections-built-in-globals-and-users-references-report-builder.md) and [Initializing Custom Assembly Objects](../custom-assemblies/initializing-custom-assembly-objects.md).</span></span>  
  
##  <a name="including-references-to-parameters-from-code"></a><a name="Parameters"></a> <span data-ttu-id="f7690-163">코드에서 매개 변수에 대한 참조 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-163">Including References to Parameters from Code</span></span>  
 <span data-ttu-id="f7690-164">보고서 정의의 코드 블록 또는 사용자가 제공하는 사용자 지정 어셈블리에서 사용자 지정 코드를 통해 전역 매개 변수 컬렉션을 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-164">You can reference the global parameters collection via custom code in a Code block of the report definition or in a custom assembly that you provide.</span></span> <span data-ttu-id="f7690-165">매개 변수 컬렉션은 읽기 전용이며 공개 반복기는 없습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-165">The parameters collection is read-only and has no public iterators.</span></span> <span data-ttu-id="f7690-166">구문을 사용 하 여 컬렉션을 단계별로 실행할 수 없습니다 [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` .</span><span class="sxs-lookup"><span data-stu-id="f7690-166">You cannot use a [!INCLUDE[vbprvb](../../includes/vbprvb-md.md)] `For Each` construct to step through the collection.</span></span> <span data-ttu-id="f7690-167">보고서 정의에 정의된 매개 변수 이름을 알아야 사용자의 코드에서 해당 매개 변수를 참조할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-167">You need to know the name of the parameter defined in the report definition before you can reference it in your code.</span></span> <span data-ttu-id="f7690-168">하지만 다중값 매개 변수의 모든 값을 반복할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-168">You can, however, iterate through all the values of a multivalue parameter.</span></span>  
  
 <span data-ttu-id="f7690-169">다음 표에는 사용자 지정 코드에서 기본 제공 컬렉션 `Parameters` 를 참조하는 예가 들어 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-169">The following table includes examples of referencing the built-in collection `Parameters` from custom code:</span></span>  
  
|<span data-ttu-id="f7690-170">설명</span><span class="sxs-lookup"><span data-stu-id="f7690-170">Description</span></span>|<span data-ttu-id="f7690-171">식에서의 참조</span><span class="sxs-lookup"><span data-stu-id="f7690-171">Reference in Expression</span></span>|<span data-ttu-id="f7690-172">사용자 지정 코드 정의</span><span class="sxs-lookup"><span data-stu-id="f7690-172">Custom Code definition</span></span>|  
|-----------------|-----------------------------|----------------------------|  
|<span data-ttu-id="f7690-173">전체 전역 매개 변수 컬렉션을 사용자 지정 코드에 전달.</span><span class="sxs-lookup"><span data-stu-id="f7690-173">Passing an entire global parameter collection to custom code.</span></span><br /><br /> <span data-ttu-id="f7690-174">이 함수는 특정 보고서 매개 변수 *MyParameter*의 값을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-174">This function returns the value of a specific report parameter *MyParameter*.</span></span>|`=Code.DisplayAParameterValue(Parameters)`|`Public Function DisplayAParameterValue(`<br /><br /> `ByVal parameters as Parameters) as Object`<br /><br /> `Return parameters("MyParameter").Value`<br /><br /> `End Function`|  
|<span data-ttu-id="f7690-175">개별 매개 변수를 사용자 지정 코드에 전달.</span><span class="sxs-lookup"><span data-stu-id="f7690-175">Passing an individual parameter to custom code.</span></span><br /><br /> <span data-ttu-id="f7690-176">이 예에서는 전달된 매개 변수의 값을 반환합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-176">This example returns the value of the parameter passed in.</span></span> <span data-ttu-id="f7690-177">매개 변수가 다중값 매개 변수일 경우 반환 문자열은 모든 값을 연결한 것입니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-177">If the parameter is a multivalue parameter, the return string is a concatenation of all the values.</span></span>|`=Code.ShowParametersValues(Parameters!DayOfTheWeek)`|`Public Function ShowParameterValues(ByVal parameter as Parameter)` <br />  `as String` <br /> `Dim s as String`  <br />  `If parameter.IsMultiValue then` <br />  `s = "Multivalue: "`  <br /> `For i as integer = 0 to parameter.Count-1` <br />  `s = s + CStr(parameter.Value(i)) + " "`  <br />  `Next` <br /> `Else` <br /> `s = "Single value: " + CStr(parameter.Value)` <br /> `End If` <br />  `Return s` <br /> `End Function`|  
  
##  <a name="including-references-to-code-from-custom-assemblies"></a><a name="Custom"></a><span data-ttu-id="f7690-178">사용자 지정 어셈블리의 코드에 대 한 참조 포함</span><span class="sxs-lookup"><span data-stu-id="f7690-178">Including References to Code from Custom Assemblies</span></span>  
 <span data-ttu-id="f7690-179">보고서에 사용자 지정 어셈블리를 사용하려면 먼저 어셈블리를 만들고 보고서 디자이너에서 사용할 수 있게 한 다음 보고서에 어셈블리에 대한 참조를 추가하고 보고서에서 식을 사용하여 해당 어셈블리에 포함된 메서드를 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-179">To use custom assemblies in a report, you must first create the assembly, make it available to Report Designer, add a reference to the assembly in the report, and then use an expression in the report to refer to the methods contained in that assembly.</span></span> <span data-ttu-id="f7690-180">보고서가 보고서 서버에 배포될 때 사용자 지정 어셈블리도 보고서 서버에 배포해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-180">When the report is deployed to the report server, you must also deploy the custom assembly to the report server.</span></span>  
  
 <span data-ttu-id="f7690-181">사용자 지정 어셈블리를 만들고 [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)]에서 사용할 수 있도록 설정하는 방법에 대한 자세한 내용은 [보고서에서 사용자 지정 어셈블리 사용](../custom-assemblies/using-custom-assemblies-with-reports.md)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-181">For information about creating a custom assembly and making it available to [!INCLUDE[ssRSnoversion](../../includes/ssrsnoversion-md.md)], see [Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md).</span></span>  
  
 <span data-ttu-id="f7690-182">식의 사용자 지정 코드를 참조하려면 어셈블리 내에서 클래스의 멤버를 호출해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-182">To refer to custom code in an expression, you must call the member of a class within the assembly.</span></span> <span data-ttu-id="f7690-183">이 방법은 메서드가 정적인지 아니면 인스턴스 기반인지에 따라 달라집니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-183">How you do this depends on whether the method is static or instance-based.</span></span> <span data-ttu-id="f7690-184">사용자 지정 어셈블리 내의 정적 메서드는 보고서 내에서 전체적으로 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-184">Static methods within a custom assembly are available globally within the report.</span></span> <span data-ttu-id="f7690-185">식에서 네임스페이스, 클래스 및 메서드 이름을 지정하여 정적 메서드에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-185">You can access static methods in expressions by specifying the namespace, class, and method name.</span></span> <span data-ttu-id="f7690-186">다음 예에서는 `ToGBP` **standardcost** 값을 달러에서 파운드 (파운드)로 변환 하는 메서드를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-186">The following example calls the method `ToGBP`, which converts the value of the **StandardCost** value from dollar to pounds sterling:</span></span>  
  
```  
=CurrencyConversion.DollarCurrencyConversion.ToGBP(Fields!StandardCost.Value)  
```  
  
 <span data-ttu-id="f7690-187">인스턴스 기반 메서드는 전역적으로 정의된 `Code` 멤버를 통해 사용할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-187">Instance-based methods are available through a globally defined `Code` member.</span></span> <span data-ttu-id="f7690-188">`Code` 멤버를 참조한 다음 인스턴스와 메서드 이름을 참조하여 이러한 메서드에 액세스합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-188">You access these by referring to the `Code` member, followed by the instance and method name.</span></span> <span data-ttu-id="f7690-189">다음 예에서는 `ToEUR` **standardcost** 값을 달러에서 유로로 변환 하는 instance 메서드를 호출 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-189">The following example calls the instance method `ToEUR`, which converts the value of **StandardCost** from dollar to euro:</span></span>  
  
```  
=Code.m_myDollarCoversion.ToEUR(Fields!StandardCost.Value)  
```  
  
> [!NOTE]  
>  <span data-ttu-id="f7690-190">보고서 디자이너에 사용자 지정 어셈블리를 로드하면 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)]를 닫을 때까지 언로드되지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-190">In Report Designer, a custom assembly is loaded once and is not unloaded until you close [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)].</span></span> <span data-ttu-id="f7690-191">보고서 미리 보기를 수행할 경우 보고서에 사용된 사용자 지정 어셈블리를 변경한 다음 다시 보고서 미리 보기를 수행하면 변경 내용이 적용되어 나타나지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-191">If you preview a report, make changes to a custom assembly used in the report, and then preview the report again, the changes will not appear in the second preview.</span></span> <span data-ttu-id="f7690-192">어셈블리를 다시 로드하려면 [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] 를 닫고 다시 연 다음 보고서 미리 보기를 수행하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-192">To reload the assembly, close and reopen [!INCLUDE[vsprvs](../../includes/vsprvs-md.md)] and then preview the report.</span></span>  
  
 <span data-ttu-id="f7690-193">코드에 액세스하는 방법은 [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-193">For more information about accessing your code, see [Accessing Custom Assemblies Through Expressions](../custom-assemblies/accessing-custom-assemblies-through-expressions.md).</span></span>  
  
##  <a name="passing-built-in-collections-into-custom-assemblies"></a><a name="collections"></a> <span data-ttu-id="f7690-194">사용자 지정 어셈블리에 기본 제공 컬렉션 전달</span><span class="sxs-lookup"><span data-stu-id="f7690-194">Passing Built-in Collections into Custom Assemblies</span></span>  
 <span data-ttu-id="f7690-195">처리 작업을 위해 *전역* 또는 *매개 변수* 컬렉션과 같은 기본 제공 컬렉션을 사용자 지정 어셈블리에 전달하려는 경우 기본 제공 컬렉션을 정의하고 올바른 네임스페이스에 액세스하는 어셈블리에 코드 프로젝트의 어셈블리 참조를 추가해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-195">If you want to pass built-in collections, such as the *Globals* or *Parameters* collection, into a custom assembly for processing, you must add an assembly reference in your code project to the assembly that defines the built-in collections and access the correct namespace.</span></span> <span data-ttu-id="f7690-196">보고서 서버에서 실행되는 보고서(서버 보고서)에 대한 사용자 지정 어셈블리를 개발하는지, 아니면 .NET 애플리케이션에서 로컬로 실행되는 보고서(로컬 보고서)에 대한 사용자 지정 어셈블리를 개발하는지에 따라 다른 어셈블리를 참조해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-196">Depending on whether you are developing the custom assembly for a report that is run on a report server (server report) or a report that is run locally in a .NET application (local report), the assembly you need to reference is different.</span></span> <span data-ttu-id="f7690-197">자세한 내용은 다음을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="f7690-197">See below for details.</span></span>  
  
-   <span data-ttu-id="f7690-198">**네임스페이스:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span><span class="sxs-lookup"><span data-stu-id="f7690-198">**Namespace:** Microsoft.ReportingServices.ReportProcessing.ReportObjectModel</span></span>  
  
-   <span data-ttu-id="f7690-199">**어셈블리(로컬 보고서):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="f7690-199">**Assembly (local report):** Microsoft.ReportingServices.ProcessingObjectModel.dll</span></span>  
  
-   <span data-ttu-id="f7690-200">**어셈블리(서버 보고서):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span><span class="sxs-lookup"><span data-stu-id="f7690-200">**Assembly (server report):** Microsoft.ReportViewer.ProcessingObjectModel.dll</span></span>  
  
 <span data-ttu-id="f7690-201">*Fields* 및 *ReportItems* 컬렉션의 내용은 런타임에 동적으로 변경될 수 있으므로 사용자 지정 어셈블리에 대한 호출에서(예: 멤버 변수) 해당 컬렉션을 유지해서는 안 됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-201">Since the content of the *Fields* and *ReportItems* collections can change dynamically at runtime, you should not hold onto them across calls into the custom assembly (for example, in a member variable).</span></span> <span data-ttu-id="f7690-202">일반적으로 모든 기본 제공 컬렉션에 같은 권장 사항이 적용됩니다.</span><span class="sxs-lookup"><span data-stu-id="f7690-202">The same recommendation applies generally to all built-in collections.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f7690-203">참고 항목</span><span class="sxs-lookup"><span data-stu-id="f7690-203">See Also</span></span>  
 <span data-ttu-id="f7690-204">[SSRS&#41;&#40;보고서에 코드 추가](add-code-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="f7690-204">[Add Code to a Report &#40;SSRS&#41;](add-code-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="f7690-205">[보고서에서 사용자 지정 어셈블리 사용](../custom-assemblies/using-custom-assemblies-with-reports.md) </span><span class="sxs-lookup"><span data-stu-id="f7690-205">[Using Custom Assemblies with Reports](../custom-assemblies/using-custom-assemblies-with-reports.md) </span></span>  
 <span data-ttu-id="f7690-206">[SSRS&#41;&#40;보고서에 어셈블리 참조를 추가 합니다.](add-an-assembly-reference-to-a-report-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="f7690-206">[Add an Assembly Reference to a Report &#40;SSRS&#41;](add-an-assembly-reference-to-a-report-ssrs.md) </span></span>  
 <span data-ttu-id="f7690-207">[SSRS를 &#40;Reporting Services 자습서&#41;](../reporting-services-tutorials-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="f7690-207">[Reporting Services Tutorials &#40;SSRS&#41;](../reporting-services-tutorials-ssrs.md) </span></span>  
 <span data-ttu-id="f7690-208">[식 예&#40;보고서 작성기 및 SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span><span class="sxs-lookup"><span data-stu-id="f7690-208">[Expression Examples &#40;Report Builder and SSRS&#41;](expression-examples-report-builder-and-ssrs.md) </span></span>  
 [<span data-ttu-id="f7690-209">보고서 예제(보고서 작성기 및 SSRS)</span><span class="sxs-lookup"><span data-stu-id="f7690-209">Report Samples (Report Builder and SSRS)</span></span>](https://go.microsoft.com/fwlink/?LinkId=198283)  
  
  
