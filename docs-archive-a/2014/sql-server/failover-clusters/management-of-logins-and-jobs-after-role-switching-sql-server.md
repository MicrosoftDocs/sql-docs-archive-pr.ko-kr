---
title: 역할 전환 후 로그인 및 작업 관리(SQL Server) | Microsoft 문서
ms.custom: ''
ms.date: 06/13/2017
ms.prod: sql-server-2014
ms.reviewer: ''
ms.technology: high-availability
ms.topic: conceptual
helpviewer_keywords:
- role switching [SQL Server]
ms.assetid: fc2fc949-746f-40c7-b5d4-3fd51ccfbd7b
author: MikeRayMSFT
ms.author: mikeray
ms.openlocfilehash: 9c099bf9ea271b5ea93fdebfe8f35c98864bca09
ms.sourcegitcommit: ad4d92dce894592a259721a1571b1d8736abacdb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/04/2020
ms.locfileid: "87650577"
---
# <a name="management-of-logins-and-jobs-after-role-switching-sql-server"></a><span data-ttu-id="6d32a-102">역할 전환 후 로그인 및 작업 관리(SQL Server)</span><span class="sxs-lookup"><span data-stu-id="6d32a-102">Management of Logins and Jobs After Role Switching (SQL Server)</span></span>
  <span data-ttu-id="6d32a-103">[!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 데이터베이스에 대한 고가용성 또는 재해 복구 솔루션을 배포하는 경우 **master** 또는 **msdb** 데이터베이스에 해당 데이터베이스에 대해 저장되는 관련 정보를 다시 생성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-103">When deploying a high-availability or disaster-recovery solution for a [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] database, it is important to reproduce relevant information that is stored for the database in the **master** or **msdb** databases.</span></span> <span data-ttu-id="6d32a-104">대개 관련 정보에는 주 데이터베이스의 작업과 데이터베이스에 연결해야 하는 프로세스 또는 사용자의 로그인이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-104">Typically, the relevant information includes the jobs of the primary/principal database and the logins of users or processes that need to connect to the database.</span></span> <span data-ttu-id="6d32a-105">보조/미러 데이터베이스를 호스팅하는 모든 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스에서 이 정보를 복제해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-105">You should duplicate this information on any instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] that hosts a secondary/mirror database.</span></span> <span data-ttu-id="6d32a-106">가능하다면 역할이 전환된 후 새 주 데이터베이스에서 프로그래밍 방식으로 해당 정보를 다시 생성하는 것이 가장 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-106">If possible after roles are switched, it is best to programmatically reproduce the information on the new primary/principal database.</span></span>  
  
## <a name="logins"></a><span data-ttu-id="6d32a-107">로그인</span><span class="sxs-lookup"><span data-stu-id="6d32a-107">Logins</span></span>  
 <span data-ttu-id="6d32a-108">데이터베이스 복사본을 호스팅하는 모든 서버 인스턴스에서 주 데이터베이스에 대한 액세스 권한이 있는 로그인을 다시 생성해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-108">On every server instances that hosts a copy of the database, you should reproduce the logins that have permission to access the principal database.</span></span> <span data-ttu-id="6d32a-109">주 역할이 전환되는 경우 새 주 서버 인스턴스에 로그인이 있는 사용자만 새 주 데이터베이스에 액세스할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-109">When the primary/principal role switches, only users whose logins exist on the new primary/principal server instance can access the new primary/principal database.</span></span> <span data-ttu-id="6d32a-110">새 주 서버 인스턴스에 로그인이 정의되어 있지 않은 사용자는 분리된 상태가 되어 데이터베이스에 액세스할 수 없습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-110">Users whose logins are not defined on the new primary/principal server instance are orphaned and cannot access the database.</span></span>  
  
 <span data-ttu-id="6d32a-111">사용자가 분리된 경우 새 주 서버 인스턴스에서 로그인을 만들고 [sp_change_users_login](/sql/relational-databases/system-stored-procedures/sp-change-users-login-transact-sql)을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-111">If a user is orphaned, create the login on the new primary/principal server instance and run [sp_change_users_login](/sql/relational-databases/system-stored-procedures/sp-change-users-login-transact-sql).</span></span> <span data-ttu-id="6d32a-112">자세한 내용은 [분리된 사용자 문제 해결&#40;SQL Server&#41;](troubleshoot-orphaned-users-sql-server.md)을 실행합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-112">For more information, see [Troubleshoot Orphaned Users &#40;SQL Server&#41;](troubleshoot-orphaned-users-sql-server.md).</span></span>  
  
###  <a name="logins-of-applications-that-use-sql-server-authentication-or-a-local-windows-login"></a><a name="SSauthentication"></a> <span data-ttu-id="6d32a-113">SQL Server 인증 또는 로컬 Windows 로그인을 사용하는 애플리케이션의 로그인</span><span class="sxs-lookup"><span data-stu-id="6d32a-113">Logins Of Applications That Use SQL Server Authentication or a Local Windows Login</span></span>  
 <span data-ttu-id="6d32a-114">애플리케이션에서 SQL Server 인증 또는 로컬 Windows 로그인을 사용하는 경우 일치하지 않는 SID로 인해 원격 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]인스턴스에서 애플리케이션의 로그인이 확인되지 않을 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-114">If an application uses SQL Server Authentication or a local Windows login, mismatched SIDs can prevent the application's login from resolving on a remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6d32a-115">일치하지 않는 SID로 인해 해당 로그인이 원격 서버 인스턴스에서 분리된 사용자가 됩니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-115">The mismatched SIDs cause the login to become an orphaned user on the remote server instance.</span></span> <span data-ttu-id="6d32a-116">이 문제는 애플리케이션이 장애 조치(Failover) 후 미러링된 데이터베이스 또는 로그 전달 데이터베이스에 연결하거나 백업에서 초기화된 복제 구독자 데이터베이스에 연결하는 경우에 발생할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-116">This issue can occur when an application connects to a mirrored or log shipping database after a failover or to a replication subscriber database that was initialized from a backup.</span></span>  
  
 <span data-ttu-id="6d32a-117">이 문제를 방지하려면 원격 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]인스턴스에서 호스팅하는 데이터베이스를 사용하도록 애플리케이션을 설정할 때 예방 조치를 취하는 것이 좋습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-117">To prevent this issue, we recommend that you take preventative measures when you set up such an application to use a database that is hosted by a remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6d32a-118">예방 조치에는 로컬 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스에서 원격 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]인스턴스로 로그인 및 암호를 전송하는 것이 포함됩니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-118">Prevention involves transferring the logins and the passwords from the local instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] to the remote instance of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6d32a-119">이 문제를 방지하는 방법에 대한 자세한 내용은 KB 문서 918992 [SQL Server 인스턴스 간에 로그인 및 암호를 전송하는 방법](https://support.microsoft.com/kb/918992/)을 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="6d32a-119">For more information about how to prevent this issue, see KB article 918992 -[How to transfer logins and passwords between instances of SQL Server](https://support.microsoft.com/kb/918992/)).</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6d32a-120">이 문제는 다른 컴퓨터의 Windows 로컬 계정에 영향을 줍니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-120">This problem affects Windows local accounts on different computers.</span></span> <span data-ttu-id="6d32a-121">하지만 도메인 계정에서는 SID가 각 컴퓨터에서 동일하기 때문에 이러한 문제가 발생하지 않습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-121">However, this problem does not occur for domain accounts because the SID is the same on each of the computers.</span></span>  
  
 <span data-ttu-id="6d32a-122">자세한 내용은 [데이터베이스 미러링 및 로그 전달에서의 분리된 사용자](https://blogs.msdn.com/b/sqlserverfaq/archive/2009/04/13/orphaned-users-with-database-mirroring-and-log-shipping.aspx) (데이터베이스 엔진 블로그)를 참조하세요.</span><span class="sxs-lookup"><span data-stu-id="6d32a-122">For more information, see [Orphaned Users with Database Mirroring and Log Shipping](https://blogs.msdn.com/b/sqlserverfaq/archive/2009/04/13/orphaned-users-with-database-mirroring-and-log-shipping.aspx) (a Database Engine blog).</span></span>  
  
## <a name="jobs"></a><span data-ttu-id="6d32a-123">작업</span><span class="sxs-lookup"><span data-stu-id="6d32a-123">Jobs</span></span>  
 <span data-ttu-id="6d32a-124">백업과 같은 작업에는 특별한 주의가 필요합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-124">Jobs, such as backup jobs, require special consideration.</span></span> <span data-ttu-id="6d32a-125">일반적으로 역할 전환 후 데이터베이스 소유자 또는 시스템 관리자는 새 주 데이터베이스의 작업을 다시 만들어야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-125">Typically, after a role switch, the database owner or system administrator must re-create the jobs for the new primary/principal database.</span></span>  
  
 <span data-ttu-id="6d32a-126">이전 주 서버 인스턴스를 사용할 수 있는 경우 해당 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)]인스턴스에서 원래 작업을 삭제해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-126">When the former primary/principal server instance is available, you should delete the original jobs on that instanceof [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)].</span></span> <span data-ttu-id="6d32a-127">현재 미러 데이터베이스가 RESTORING 상태에 있어서 사용할 수 없으므로 현재 미러 데이터베이스의 작업은 실패합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-127">Note that jobs on the current mirror database fail because it is in the RESTORING state, making it unavailable.</span></span>  
  
> [!NOTE]  
>  <span data-ttu-id="6d32a-128">각 [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] 인스턴스는 드라이브 문자를 다르게 지정하는 등의 방법으로 서로 다르게 구성할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-128">Different instances of [!INCLUDE[ssNoVersion](../../includes/ssnoversion-md.md)] might be configured differently, with different drive letters or such.</span></span> <span data-ttu-id="6d32a-129">각 파트너에 대한 작업 시 이러한 모든 차이점을 감안해야 합니다.</span><span class="sxs-lookup"><span data-stu-id="6d32a-129">The jobs for each partner must allow for any such differences.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6d32a-130">참고 항목</span><span class="sxs-lookup"><span data-stu-id="6d32a-130">See Also</span></span>  
 <span data-ttu-id="6d32a-131">[다른 서버 인스턴스에서 데이터베이스를 사용할 수 있도록 할 때 메타데이터 관리&#40;SQL Server&#41;](../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md) </span><span class="sxs-lookup"><span data-stu-id="6d32a-131">[Manage Metadata When Making a Database Available on Another Server Instance &#40;SQL Server&#41;](../../relational-databases/databases/manage-metadata-when-making-a-database-available-on-another-server.md) </span></span>  
 [<span data-ttu-id="6d32a-132">분리된 사용자 문제 해결&#40;SQL Server&#41;</span><span class="sxs-lookup"><span data-stu-id="6d32a-132">Troubleshoot Orphaned Users &#40;SQL Server&#41;</span></span>](troubleshoot-orphaned-users-sql-server.md)  
  
  
